import{a as process$1}from"./chunk-bacf0c54.mjs";import{a as Construct,b as require$$0}from"./chunk-a97d251a.mjs";import"./chunk-805ffcb4.mjs";import"./chunk-bd824939.mjs";import{a as observeReader}from"./chunk-0877ccb7.mjs";import"./chunk-5f1245ff.mjs";import"./chunk-7dfeb1df.mjs";import"./chunk-f8a6947c.mjs";import{a as dev}from"./chunk-585d4076.mjs";import"./chunk-04598776.mjs";import{a as get}from"./chunk-b09dcf0e.mjs";import{a as domMutate}from"./chunk-e442e0a9.mjs";import{a as canSymbol}from"./chunk-b37d91a1.mjs";import{a as namespace}from"./chunk-3b4c7b38.mjs";import{a as assign}from"./chunk-75bea8d8.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import{a as Observation}from"./chunk-c1d5d21e.mjs";import{a as mapEventBindings}from"./chunk-910f3205.mjs";var processors,basicProcessor,controlsSymbol=canSymbol.for("can.controls"),bind=function(e,t,n,o){return mapEventBindings.on.call(e,t,n,o),function(){mapEventBindings.off.call(e,t,n,o)}},slice=[].slice,paramReplacer=/\{([^\}]+)\}/g,delegate=function(e,t,n,o){return mapEventBindings.on.call(e,n,t,o),function(){mapEventBindings.off.call(e,n,t,o)}},binder=function(e,t,n,o){return o?delegate(e,o.trim(),t,n):bind(e,t,n)},Control=Construct.extend("Control",{setup:function(){if(Construct.setup.apply(this,arguments),Control){var e;for(e in this.actions={},this.prototype)this._isAction(e)&&(this.actions[e]=this._action(e))}},_shifter:function(e,t){var n="string"==typeof t?e[t]:t;"function"!=typeof n&&(n=e[n]);var o=this;function r(){var r=o.wrapElement(this);return e.called=t,n.apply(e,[r].concat(slice.call(arguments,0)))}return"production"!==process$1.env.NODE_ENV&&Object.defineProperty(r,"name",{value:canReflect.getName(this)+"["+t+"]"}),r},_isAction:function(e){var t=this.prototype[e],n=typeof t;return"constructor"!==e&&("function"===n||"string"===n&&"function"==typeof this.prototype[t])&&!!(Control.isSpecial(e)||processors[e]||/[^\w]/.test(e))},_action:function(e,t,n){var o,r;if(paramReplacer.lastIndex=0,t||!paramReplacer.test(e)){var s=function(){var n,o=e.replace(paramReplacer,function(e,o){var s,i;return this._isDelegate(t,o)?(n=this._getDelegate(t,o),""):(o=this._removeDelegateFromKey(o),i=this._lookup(t)[0],void 0===(s=observeReader.read(i,observeReader.reads(o),{readCompute:!1}).value)&&"undefined"!=typeof window&&(s=get(window,o)),i&&(canReflect.isObservableLike(i)&&canReflect.isMapLike(i)||s)?"string"==typeof s?s:(n=s,""):(r=!0,null))}.bind(this)),s=(o=o.trim()).split(/\s+/g),i=s.pop();return{processor:this.processors[i]||basicProcessor,parts:[o,s.join(" "),i],delegate:n||void 0}};if("production"!==process$1.env.NODE_ENV&&Object.defineProperty(s,"name",{value:canReflect.getName(n||this.prototype)+"["+e+"].actionData"}),o=new Observation(s,this),n){var i=function(t){n._bindings.control[e](n.element),n._bindings.control[e]=t.processor(t.delegate||n.element,t.parts[2],t.parts[1],e,n)};"production"!==process$1.env.NODE_ENV&&Object.defineProperty(i,"name",{value:canReflect.getName(n)+"["+e+"].handler"}),canReflect.onValue(o,i,"mutate"),"production"!==process$1.env.NODE_ENV&&r&&dev.log("can-control: No property found for handling "+e),n._bindings.readyComputes[e]={compute:o,handler:i}}return o.get()}},_lookup:function(e){return[e,window]},_removeDelegateFromKey:function(e){return e},_isDelegate:function(e,t){return"element"===t},_getDelegate:function(e,t){},processors:{},defaults:{},convertElement:function(e){return e="string"==typeof e?document.querySelector(e):e,this.wrapElement(e)},wrapElement:function(e){return e},unwrapElement:function(e){return e},isSpecial:function(e){return"inserted"===e||"removed"===e}},{setup:function(e,t){var n,o=this.constructor,r=o.pluginName||o.shortName;if(!e)throw new Error("Creating an instance of a named control without passing an element");if(this.element=o.convertElement(e),r&&"Control"!==r&&this.element.classList&&this.element.classList.add(r),(n=this.element[controlsSymbol])||(n=[],this.element[controlsSymbol]=n),n.push(this),canReflect.isObservableLike(t)&&canReflect.isMapLike(t)){for(var s in o.defaults)t.hasOwnProperty(s)||observeReader.set(t,s,o.defaults[s]);this.options=t}else this.options=assign(assign({},o.defaults),t);return this.on(),[this.element,this.options]},on:function(e,t,n,o){if(!e){this.off();var r,s,i=this.constructor,a=this._bindings,c=i.actions,l=this.constructor.unwrapElement(this.element),u=Control._shifter(this,"destroy");for(r in c)c.hasOwnProperty(r)&&(s=c[r]||i._action(r,this.options,this))&&(a.control[r]=s.processor(s.delegate||l,s.parts[2],s.parts[1],r,this));var p=domMutate.onNodeRemoval(l,function(){l.ownerDocument.documentElement.contains(l)||u()});return a.user.push(function(){p&&(p(),p=void 0)}),a.user.length}return"string"==typeof e&&(o=n,n=t,t=e,e=this.element),void 0===o&&(o=n,n=t,t=null),"string"==typeof o&&(o=Control._shifter(this,o)),this._bindings.user.push(binder(e,n,o,t)),this._bindings.user.length},off:function(){var e=this.constructor.unwrapElement(this.element),t=this._bindings;t&&((t.user||[]).forEach(function(t){t(e)}),canReflect.eachKey(t.control||{},function(t){t(e)}),canReflect.eachKey(t.readyComputes||{},function(e){canReflect.offValue(e.compute,e.handler,"mutate")})),this._bindings={user:[],control:{},readyComputes:{}}},destroy:function(){if(null!==this.element){var e,t=this.constructor,n=t.pluginName||t.shortName&&require$$0.underscore(t.shortName);this.off(),n&&"can_control"!==n&&this.element.classList&&this.element.classList.remove(n),(e=this.element[controlsSymbol])&&e.splice(e.indexOf(this),1),this.element=null}else"production"!==process$1.env.NODE_ENV&&dev.warn("can-control: Control already destroyed")}});processors=Control.processors,basicProcessor=function(e,t,n,o,r){return binder(e,t,Control._shifter(r,o),n)},["beforeremove","change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave","inserted","removed","dragstart","dragenter","dragover","dragleave","drag","drop","dragend"].forEach(function(e){processors[e]=basicProcessor});var canControl=namespace.Control=Control;export{canControl as a,canControl as b};
//# sourceMappingURL=chunk-d6693ee9.js.map
