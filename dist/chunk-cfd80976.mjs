import"./chunk-5f1245ff.mjs";import{b as require$$0}from"./chunk-037c51df.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import{a as domEvents}from"./chunk-cb75b84f.mjs";import{c as attr,a as viewCallbacks,b as setData}from"./chunk-c1a50ad2.mjs";import{a as canEventDomRadiochange}from"./chunk-fb25cf5d.mjs";import{a as process$1}from"./chunk-bacf0c54.mjs";import"./chunk-862b179d.mjs";import"./chunk-7dfeb1df.mjs";import"./chunk-0c313990.mjs";import"./chunk-fa6b878a.mjs";import{a as SettableObservable}from"./chunk-576d20b1.mjs";import{a as queues}from"./chunk-12ed728f.mjs";import{a as Observation}from"./chunk-c1d5d21e.mjs";import{a as canReflectDeps}from"./chunk-0cc812f8.mjs";import{a as ObservationRecorder}from"./chunk-8811d387.mjs";import"./chunk-91f0208e.mjs";import{d as expression,b as SetterObservable}from"./chunk-615ab838.mjs";import{a as nodeLists}from"./chunk-fd5b3ff3.mjs";import"./chunk-2a7704ed.mjs";import{a as observeReader}from"./chunk-0877ccb7.mjs";import"./chunk-660b4975.mjs";import"./chunk-bd824939.mjs";import{a as dev}from"./chunk-585d4076.mjs";import{a as domMutate}from"./chunk-e442e0a9.mjs";import{a as canSymbol}from"./chunk-b37d91a1.mjs";import"./chunk-faffd3b3.mjs";import{b as makeComputeLike}from"./chunk-ea559428.mjs";import"./chunk-152c0627.mjs";import{a as Bind}from"./chunk-a73c65cc.mjs";import{a as canViewModel}from"./chunk-cc261c5e.mjs";import{a as SimpleObservable}from"./chunk-65b62c71.mjs";import{a as assign}from"./chunk-75bea8d8.mjs";import{a as encoder}from"./chunk-8faf33f1.mjs";var isDomEventTarget=require$$0.isDomEventTarget,canEvent={on:function(e,t,n){isDomEventTarget(this)?domEvents.addEventListener(this,e,t,n):canReflect.onKeyValue(this,e,t,n)},off:function(e,t,n){isDomEventTarget(this)?domEvents.removeEventListener(this,e,t,n):canReflect.offKeyValue(this,e,t,n)},one:function(e,t,n){var i=function(){return canEvent.off.call(this,e,i,n),t.apply(this,arguments)};return canEvent.on.call(this,e,i,n),this}},event=canEvent,isRadioInput=function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},isValidProp=function(e,t){return"checked"===e&&!t.legacyBindings},getEventName=function(e,t,n){var i="change";return isRadioInput(e)&&isValidProp(t,n)&&(i="can-attribute-observable-radiochange"),attr.findSpecialListener(t)&&(i=t),i},internalRadioChangeEventType="can-attribute-observable-radiochange";domEvents.addEvent(canEventDomRadiochange,internalRadioChangeEventType);var isSelect=function(e){return"select"===e.nodeName.toLowerCase()},isMultipleSelect=function(e,t){return isSelect(e)&&"value"===t&&e.multiple},slice=Array.prototype.slice;function canUtilAEL(){var e=slice.call(arguments,0);return e.unshift(this),domEvents.addEventListener.apply(null,e)}function canUtilREL(){var e=slice.call(arguments,0);return e.unshift(this),domEvents.removeEventListener.apply(null,e)}function AttributeObservable(e,t,n,i){this.el=e,this.bound=!1,this.bindingData=n,this.prop=isMultipleSelect(e,t)?"values":t,this.event=i||getEventName(e,t,n),this.handler=this.handler.bind(this),"production"!==process$1.env.NODE_ENV&&(canReflectDeps.addMutatedBy(this.el,this.prop,this),canReflect.assignSymbols(this,{"can.getName":function(){return"AttributeObservable<"+e.nodeName.toLowerCase()+"."+this.prop+">"}}))}AttributeObservable.prototype=Object.create(SettableObservable.prototype),Object.assign(AttributeObservable.prototype,{constructor:AttributeObservable,get:function(){ObservationRecorder.isRecording()&&(ObservationRecorder.add(this),this.bound||Observation.temporarilyBind(this));var e=attr.get(this.el,this.prop);return"function"==typeof e&&(e=e.bind(this.el)),e},set:function(e){return attr.setAttrOrProp(this.el,this.prop,e)||(this._value=e),e},handler:function(e,t){var n=this._value,i=[];this._value=attr.get(this.el,this.prop),this._value!==n&&("production"!==process$1.env.NODE_ENV&&"function"==typeof this._log&&this._log(n,e),i=[this.handlers.getNode([]),this,[e,n]],"production"!==process$1.env.NODE_ENV&&(i=[this.handlers.getNode([]),this,[e,n],null,[this.el,this.prop,"changed to",e,"from",n,"by",t]]),queues.enqueueByQueue.apply(queues,i))},onBound:function(){var e=this;e.bound=!0,e._handler=function(t){e.handler(attr.get(e.el,e.prop),t)},e.event===internalRadioChangeEventType&&event.on.call(e.el,"change",e._handler);var t=attr.findSpecialListener(e.prop);t&&(e._specialDisposal=t.call(e.el,e.prop,e._handler,canUtilAEL)),event.on.call(e.el,e.event,e._handler),this._value=attr.get(this.el,this.prop)},onUnbound:function(){this.bound=!1,this.event===internalRadioChangeEventType&&event.off.call(this.el,"change",this._handler),this._specialDisposal&&(this._specialDisposal.call(this.el,canUtilREL),this._specialDisposal=null),event.off.call(this.el,this.event,this._handler)},valueHasDependencies:function(){return!0},getValueDependencies:function(){var e=new Map,t=new Set;return t.add(this.prop),e.set(this.el,t),{keyDependencies:e}}}),canReflect.assignSymbols(AttributeObservable.prototype,{"can.isMapLike":!1,"can.getValue":AttributeObservable.prototype.get,"can.setValue":AttributeObservable.prototype.set,"can.onValue":AttributeObservable.prototype.on,"can.offValue":AttributeObservable.prototype.off,"can.valueHasDependencies":AttributeObservable.prototype.hasDependencies,"can.getValueDependencies":AttributeObservable.prototype.getValueDependencies});var canAttributeObservable=AttributeObservable,bindings=new Map,onMatchStr="on:",vmMatchStr="vm:",elMatchStr="el:",byMatchStr=":by:",toMatchStr=":to",fromMatchStr=":from",bindMatchStr=":bind",viewModelBindingStr="viewModel",attributeBindingStr="attribute",scopeBindingStr="scope",viewModelOrAttributeBindingStr="viewModelOrAttribute",throwOnlyOneTypeOfBindingError=function(){throw new Error("can-stache-bindings - you can not have contextual bindings ( this:from='value' ) and key bindings ( prop:from='value' ) on one element.")},checkBindingState=function(e,t){var n=t.parentToChild&&t.child===viewModelBindingStr;if(!n)return e;var i=t.childName;if(n&&("this"===i||"."===i)){if(!e.isSettingViewModel&&!e.isSettingOnViewModel)return{isSettingViewModel:!0,initialViewModelData:void 0};throwOnlyOneTypeOfBindingError()}else{if(!e.isSettingViewModel)return{isSettingOnViewModel:!0,initialViewModelData:e.initialViewModelData};throwOnlyOneTypeOfBindingError()}},makeScopeFromEvent=function(e,t,n,i,a){var r={element:e,event:t,viewModel:n,arguments:i};return a.scope.add(r,{special:!0})},runEventCallback=function(e,t,n,i,a,r,o){var s=function(){var t=a.value(i,{doNotWrapInObservation:!0});return"function"==typeof(t=canReflect.isValueLike(t)?canReflect.getValue(t):t)?t(e):t};"production"!==process$1.env.NODE_ENV&&Object.defineProperty(s,"name",{value:r+'="'+o+'"'}),queues.batch.start();var c=[];c=[s,null,null,{}],"production"!==process$1.env.NODE_ENV&&(c=[s,null,null,{reasonLog:[e,t,r+"="+o]}]),queues.mutateQueue.enqueue.apply(queues.mutateQueue,c),queues.batch.stop()},behaviors={viewModel:function(e,t,n,i,a){var r,o=[],s={},c={},l=assign({},i),d={isSettingOnViewModel:!1,isSettingViewModel:!1,initialViewModelData:i||{}},u=!1;if(canReflect.each(e.attributes||[],function(n){var i=makeDataBinding(n,e,{templateType:t.templateType,scope:t.scope,getViewModel:function(){return r},attributeViewModelBindings:l,alreadyUpdatedChild:!0,nodeList:t.parentNodeList,favorViewModel:!0});if(i){var a=i.bindingInfo;if(d=checkBindingState(d,a),u=!0,a.parentToChild){var c=a.stickyParentToChild?makeComputeLike(i.parent):i.canBinding.parentValue;void 0!==c&&(d.isSettingViewModel?d.initialViewModelData=c:d.initialViewModelData[cleanVMName(a.childName,t.scope)]=c)}o.push(i.canBinding.start.bind(i.canBinding)),s[n.name]=i.canBinding.stop.bind(i.canBinding)}}),!a||u){r=n(d.initialViewModelData,u,d);for(var p=0,h=o.length;p<h;p++)o[p]();var v;return d.isSettingViewModel||(v=domMutate.onNodeAttributeChange(e,function(n){var i=n.attributeName,a=e.getAttribute(i);s[i]&&s[i]();var o=c[i]&&c[i].parent===attributeBindingStr;if(null!==a||o){var d=makeDataBinding({name:i,value:a},e,{templateType:t.templateType,scope:t.scope,getViewModel:function(){return r},attributeViewModelBindings:l,initializeValues:!0,nodeList:t.parentNodeList});d&&(d.canBinding.start(),c[i]=d.bindingInfo,s[i]=d.canBinding.stop.bind(d.canBinding))}})),function(){for(var e in v&&(v(),v=void 0),s)s[e]()}}},data:function(e,t){if(!setData.get.call(e,"preventDataBindings")){var n,i,a,r,o=ObservationRecorder.ignore(function(){return n||(n=canViewModel(e))}),s=makeDataBinding({name:t.attributeName,value:e.getAttribute(t.attributeName),nodeList:t.nodeList},e,{templateType:t.templateType,scope:t.scope,getViewModel:o,syncChildWithParent:!1});"production"!==process$1.env.NODE_ENV&&("viewModel"!==s.bindingInfo.child||setData.get(e,"viewModel")||dev.warn("This element does not have a viewModel. (Attempting to bind `"+s.bindingInfo.bindingAttributeName+'="'+s.bindingInfo.parentName+'"`)')),s.canBinding.start();var c=function(){i&&(i(),i=void 0),r&&(r(),r=void 0),a&&(a(),a=void 0)};t.nodeList&&nodeLists.register([],c,t.nodeList,!1),i=s.canBinding.stop.bind(s.canBinding),a=domMutate.onNodeAttributeChange(e,function(n){var a=n.attributeName,r=e.getAttribute(a);if(a===t.attributeName&&(i&&i(),null!==r)){var s=makeDataBinding({name:a,value:r},e,{templateType:t.templateType,scope:t.scope,getViewModel:o,initializeValues:!0,nodeList:t.nodeList,syncChildWithParent:!1});s&&(s.canBinding.start(),i=s.canBinding.stop.bind(s.canBinding)),i=s.onTeardown}}),r=domMutate.onNodeRemoval(e,function(){var t=e.ownerDocument;!1===(t.contains?t:t.documentElement).contains(e)&&c()})}},event:function(e,t){var n,i,a=encoder.decode(t.attributeName);if(-1!==a.indexOf(toMatchStr+":")||-1!==a.indexOf(fromMatchStr+":")||-1!==a.indexOf(bindMatchStr+":"))return this.data(e,t);if(!startsWith.call(a,onMatchStr))throw new Error("can-stache-bindings - unsupported event bindings "+a);n=a.substr(onMatchStr.length);var r=e[canSymbol.for("can.viewModel")],o=t.scope;if(startsWith.call(n,elMatchStr))n=n.substr(elMatchStr.length),i=e;else{startsWith.call(n,vmMatchStr)?(n=n.substr(vmMatchStr.length),i=r,o=r):i=r||e;var s=n.indexOf(byMatchStr);s>=0&&(i=o.get(n.substr(s+byMatchStr.length)),n=n.substr(0,s))}var c,l,d=function(n){var i=e.getAttribute(encoder.encode(a));if(i){var r=canViewModel(e),o=expression.parse(i,{lookupRule:function(){return expression.Lookup},methodRule:"call"}),s=makeScopeFromEvent(e,n,r,arguments,t);if(o instanceof expression.Hashes){var c=o.hashExprs,l=Object.keys(c)[0],d=o.hashExprs[l].value(s),u=canReflect.isObservableLike(d)&&canReflect.isValueLike(d);s.set(l,u?canReflect.getValue(d):d)}else{if(!(o instanceof expression.Call))throw new Error("can-stache-bindings: Event bindings must be a call expression. Make sure you have a () in "+t.attributeName+"="+JSON.stringify(i));runEventCallback(e,n,t,s,o,a,i)}}},u=function(){event.off.call(i,n,d),c&&(c(),c=void 0),l&&(l(),l=void 0)};event.on.call(i,n,d),c=domMutate.onNodeAttributeChange(e,function(t){var n=t.attributeName===a,i=!e.getAttribute(a);n&&i&&u()}),l=domMutate.onNodeRemoval(e,function(){var t=e.ownerDocument;(t.contains?t:t.documentElement).contains(e)||u()})}};bindings.set(/[\w\.:]+:to$/,behaviors.data),bindings.set(/[\w\.:]+:from$/,behaviors.data),bindings.set(/[\w\.:]+:bind$/,behaviors.data),bindings.set(/[\w\.:]+:raw$/,behaviors.data),bindings.set(/[\w\.:]+:to:on:[\w\.:]+/,behaviors.data),bindings.set(/[\w\.:]+:from:on:[\w\.:]+/,behaviors.data),bindings.set(/[\w\.:]+:bind:on:[\w\.:]+/,behaviors.data),bindings.set(/on:[\w\.:]+/,behaviors.event);var getObservableFrom={viewModelOrAttribute:function(e,t,n,i,a,r,o){return e[canSymbol.for("can.viewModel")]?this.viewModel.apply(this,arguments):this.attribute.apply(this,arguments)},scope:function(e,t,n,i,a,r){if(n){if(a||n.indexOf("(")>=0)return expression.parse(n,{baseMethodType:"Call"}).value(t);var o={};canReflect.assignSymbols(o,{"can.getValue":function(){},"can.valueHasDependencies":function(){return!1},"can.setValue":function(e){t.set(cleanVMName(n,t),e)},"can.getWhatIChange":function(){var e=t.getDataForScopeSet(cleanVMName(n,t)),i=new Map,a=new Set;return a.add(e.key),i.set(e.parent,a),{mutate:{keyDependencies:i}}},"can.getName":function(){if("production"!==process$1.env.NODE_ENV){var e="ObservableFromScope<>",i=t.getDataForScopeSet(cleanVMName(n,t));return i.parent&&i.key&&(e="ObservableFromScope<"+canReflect.getName(i.parent)+"."+i.key+">"),e}}});var s=t.getDataForScopeSet(cleanVMName(n,t));return s.parent&&s.key&&canReflectDeps.addMutatedBy(s.parent,s.key,o),o}return new SimpleObservable},viewModel:function(e,t,n,i,a,r,o){var s=cleanVMName(n,t),c="."===n||"this"===n,l=c?[]:observeReader.reads(n);function d(){var e=i.getViewModel();return observeReader.read(e,l,{}).value}"production"!==process$1.env.NODE_ENV&&Object.defineProperty(d,"name",{value:"<"+e.tagName.toLowerCase()+">."+n});var u=new SetterObservable(d,function(e){var t=i.getViewModel();if(r){var n=canReflect.getKeyValue(t,s);canReflect.isObservableLike(n)?canReflect.setValue(n,e):canReflect.setKeyValue(t,s,new SimpleObservable(canReflect.getValue(r)))}else c?canReflect.setValue(t,e):canReflect.setKeyValue(t,s,e)});if("production"!==process$1.env.NODE_ENV){var p=i.getViewModel();p&&s&&canReflectDeps.addMutatedBy(p,s,u)}return u},attribute:function(e,t,n,i,a,r,o,s){return new canAttributeObservable(e,n,i,o)}},startsWith=String.prototype.startsWith||function(e){return 0===this.indexOf(e)};function getEventName$1(e){if(void 0!==e.special.on)return e.tokens[e.special.on+1]}var bindingRules={to:{childToParent:!0,parentToChild:!1,syncChildWithParent:!1},from:{childToParent:!1,parentToChild:!0,syncChildWithParent:!1},bind:{childToParent:!0,parentToChild:!0,syncChildWithParent:!0},raw:{childToParent:!1,parentToChild:!0,syncChildWithParent:!1}},bindingNames=[],special={vm:!0,on:!0};function tokenize(e){var t=e.split(":"),n={tokens:[],special:{}};return t.forEach(function(e){special[e]?n.special[e]=n.tokens.push(e)-1:n.tokens.push(e)}),n}canReflect.each(bindingRules,function(e,t){bindingNames.push(t),special[t]=!0});var canStacheBindings_1,getChildBindingStr=function(e,t){return e.indexOf("vm")>=0?viewModelBindingStr:e.indexOf("el")>=0?attributeBindingStr:t?viewModelBindingStr:viewModelOrAttributeBindingStr},getBindingInfo=function(e,t,n,i,a){var r,o,s,c=encoder.decode(e.name),l=e.value||"",d=tokenize(c);if(bindingNames.forEach(function(e){if(void 0!==d.special[e]&&d.special[e]>0)return o=e,s=d.special[e],!1}),o){var u=getEventName$1(d),p=!u||"bind"===o;return r=assign({parent:scopeBindingStr,child:getChildBindingStr(d.tokens,a),childName:d.tokens[s-1],childEvent:u,bindingAttributeName:c,parentName:d.special.raw?'"'+l+'"':l,initializeValues:p},bindingRules[o]),"~"===l.trim().charAt(0)&&(r.stickyParentToChild=!0),r}},makeDataBinding=function(e,t,n){var i=getBindingInfo(e,n.attributeViewModelBindings,n.templateType,t.nodeName.toLowerCase(),n.favorViewModel);if(i){var a=getObservableFrom[i.parent](t,n.scope,i.parentName,n,i.parentToChild,void 0,void 0,i),r=getObservableFrom[i.child](t,n.scope,i.childName,n,i.childToParent,i.stickyParentToChild&&a,i.childEvent,i),o=!!i.childToParent,s=!!i.parentToChild;"production"!==process$1.env.NODE_ENV&&i.stickyParentToChild&&o&&s&&dev.warn("Two-way binding computes is not supported.");var c={child:r,childToParent:o,cycles:0,onInitDoNotUpdateChild:n.alreadyUpdatedChild,onInitSetUndefinedParentIfChildIsDefined:!0,parent:a,parentToChild:s,priority:n.nodeList?n.nodeList.nesting+1:void 0,queue:"domUI",sticky:i.syncChildWithParent?"childSticksToParent":void 0};if("production"!==process$1.env.NODE_ENV){var l=encoder.decode(e.name)+"="+JSON.stringify(e.value),d="<"+t.nodeName.toLowerCase(),u=d+">",p=function(e,t){return"viewModel"===e?u+"."+t:"scope"===e?"{{"+t+"}}":e+"."+t};c.updateChildName=d+" "+l+"> updates "+p(i.child,i.childName)+" from "+p(i.parent,i.parentName),c.updateParentName=d+" "+l+"> updates "+p(i.parent,i.parentName)+" from "+p(i.child,i.childName)}var h=new Bind(c);return h.startParent(),{bindingInfo:i,canBinding:h,parent:a}}},cleanVMName=function(e,t){if("production"!==process$1.env.NODE_ENV&&e.indexOf("@")>=0){var n=t.peek("scope.filename"),i=t.peek("scope.lineNumber");dev.warn((n?n+":":"")+(i?i+": ":"")+"functions are no longer called by default so @ is unnecessary in '"+e+"'.")}return e.replace(/@/g,"")},canStacheBindings={behaviors:behaviors,getBindingInfo:getBindingInfo,bindings:bindings};canStacheBindings[canSymbol.for("can.callbackMap")]=bindings,viewCallbacks.attrs(canStacheBindings);export{canStacheBindings as a,canStacheBindings as b};
//# sourceMappingURL=chunk-cfd80976.js.map
