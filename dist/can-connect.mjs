import{a as process$1}from"./chunk-bacf0c54.mjs";import{a as connect}from"./chunk-52b41786.mjs";import{a as getItems,b as canRef,c as callbacksCache,d as combineRequests,e as localCache,f as fallThroughCache}from"./chunk-9da91868.mjs";import{a as require$$0,c as connectConstructor,d as canMap,e as dataParse,f as dataUrl}from"./chunk-4c04edbb.mjs";import"./chunk-f81ff71d.mjs";import{a as memoryStore}from"./chunk-d7d8317e.mjs";import{a as constructorStore,b as dataCallbacks,c as realTime,d as callbacksOnce}from"./chunk-3b983740.mjs";import{a as getGlobal}from"./chunk-cc1f8896.mjs";import"./chunk-5f1245ff.mjs";import"./chunk-b37d91a1.mjs";import"./chunk-805ffcb4.mjs";import"./chunk-3b4c7b38.mjs";import"./chunk-54c27a9a.mjs";import"./chunk-7e0220de.mjs";import"./chunk-eae5b219.mjs";import"./chunk-e89b2ed5.mjs";import"./chunk-b52ac488.mjs";import"./chunk-6f2a5c16.mjs";import"./chunk-a661b1ce.mjs";import"./chunk-fa6b878a.mjs";import"./chunk-707fbcc4.mjs";import"./chunk-8a3a072d.mjs";import"./chunk-7dfeb1df.mjs";import"./chunk-862b179d.mjs";import"./chunk-585d4076.mjs";import"./chunk-bd824939.mjs";import"./chunk-75bea8d8.mjs";import"./chunk-79943599.mjs";import"./chunk-2c9f11a8.mjs";import"./chunk-b1806013.mjs";import"./chunk-a9b254be.mjs";import"./chunk-12ed728f.mjs";import"./chunk-8d049599.mjs";import"./chunk-d2889630.mjs";import"./chunk-8811d387.mjs";import"./chunk-825526fa.mjs";import"./chunk-8f9d5c6d.mjs";import"./chunk-660b4975.mjs";import"./chunk-576d20b1.mjs";import"./chunk-65b62c71.mjs";import"./chunk-c1d5d21e.mjs";import"./chunk-f8a6947c.mjs";import"./chunk-037c51df.mjs";import"./chunk-14877182.mjs";import"./chunk-e7f43bec.mjs";import"./chunk-cb75b84f.mjs";import"./chunk-910f3205.mjs";import"./chunk-b2e1c1d8.mjs";import"./chunk-541940e7.mjs";import"./chunk-321b6aa1.mjs";import"./chunk-834a9a33.mjs";import"./chunk-3f0a7243.mjs";import"./chunk-b09dcf0e.mjs";import"./chunk-ed157244.mjs";import"./chunk-17b31772.mjs";import"./chunk-27026eab.mjs";import"./chunk-ac75a622.mjs";import"./chunk-27ff5bb0.mjs";import"./chunk-f0afc07a.mjs";import"./chunk-849fe8d8.mjs";import"./chunk-0826a8c3.mjs";import"./chunk-1e549d43.mjs";import"./chunk-723b8216.mjs";var forEach=Array.prototype.forEach,cacheRequestsBehaviour=connect.behavior("cache-requests",function(c){return{getDiff:function(c,e){var a,t=this;return forEach.call(e,function(e){var n,o=t.queryLogic.difference(c,e);if(t.queryLogic.isDefinedAndHasMembers(o)){var r=t.queryLogic.intersection(c,e);n={needed:o,cached:!!t.queryLogic.isDefinedAndHasMembers(r)&&r,count:t.queryLogic.count(o)}}else t.queryLogic.isSubset(c,e)&&(n={cached:c,count:0});n&&(!a||n.count<a.count)&&(a=n)}),a?{needed:a.needed,cached:a.cached}:{needed:c}},unionMembers:function(c,e,a,t){return{data:this.queryLogic.unionMembers(e.needed,e.cached,getItems(a),getItems(t))}},getListData:function(e){e=e||{};var a=this;return this.cacheConnection.getSets(e).then(function(t){var n=a.getDiff(e,t);if(n.needed){if(n.cached){var o=a.cacheConnection.getListData(n.cached),r=c.getListData(n.needed),s=r.then(function(c){return a.cacheConnection.updateListData(getItems(c),n.needed).then(function(){return c})}),u=Promise.all([o,r]).then(function(c){var t=c[0],o=c[1];return a.unionMembers(e,n,o,t)});return Promise.all([u,s]).then(function(c){return c[0]})}return c.getListData(n.needed).then(function(c){return a.cacheConnection.updateListData(getItems(c),n.needed).then(function(){return c})})}return a.cacheConnection.getListData(n.cached)})}}}),cacheRequests=cacheRequestsBehaviour;if("production"!==process$1.env.NODE_ENV)var validate=require$$0;cacheRequests=validate(cacheRequestsBehaviour,["getListData","cacheConnection"]);var memoryCache=memoryStore,$=getGlobal().$;connect.superMap=function(c){var e=[connectConstructor,canMap,canRef,constructorStore,dataCallbacks,combineRequests,dataParse,dataUrl,realTime,callbacksOnce];return"undefined"!=typeof localStorage&&(c.cacheConnection||(c.cacheConnection=connect([localCache],{name:c.name+"Cache",idProp:c.idProp,queryLogic:c.queryLogic})),e.push(callbacksCache,fallThroughCache)),$&&$.ajax&&(c.ajax=$.ajax),connect(e,c)};var superMap=connect.superMap,$$1=getGlobal().$;connect.baseMap=function(c){var e=[connectConstructor,canMap,canRef,constructorStore,dataCallbacks,dataParse,dataUrl,realTime,callbacksOnce];return $$1&&$$1.ajax&&(c.ajax=$$1.ajax),connect(e,c)};var baseMap=connect.baseMap,require$$0$1=cacheRequests;connect.cacheRequests=require$$0$1,connect.constructor=connectConstructor,connect.constructorCallbacksOnce=callbacksOnce,connect.constructorStore=constructorStore,connect.dataCallbacks=dataCallbacks,connect.dataCallbacksCache=callbacksCache,connect.dataCombineRequests=combineRequests,connect.dataLocalStorageCache=localCache,connect.dataMemoryCache=memoryCache,connect.dataParse=dataParse,connect.dataUrl=dataUrl,connect.fallThroughCache=fallThroughCache,connect.realTime=realTime,connect.superMap=superMap,connect.baseMap=baseMap;var all=connect;export default all;
//# sourceMappingURL=can-connect.js.map
