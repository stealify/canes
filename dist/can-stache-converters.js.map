{"version":3,"file":"can-stache-converters.js","sources":["../node_modules/can-stache-converters/can-stache-converters.js"],"sourcesContent":["\"use strict\";\nvar canReflect = require(\"can-reflect\");\nvar stache = require(\"can-stache\");\nvar stringToAny = require(\"can-string-to-any\");\nvar dev = require(\"can-log/dev/dev\");\nrequire(\"can-stache-bindings\");\nvar stacheHelpers = require(\"can-stache-helpers\");\n\n// feature detect if multiple arguments are going to be passed\n// to an nested function call\nvar shouldPop = false;\nstache(\"{{echo(args(1))}}\")({\n\techo: function(){},\n\targs: function(){\n\t\tshouldPop = ( arguments.length > 1 );\n\t}\n});\n\nstache.registerConverter(\"boolean-to-inList\", {\n\tget: function(item, list){\n\t\tif(!list) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn list.indexOf(item) !== -1;\n\t\t}\n\t},\n\tset: function(newVal, item, list){\n\t\tif(!list) {\n\t\t\treturn;\n\t\t}\n\t\tif(!newVal) {\n\t\t\tvar idx = list.indexOf(item);\n\t\t\tif(idx !== -1) {\n\t\t\t\tlist.splice(idx, 1);\n\t\t\t}\n\t\t} else {\n\t\t\tlist.push(item);\n\t\t}\n\t}\n});\n\nvar converters = {\n\t\"string-to-any\": {\n\t\tget: function(obs){\n\t\t\treturn \"\" + canReflect.getValue(obs);\n\t\t},\n\t\tset: function(newVal, obs){\n\t\t\tvar converted = stringToAny(newVal);\n\t\t\tcanReflect.setValue(obs, converted);\n\t\t}\n\t},\n\t\"index-to-selected\": {\n\t\tget: function(item, list){\n\t\t\tvar val = canReflect.getValue(item);\n\t\t\tvar idx = canReflect.getValue(list).indexOf(val);\n\t\t\treturn idx;\n\t\t},\n\t\tset: function(idx, item, list){\n\t\t\tvar newVal = canReflect.getValue(list)[idx];\n\t\t\tcanReflect.setValue(item, newVal);\n\t\t}\n\t},\n\t\"selected-to-index\": {\n\t\tget: function(idx, list){\n\t\t\tvar val = canReflect.getValue(idx),\n\t\t\t\tlistValue = canReflect.getValue(list);\n\t\t\tvar item = listValue[val];\n\t\t\treturn item;\n\t\t},\n\t\tset: function(item, idx, list){\n\t\t\tvar newVal = canReflect.getValue(list).indexOf(item);\n\t\t\tcanReflect.setValue(idx, newVal);\n\t\t}\n\t},\n\t\"either-or\": {\n\t\tget: function(chosen, a, b){\n\t\t\tvar chosenVal = canReflect.getValue(chosen),\n\t\t\t\taValue = canReflect.getValue(a),\n\t\t\t\tbValue = canReflect.getValue(b);\n\t\t\tvar matchA = (aValue === chosenVal);\n\t\t\tvar matchB = (bValue === chosenVal);\n\n\t\t\tif (!matchA && !matchB) {\n\t\t\t\t//!steal-remove-start\n\t\t\t\tif (process.env.NODE_ENV !== 'production') {\n\t\t\t\t\tdev.warn(\n\t\t\t\t\t\t\"can-stache-converter.either-or:\",\n\t\t\t\t\t\t\"`\" + chosenVal + \"`\",\n\t\t\t\t\t\t\"does not match `\" + aValue + \"`\",\n\t\t\t\t\t\t\"or `\" + bValue + \"`\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\t//!steal-remove-end\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn matchA;\n\t\t\t}\n\t\t},\n\t\tset: function(newVal, chosen, a, b){\n\t\t\tvar setVal = newVal ? canReflect.getValue(a) : canReflect.getValue(b);\n\t\t\tcanReflect.setValue(chosen, setVal);\n\t\t}\n\t},\n\t\"equal\": {\n\t\tget: function(){\n\t\t\tvar args = canReflect.toArray(arguments);\n\t\t\t// We don't need the helperOptions\n\t\t\tif(shouldPop) {\n\t\t\t\targs.pop();\n\t\t\t}\n\t\t\tif (args.length > 1) {\n\t\t\t\tvar comparer = canReflect.getValue( args.pop() );\n\n\t\t\t\treturn args.every(function(obs) {\n\t\t\t\t\tvar value = canReflect.getValue(obs);\n\t\t\t\t\treturn value === comparer;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tset: function(){\n\t\t\tvar args = canReflect.toArray(arguments);\n\t\t\t// Ignore the helperOptions\n\t\t\tif(shouldPop) {\n\t\t\t\targs.pop();\n\t\t\t}\n\t\t\tif (args.length > 2) {\n\t\t\t\tvar b = args.shift();\n\t\t\t\tvar comparer = canReflect.getValue( args.pop() );\n\t\t\t\tif(b) {\n\t\t\t\t\tfor(var i = 0; i < args.length; i++) {\n\t\t\t\t\t\tcanReflect.setValue(args[i], comparer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n// Register itself right away\nstache.addConverter(converters);\n\nif(!stacheHelpers.not) {\n\tstache.addConverter(\"not\",{\n\t\tget: function(obs){\n\t\t\treturn !canReflect.getValue(obs);\n\t\t},\n\t\tset: function(newVal, obs){\n\t\t\tcanReflect.setValue(obs, !newVal);\n\t\t}\n\t});\n}\n\nmodule.exports = converters;\n"],"names":["shouldPop","stache","echo","args","arguments","length","registerConverter","get","item","list","indexOf","set","newVal","push","idx","splice","converters","string-to-any","obs","canReflect","getValue","converted","stringToAny","setValue","index-to-selected","val","selected-to-index","either-or","chosen","a","b","chosenVal","aValue","bValue","matchA","process","env","NODE_ENV","dev","warn","setVal","equal","toArray","pop","comparer","every","shift","i","addConverter","stacheHelpers","not"],"mappings":"0xEAUA,IAAIA,WAAY,EAChBC,OAAO,oBAAPA,CAA4B,CAC3BC,KAAM,aACNC,KAAM,WACLH,UAAcI,UAAUC,OAAS,KAInCJ,OAAOK,kBAAkB,oBAAqB,CAC7CC,IAAK,SAASC,EAAMC,GACnB,QAAIA,IAG4B,IAAxBA,EAAKC,QAAQF,IAGtBG,IAAK,SAASC,EAAQJ,EAAMC,GAC3B,GAAIA,EAGJ,GAAIG,EAMHH,EAAKI,KAAKL,OANC,CACX,IAAIM,EAAML,EAAKC,QAAQF,IACX,IAATM,GACFL,EAAKM,OAAOD,EAAK,OAQrB,IAAIE,WAAa,CAChBC,gBAAiB,CAChBV,IAAK,SAASW,GACb,MAAO,GAAKC,WAAWC,SAASF,IAEjCP,IAAK,SAASC,EAAQM,GACrB,IAAIG,EAAYC,YAAYV,GAC5BO,WAAWI,SAASL,EAAKG,KAG3BG,oBAAqB,CACpBjB,IAAK,SAASC,EAAMC,GACnB,IAAIgB,EAAMN,WAAWC,SAASZ,GAE9B,OADUW,WAAWC,SAASX,GAAMC,QAAQe,IAG7Cd,IAAK,SAASG,EAAKN,EAAMC,GACxB,IAAIG,EAASO,WAAWC,SAASX,GAAMK,GACvCK,WAAWI,SAASf,EAAMI,KAG5Bc,oBAAqB,CACpBnB,IAAK,SAASO,EAAKL,GAClB,IAAIgB,EAAMN,WAAWC,SAASN,GAG9B,OAFaK,WAAWC,SAASX,GACZgB,IAGtBd,IAAK,SAASH,EAAMM,EAAKL,GACxB,IAAIG,EAASO,WAAWC,SAASX,GAAMC,QAAQF,GAC/CW,WAAWI,SAAST,EAAKF,KAG3Be,YAAa,CACZpB,IAAK,SAASqB,EAAQC,EAAGC,GACxB,IAAIC,EAAYZ,WAAWC,SAASQ,GACnCI,EAASb,WAAWC,SAASS,GAC7BI,EAASd,WAAWC,SAASU,GAC1BI,EAAUF,IAAWD,EAGzB,OAAKG,GAFSD,IAAWF,EAiBjBG,OAbsB,eAAzBC,UAAQC,IAAIC,UACfC,IAAIC,KACH,kCACA,IAAMR,EAAY,IAClB,mBAAqBC,EAAS,IAC9B,OAASC,EAAS,OAWtBtB,IAAK,SAASC,EAAQgB,EAAQC,EAAGC,GAChC,IAAIU,EAAS5B,EAASO,WAAWC,SAASS,GAAKV,WAAWC,SAASU,GACnEX,WAAWI,SAASK,EAAQY,KAG9BC,MAAS,CACRlC,IAAK,WACJ,IAAIJ,EAAOgB,WAAWuB,QAAQtC,WAK9B,GAHGJ,WACFG,EAAKwC,MAEFxC,EAAKE,OAAS,EAAG,CACpB,IAAIuC,EAAWzB,WAAWC,SAAUjB,EAAKwC,OAEzC,OAAOxC,EAAK0C,MAAM,SAAS3B,GAE1B,OADYC,WAAWC,SAASF,KACf0B,MAIpBjC,IAAK,WACJ,IAAIR,EAAOgB,WAAWuB,QAAQtC,WAK9B,GAHGJ,WACFG,EAAKwC,MAEFxC,EAAKE,OAAS,EAAG,CACpB,IAAIyB,EAAI3B,EAAK2C,QACTF,EAAWzB,WAAWC,SAAUjB,EAAKwC,OACzC,GAAGb,EACF,IAAI,IAAIiB,EAAI,EAAGA,EAAI5C,EAAKE,OAAQ0C,IAC/B5B,WAAWI,SAASpB,EAAK4C,GAAIH,OASnC3C,OAAO+C,aAAahC,YAEhBiC,cAAcC,KACjBjD,OAAO+C,aAAa,MAAM,CACzBzC,IAAK,SAASW,GACb,OAAQC,WAAWC,SAASF,IAE7BP,IAAK,SAASC,EAAQM,GACrBC,WAAWI,SAASL,GAAMN,MAK7B,wBAAiBI"}