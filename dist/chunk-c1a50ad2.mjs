import{a as commonjsGlobal,b as commonjsRequire,c as unwrapExports,d as createCommonjsModule}from"./chunk-eae5b219.mjs";import"./chunk-805ffcb4.mjs";import{a as domMutate}from"./chunk-e442e0a9.mjs";import"./chunk-e85142ea.mjs";import{a as namespace}from"./chunk-3b4c7b38.mjs";import{a as CID}from"./chunk-cb265e10.mjs";import{a as getDocument}from"./chunk-14877182.mjs";import{a as getGlobal}from"./chunk-cc1f8896.mjs";import"./chunk-037c51df.mjs";import{a as domMutateNode}from"./chunk-d056b3d5.mjs";import{a as getMutationObserver}from"./chunk-fea13b24.mjs";import{a as diff}from"./chunk-3f0a7243.mjs";import"./chunk-862b179d.mjs";import{a as domEvents}from"./chunk-cb75b84f.mjs";import{a as queues}from"./chunk-12ed728f.mjs";import{c as canViewCallbacks}from"./chunk-fd5b3ff3.mjs";var canDomDataState=createCommonjsModule(function(t){var e={},n={},a=function(){var t=CID.get(this),a=!1;return t&&e[t]&&(a=!0,delete e[t]),n[t]&&(n[t](),delete n[t]),a},i={_data:e,_removalDisposalMap:n,getCid:function(){return CID.get(this)},cid:function(){return CID(this)},expando:CID.domExpando,get:function(t){var n=CID.get(this),a=n&&e[n];return void 0===t?a:a&&a[t]},set:function(t,i){var o=CID(this),s=e[o]||(e[o]={});if(void 0!==t&&(s[t]=i,this&&"number"==typeof this.nodeType&&!n[o])){var r=this;n[o]=domMutate.onNodeRemoval(r,function(){r.ownerDocument.contains(r)||setTimeout(function(){a.call(r)},13)})}return s},clean:function(t){var n=CID.get(this),i=e[n];i&&i[t]&&delete i[t],function(t){for(var e in t)return!1;return!0}(i)&&a.call(this)},delete:a};if(namespace.domDataState)throw new Error("You can't have two versions of can-dom-data-state, check your dependencies");t.exports=namespace.domDataState=i}),global$1=getGlobal(),formElements={INPUT:!0,TEXTAREA:!0,SELECT:!0},toString=function(t){return null==t?"":""+t},isSVG=function(t){return"http://www.w3.org/2000/svg"===t.namespaceURI},truthy=function(){return!0},getSpecialTest=function(t){return t&&t.test||truthy},propProp=function(t,e){return(e=e||{}).get=function(){return this[t]},e.set=function(e){this[t]!==e&&(this[t]=e)},e},booleanProp=function(t){return{isBoolean:!0,set:function(e){t in this?this[t]=e:domMutateNode.setAttribute.call(this,t,"")},remove:function(){this[t]=!1}}},setupMO=function(t,e){if(!canDomDataState.get.call(t,"attrMO")){var n=function(){e.call(t)},a=getMutationObserver();if(a){var i=new a(n);i.observe(t,{childList:!0,subtree:!0}),canDomDataState.set.call(t,"attrMO",i)}else canDomDataState.set.call(t,"attrMO",!0),canDomDataState.set.call(t,"canBindingCallback",{onMutation:n})}},_findOptionToSelect=function(t,e){for(var n=t.firstChild;n;){if("OPTION"===n.nodeName&&e===n.value)return n;if("OPTGROUP"===n.nodeName){var a=_findOptionToSelect(n,e);if(a)return a}n=n.nextSibling}},setChildOptions=function(t,e){var n;null!=e&&(n=_findOptionToSelect(t,e)),n?n.selected=!0:t.selectedIndex=-1},forEachOption=function(t,e){for(var n=t.firstChild;n;)"OPTION"===n.nodeName&&e(n),"OPTGROUP"===n.nodeName&&forEachOption(n,e),n=n.nextSibling},collectSelectedOptions=function(t){var e=[];return forEachOption(t,function(t){t.selected&&e.push(t.value)}),e},markSelectedOptions=function(t,e){forEachOption(t,function(t){t.selected=-1!==e.indexOf(t.value)})},setChildOptionsOnChange=function(t,e){var n=canDomDataState.get.call(t,"attrSetChildOptions");return n?Function.prototype:(n=function(){setChildOptions(t,t.value)},canDomDataState.set.call(t,"attrSetChildOptions",n),e.call(t,"change",n),function(e){canDomDataState.clean.call(t,"attrSetChildOptions"),e.call(t,"change",n)})},behaviorRules=new Map,isPropWritable=function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);if(n)return n.writable||n.set;var a=Object.getPrototypeOf(t);return!!a&&isPropWritable(a,e)},cacheRule=function(t,e,n){var a;return(a=behaviorRules.get(t.prototype))||(a={},behaviorRules.set(t.constructor,a)),a[e]=n,n},specialAttributes={checked:{get:function(){return this.checked},set:function(t){var e=!!t||""===t||0===arguments.length;this.checked=e,e&&"radio"===this.type&&(this.defaultChecked=!0)},remove:function(){this.checked=!1},test:function(){return"INPUT"===this.nodeName}},class:{get:function(){return isSVG(this)?this.getAttribute("class"):this.className},set:function(t){t=t||"",isSVG(this)?domMutateNode.setAttribute.call(this,"class",""+t):this.className=t}},disabled:booleanProp("disabled"),focused:{get:function(){return this===document.activeElement},set:function(t){var e=attr.get(this,"focused"),n=this.ownerDocument.documentElement,a=this;function i(){t?a.focus():a.blur()}if(e!==t)if(n.contains(a))queues.enqueueByQueue({mutate:[i]},null,[]);else var o=domMutate.onNodeInsertion(a,function(){o(),i()});return!0},addEventListener:function(t,e,n){return n.call(this,"focus",e),n.call(this,"blur",e),function(t){t.call(this,"focus",e),t.call(this,"blur",e)}},test:function(){return"INPUT"===this.nodeName}},for:propProp("htmlFor"),innertext:propProp("innerText"),innerhtml:propProp("innerHTML"),innerHTML:propProp("innerHTML",{addEventListener:function(t,e,n){var a=[],i=this;return["change","blur"].forEach(function(t){var n=function(){e.apply(this,arguments)};domEvents.addEventListener(i,t,n),a.push([t,n])}),function(t){a.forEach(function(e){t.call(i,e[0],e[1])})}}}),required:booleanProp("required"),readonly:booleanProp("readOnly"),selected:{get:function(){return this.selected},set:function(t){t=!!t,canDomDataState.set.call(this,"lastSetValue",t),this.selected=t},addEventListener:function(t,e,n){var a=this,i=this.parentNode,o=a.selected,s=function(e){var n=a.selected;n!==(o=canDomDataState.get.call(a,"lastSetValue")||o)&&(o=n,domEvents.dispatch(a,t))},r=setChildOptionsOnChange(i,n);return domEvents.addEventListener(i,"change",s),n.call(a,t,e),function(n){r(n),domEvents.removeEventListener(i,"change",s),n.call(a,t,e)}},test:function(){return"OPTION"===this.nodeName&&this.parentNode&&"SELECT"===this.parentNode.nodeName}},style:{set:function(){var t=global$1.document&&getDocument().createElement("div");return t&&t.style&&"cssText"in t.style?function(t){this.style.cssText=t||""}:function(t){domMutateNode.setAttribute.call(this,"style",t)}}()},textcontent:propProp("textContent"),value:{get:function(){var t=this.value;return"SELECT"===this.nodeName&&"selectedIndex"in this&&-1===this.selectedIndex&&(t=void 0),t},set:function(t){var e=this.nodeName.toLowerCase();if("input"===e&&(t=toString(t)),this.value===t&&"option"!==e||(this.value=t),"input"!==e&&"textarea"!==e||(this.defaultValue=t),"select"===e){if(canDomDataState.set.call(this,"attrValueLastVal",t),setChildOptions(this,null===t?t:this.value),!this.ownerDocument.documentElement.contains(this))var n=this,a=domMutate.onNodeInsertion(n,function(){a(),setChildOptions(n,null===t?t:n.value)});setupMO(this,function(){var t=canDomDataState.get.call(this,"attrValueLastVal");attr.set(this,"value",t),domEvents.dispatch(this,"change")})}},test:function(){return formElements[this.nodeName]}},values:{get:function(){return collectSelectedOptions(this)},set:function(t){markSelectedOptions(this,t=t||[]),canDomDataState.set.call(this,"stickyValues",attr.get(this,"values")),setupMO(this,function(){var t=canDomDataState.get.call(this,"stickyValues");attr.set(this,"values",t);var e=canDomDataState.get.call(this,"stickyValues");diff(t.slice().sort(),e.slice().sort()).length&&domEvents.dispatch(this,"values")})},addEventListener:function(t,e,n){var a=function(){domEvents.dispatch(this,"values")};return domEvents.addEventListener(this,"change",a),n.call(this,t,e),function(n){domEvents.removeEventListener(this,"change",a),n.call(this,t,e)}}}},attr={rules:behaviorRules,specialAttributes:specialAttributes,getRule:function(t,e){var n=specialAttributes[e];if(n)return n;var a=behaviorRules.get(t.constructor),i=a&&a[e];if(i)return i;if(!(e in t))return this.attribute(e);var o=isPropWritable(t,e)?this.property(e):this.attribute(e);return cacheRule(t,e,o)},attribute:function(t){return{get:function(){return this.getAttribute(t)},set:function(e){domMutateNode.setAttribute.call(this,t,e)}}},property:function(t){return{get:function(){return this[t]},set:function(e){this[t]=e}}},findSpecialListener:function(t){return specialAttributes[t]&&specialAttributes[t].addEventListener},setAttrOrProp:function(t,e,n){return this.set(t,e,n)},set:function(t,e,n){var a=this.getRule(t,e),i=a&&a.set;if(i)return i.call(t,n)},get:function(t,e){var n=this.getRule(t,e),a=n&&n.get;if(a)return n.test?n.test.call(t)&&a.call(t):a.call(t)},remove:function(t,e){e=e.toLowerCase();var n=specialAttributes[e],a=n&&n.set,i=n&&n.remove,o=getSpecialTest(n);"function"==typeof i&&o.call(t)?i.call(t):"function"==typeof a&&o.call(t)?a.call(t,void 0):domMutateNode.removeAttribute.call(t,e)}},behaviors=attr;export{canViewCallbacks as a,canDomDataState as b,behaviors as c};
//# sourceMappingURL=chunk-c1a50ad2.js.map
