import{a as canNdjsonStream}from"./chunk-40ce4720.mjs";import{a as connect}from"./chunk-52b41786.mjs";import{a as sortedSetJSON}from"./chunk-6f2a5c16.mjs";import"./chunk-5f1245ff.mjs";import"./chunk-805ffcb4.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import{a as namespace}from"./chunk-3b4c7b38.mjs";import"./chunk-54c27a9a.mjs";import"./chunk-b37d91a1.mjs";import"./chunk-bacf0c54.mjs";var connectNdjson=connect.behavior("data-ndjson",function(t){try{if(new ReadableStream,"function"!=typeof window.fetch)throw new Error("fetch not supported")}catch(t){return{}}return{hydrateList:function(e,a){a=a||this.listSet(e);var n=sortedSetJSON(a),s=t.hydrateList.call(this,e,a);return this._getHydrateListCallbacks[n]&&(this._getHydrateListCallbacks[n].shift()(s),this._getHydrateListCallbacks[n].length||delete this._getHydrateListCallbacks[n]),s},_getHydrateListCallbacks:{},_getHydrateList:function(t,e){var a=sortedSetJSON(t);this._getHydrateListCallbacks[a]||(this._getHydrateListCallbacks[a]=[]),this._getHydrateListCallbacks[a].push(e)},getListData:function(t){var e=fetch(this.ndjson||this.url);return this._getHydrateList(t,function(t){function a(e){canReflect.setKeyValue(t,"isStreaming",!1),canReflect.setKeyValue(t,"streamError",e)}e.then(function(e){return canReflect.setKeyValue(t,"isStreaming",!0),canNdjsonStream(e.body)}).then(function(e){var n=e.getReader();n.read().then(function e(s){s.done?canReflect.setKeyValue(t,"isStreaming",!1):(t.push(s.value),n.read().then(e,a))},a)})}),e.then(function(){return{data:[]}})}}}),canConnectNdjson=namespace.connectNdjson=connectNdjson;export default canConnectNdjson;
//# sourceMappingURL=can-connect-ndjson.js.map
