{"version":3,"file":"chunk-ab664507.js","sources":["../node_modules/kefir/dist/kefir.js","../node_modules/can-kefir/can-kefir.js"],"sourcesContent":["/*! Kefir.js v3.8.5\n *  https://github.com/kefirjs/kefir\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.Kefir = global.Kefir || {})));\n}(this, (function (exports) { 'use strict';\n\nfunction createObj(proto) {\n  var F = function () {};\n  F.prototype = proto;\n  return new F();\n}\n\nfunction extend(target /*, mixin1, mixin2...*/) {\n  var length = arguments.length,\n      i = void 0,\n      prop = void 0;\n  for (i = 1; i < length; i++) {\n    for (prop in arguments[i]) {\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n}\n\nfunction inherit(Child, Parent /*, mixin1, mixin2...*/) {\n  var length = arguments.length,\n      i = void 0;\n  Child.prototype = createObj(Parent.prototype);\n  Child.prototype.constructor = Child;\n  for (i = 2; i < length; i++) {\n    extend(Child.prototype, arguments[i]);\n  }\n  return Child;\n}\n\nvar NOTHING = ['<nothing>'];\nvar END = 'end';\nvar VALUE = 'value';\nvar ERROR = 'error';\nvar ANY = 'any';\n\nfunction concat(a, b) {\n  var result = void 0,\n      length = void 0,\n      i = void 0,\n      j = void 0;\n  if (a.length === 0) {\n    return b;\n  }\n  if (b.length === 0) {\n    return a;\n  }\n  j = 0;\n  result = new Array(a.length + b.length);\n  length = a.length;\n  for (i = 0; i < length; i++, j++) {\n    result[j] = a[i];\n  }\n  length = b.length;\n  for (i = 0; i < length; i++, j++) {\n    result[j] = b[i];\n  }\n  return result;\n}\n\nfunction find(arr, value) {\n  var length = arr.length,\n      i = void 0;\n  for (i = 0; i < length; i++) {\n    if (arr[i] === value) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction findByPred(arr, pred) {\n  var length = arr.length,\n      i = void 0;\n  for (i = 0; i < length; i++) {\n    if (pred(arr[i])) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction cloneArray(input) {\n  var length = input.length,\n      result = new Array(length),\n      i = void 0;\n  for (i = 0; i < length; i++) {\n    result[i] = input[i];\n  }\n  return result;\n}\n\nfunction remove(input, index) {\n  var length = input.length,\n      result = void 0,\n      i = void 0,\n      j = void 0;\n  if (index >= 0 && index < length) {\n    if (length === 1) {\n      return [];\n    } else {\n      result = new Array(length - 1);\n      for (i = 0, j = 0; i < length; i++) {\n        if (i !== index) {\n          result[j] = input[i];\n          j++;\n        }\n      }\n      return result;\n    }\n  } else {\n    return input;\n  }\n}\n\nfunction map(input, fn) {\n  var length = input.length,\n      result = new Array(length),\n      i = void 0;\n  for (i = 0; i < length; i++) {\n    result[i] = fn(input[i]);\n  }\n  return result;\n}\n\nfunction forEach(arr, fn) {\n  var length = arr.length,\n      i = void 0;\n  for (i = 0; i < length; i++) {\n    fn(arr[i]);\n  }\n}\n\nfunction fillArray(arr, value) {\n  var length = arr.length,\n      i = void 0;\n  for (i = 0; i < length; i++) {\n    arr[i] = value;\n  }\n}\n\nfunction contains(arr, value) {\n  return find(arr, value) !== -1;\n}\n\nfunction slide(cur, next, max) {\n  var length = Math.min(max, cur.length + 1),\n      offset = cur.length - length + 1,\n      result = new Array(length),\n      i = void 0;\n  for (i = offset; i < length; i++) {\n    result[i - offset] = cur[i];\n  }\n  result[length - 1] = next;\n  return result;\n}\n\nfunction callSubscriber(type, fn, event) {\n  if (type === ANY) {\n    fn(event);\n  } else if (type === event.type) {\n    if (type === VALUE || type === ERROR) {\n      fn(event.value);\n    } else {\n      fn();\n    }\n  }\n}\n\nfunction Dispatcher() {\n  this._items = [];\n  this._spies = [];\n  this._inLoop = 0;\n  this._removedItems = null;\n}\n\nextend(Dispatcher.prototype, {\n  add: function (type, fn) {\n    this._items = concat(this._items, [{ type: type, fn: fn }]);\n    return this._items.length;\n  },\n  remove: function (type, fn) {\n    var index = findByPred(this._items, function (x) {\n      return x.type === type && x.fn === fn;\n    });\n\n    // if we're currently in a notification loop,\n    // remember this subscriber was removed\n    if (this._inLoop !== 0 && index !== -1) {\n      if (this._removedItems === null) {\n        this._removedItems = [];\n      }\n      this._removedItems.push(this._items[index]);\n    }\n\n    this._items = remove(this._items, index);\n    return this._items.length;\n  },\n  addSpy: function (fn) {\n    this._spies = concat(this._spies, [fn]);\n    return this._spies.length;\n  },\n\n\n  // Because spies are only ever a function that perform logging as\n  // their only side effect, we don't need the same complicated\n  // removal logic like in remove()\n  removeSpy: function (fn) {\n    this._spies = remove(this._spies, this._spies.indexOf(fn));\n    return this._spies.length;\n  },\n  dispatch: function (event) {\n    this._inLoop++;\n    for (var i = 0, spies = this._spies; this._spies !== null && i < spies.length; i++) {\n      spies[i](event);\n    }\n\n    for (var _i = 0, items = this._items; _i < items.length; _i++) {\n      // cleanup was called\n      if (this._items === null) {\n        break;\n      }\n\n      // this subscriber was removed\n      if (this._removedItems !== null && contains(this._removedItems, items[_i])) {\n        continue;\n      }\n\n      callSubscriber(items[_i].type, items[_i].fn, event);\n    }\n    this._inLoop--;\n    if (this._inLoop === 0) {\n      this._removedItems = null;\n    }\n  },\n  cleanup: function () {\n    this._items = null;\n    this._spies = null;\n  }\n});\n\nfunction Observable() {\n  this._dispatcher = new Dispatcher();\n  this._active = false;\n  this._alive = true;\n  this._activating = false;\n  this._logHandlers = null;\n  this._spyHandlers = null;\n}\n\nextend(Observable.prototype, {\n  _name: 'observable',\n\n  _onActivation: function () {},\n  _onDeactivation: function () {},\n  _setActive: function (active) {\n    if (this._active !== active) {\n      this._active = active;\n      if (active) {\n        this._activating = true;\n        this._onActivation();\n        this._activating = false;\n      } else {\n        this._onDeactivation();\n      }\n    }\n  },\n  _clear: function () {\n    this._setActive(false);\n    this._dispatcher.cleanup();\n    this._dispatcher = null;\n    this._logHandlers = null;\n  },\n  _emit: function (type, x) {\n    switch (type) {\n      case VALUE:\n        return this._emitValue(x);\n      case ERROR:\n        return this._emitError(x);\n      case END:\n        return this._emitEnd();\n    }\n  },\n  _emitValue: function (value) {\n    if (this._alive) {\n      this._dispatcher.dispatch({ type: VALUE, value: value });\n    }\n  },\n  _emitError: function (value) {\n    if (this._alive) {\n      this._dispatcher.dispatch({ type: ERROR, value: value });\n    }\n  },\n  _emitEnd: function () {\n    if (this._alive) {\n      this._alive = false;\n      this._dispatcher.dispatch({ type: END });\n      this._clear();\n    }\n  },\n  _on: function (type, fn) {\n    if (this._alive) {\n      this._dispatcher.add(type, fn);\n      this._setActive(true);\n    } else {\n      callSubscriber(type, fn, { type: END });\n    }\n    return this;\n  },\n  _off: function (type, fn) {\n    if (this._alive) {\n      var count = this._dispatcher.remove(type, fn);\n      if (count === 0) {\n        this._setActive(false);\n      }\n    }\n    return this;\n  },\n  onValue: function (fn) {\n    return this._on(VALUE, fn);\n  },\n  onError: function (fn) {\n    return this._on(ERROR, fn);\n  },\n  onEnd: function (fn) {\n    return this._on(END, fn);\n  },\n  onAny: function (fn) {\n    return this._on(ANY, fn);\n  },\n  offValue: function (fn) {\n    return this._off(VALUE, fn);\n  },\n  offError: function (fn) {\n    return this._off(ERROR, fn);\n  },\n  offEnd: function (fn) {\n    return this._off(END, fn);\n  },\n  offAny: function (fn) {\n    return this._off(ANY, fn);\n  },\n  observe: function (observerOrOnValue, onError, onEnd) {\n    var _this = this;\n    var closed = false;\n\n    var observer = !observerOrOnValue || typeof observerOrOnValue === 'function' ? { value: observerOrOnValue, error: onError, end: onEnd } : observerOrOnValue;\n\n    var handler = function (event) {\n      if (event.type === END) {\n        closed = true;\n      }\n      if (event.type === VALUE && observer.value) {\n        observer.value(event.value);\n      } else if (event.type === ERROR && observer.error) {\n        observer.error(event.value);\n      } else if (event.type === END && observer.end) {\n        observer.end(event.value);\n      }\n    };\n\n    this.onAny(handler);\n\n    return {\n      unsubscribe: function () {\n        if (!closed) {\n          _this.offAny(handler);\n          closed = true;\n        }\n      },\n\n      get closed() {\n        return closed;\n      }\n    };\n  },\n\n\n  // A and B must be subclasses of Stream and Property (order doesn't matter)\n  _ofSameType: function (A, B) {\n    return A.prototype.getType() === this.getType() ? A : B;\n  },\n  setName: function (sourceObs /* optional */, selfName) {\n    this._name = selfName ? sourceObs._name + '.' + selfName : sourceObs;\n    return this;\n  },\n  log: function () {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.toString();\n\n    var isCurrent = void 0;\n    var handler = function (event) {\n      var type = '<' + event.type + (isCurrent ? ':current' : '') + '>';\n      if (event.type === END) {\n        console.log(name, type);\n      } else {\n        console.log(name, type, event.value);\n      }\n    };\n\n    if (this._alive) {\n      if (!this._logHandlers) {\n        this._logHandlers = [];\n      }\n      this._logHandlers.push({ name: name, handler: handler });\n    }\n\n    isCurrent = true;\n    this.onAny(handler);\n    isCurrent = false;\n\n    return this;\n  },\n  offLog: function () {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.toString();\n\n    if (this._logHandlers) {\n      var handlerIndex = findByPred(this._logHandlers, function (obj) {\n        return obj.name === name;\n      });\n      if (handlerIndex !== -1) {\n        this.offAny(this._logHandlers[handlerIndex].handler);\n        this._logHandlers.splice(handlerIndex, 1);\n      }\n    }\n\n    return this;\n  },\n  spy: function () {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.toString();\n\n    var handler = function (event) {\n      var type = '<' + event.type + '>';\n      if (event.type === END) {\n        console.log(name, type);\n      } else {\n        console.log(name, type, event.value);\n      }\n    };\n    if (this._alive) {\n      if (!this._spyHandlers) {\n        this._spyHandlers = [];\n      }\n      this._spyHandlers.push({ name: name, handler: handler });\n      this._dispatcher.addSpy(handler);\n    }\n    return this;\n  },\n  offSpy: function () {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.toString();\n\n    if (this._spyHandlers) {\n      var handlerIndex = findByPred(this._spyHandlers, function (obj) {\n        return obj.name === name;\n      });\n      if (handlerIndex !== -1) {\n        this._dispatcher.removeSpy(this._spyHandlers[handlerIndex].handler);\n        this._spyHandlers.splice(handlerIndex, 1);\n      }\n    }\n    return this;\n  }\n});\n\n// extend() can't handle `toString` in IE8\nObservable.prototype.toString = function () {\n  return '[' + this._name + ']';\n};\n\nfunction Stream() {\n  Observable.call(this);\n}\n\ninherit(Stream, Observable, {\n  _name: 'stream',\n\n  getType: function () {\n    return 'stream';\n  }\n});\n\nfunction Property() {\n  Observable.call(this);\n  this._currentEvent = null;\n}\n\ninherit(Property, Observable, {\n  _name: 'property',\n\n  _emitValue: function (value) {\n    if (this._alive) {\n      this._currentEvent = { type: VALUE, value: value };\n      if (!this._activating) {\n        this._dispatcher.dispatch({ type: VALUE, value: value });\n      }\n    }\n  },\n  _emitError: function (value) {\n    if (this._alive) {\n      this._currentEvent = { type: ERROR, value: value };\n      if (!this._activating) {\n        this._dispatcher.dispatch({ type: ERROR, value: value });\n      }\n    }\n  },\n  _emitEnd: function () {\n    if (this._alive) {\n      this._alive = false;\n      if (!this._activating) {\n        this._dispatcher.dispatch({ type: END });\n      }\n      this._clear();\n    }\n  },\n  _on: function (type, fn) {\n    if (this._alive) {\n      this._dispatcher.add(type, fn);\n      this._setActive(true);\n    }\n    if (this._currentEvent !== null) {\n      callSubscriber(type, fn, this._currentEvent);\n    }\n    if (!this._alive) {\n      callSubscriber(type, fn, { type: END });\n    }\n    return this;\n  },\n  getType: function () {\n    return 'property';\n  }\n});\n\nvar neverS = new Stream();\nneverS._emitEnd();\nneverS._name = 'never';\n\nfunction never() {\n  return neverS;\n}\n\nfunction timeBased(mixin) {\n  function AnonymousStream(wait, options) {\n    var _this = this;\n\n    Stream.call(this);\n    this._wait = wait;\n    this._intervalId = null;\n    this._$onTick = function () {\n      return _this._onTick();\n    };\n    this._init(options);\n  }\n\n  inherit(AnonymousStream, Stream, {\n    _init: function () {},\n    _free: function () {},\n    _onTick: function () {},\n    _onActivation: function () {\n      this._intervalId = setInterval(this._$onTick, this._wait);\n    },\n    _onDeactivation: function () {\n      if (this._intervalId !== null) {\n        clearInterval(this._intervalId);\n        this._intervalId = null;\n      }\n    },\n    _clear: function () {\n      Stream.prototype._clear.call(this);\n      this._$onTick = null;\n      this._free();\n    }\n  }, mixin);\n\n  return AnonymousStream;\n}\n\nvar S = timeBased({\n  _name: 'later',\n\n  _init: function (_ref) {\n    var x = _ref.x;\n\n    this._x = x;\n  },\n  _free: function () {\n    this._x = null;\n  },\n  _onTick: function () {\n    this._emitValue(this._x);\n    this._emitEnd();\n  }\n});\n\nfunction later(wait, x) {\n  return new S(wait, { x: x });\n}\n\nvar S$1 = timeBased({\n  _name: 'interval',\n\n  _init: function (_ref) {\n    var x = _ref.x;\n\n    this._x = x;\n  },\n  _free: function () {\n    this._x = null;\n  },\n  _onTick: function () {\n    this._emitValue(this._x);\n  }\n});\n\nfunction interval(wait, x) {\n  return new S$1(wait, { x: x });\n}\n\nvar S$2 = timeBased({\n  _name: 'sequentially',\n\n  _init: function (_ref) {\n    var xs = _ref.xs;\n\n    this._xs = cloneArray(xs);\n  },\n  _free: function () {\n    this._xs = null;\n  },\n  _onTick: function () {\n    if (this._xs.length === 1) {\n      this._emitValue(this._xs[0]);\n      this._emitEnd();\n    } else {\n      this._emitValue(this._xs.shift());\n    }\n  }\n});\n\nfunction sequentially(wait, xs) {\n  return xs.length === 0 ? never() : new S$2(wait, { xs: xs });\n}\n\nvar S$3 = timeBased({\n  _name: 'fromPoll',\n\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _onTick: function () {\n    var fn = this._fn;\n    this._emitValue(fn());\n  }\n});\n\nfunction fromPoll(wait, fn) {\n  return new S$3(wait, { fn: fn });\n}\n\nfunction emitter(obs) {\n  function value(x) {\n    obs._emitValue(x);\n    return obs._active;\n  }\n\n  function error(x) {\n    obs._emitError(x);\n    return obs._active;\n  }\n\n  function end() {\n    obs._emitEnd();\n    return obs._active;\n  }\n\n  function event(e) {\n    obs._emit(e.type, e.value);\n    return obs._active;\n  }\n\n  return {\n    value: value,\n    error: error,\n    end: end,\n    event: event,\n\n    // legacy\n    emit: value,\n    emitEvent: event\n  };\n}\n\nvar S$4 = timeBased({\n  _name: 'withInterval',\n\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n    this._emitter = emitter(this);\n  },\n  _free: function () {\n    this._fn = null;\n    this._emitter = null;\n  },\n  _onTick: function () {\n    var fn = this._fn;\n    fn(this._emitter);\n  }\n});\n\nfunction withInterval(wait, fn) {\n  return new S$4(wait, { fn: fn });\n}\n\nfunction S$5(fn) {\n  Stream.call(this);\n  this._fn = fn;\n  this._unsubscribe = null;\n}\n\ninherit(S$5, Stream, {\n  _name: 'stream',\n\n  _onActivation: function () {\n    var fn = this._fn;\n    var unsubscribe = fn(emitter(this));\n    this._unsubscribe = typeof unsubscribe === 'function' ? unsubscribe : null;\n\n    // fix https://github.com/kefirjs/kefir/issues/35\n    if (!this._active) {\n      this._callUnsubscribe();\n    }\n  },\n  _callUnsubscribe: function () {\n    if (this._unsubscribe !== null) {\n      this._unsubscribe();\n      this._unsubscribe = null;\n    }\n  },\n  _onDeactivation: function () {\n    this._callUnsubscribe();\n  },\n  _clear: function () {\n    Stream.prototype._clear.call(this);\n    this._fn = null;\n  }\n});\n\nfunction stream(fn) {\n  return new S$5(fn);\n}\n\nfunction fromCallback(callbackConsumer) {\n  var called = false;\n\n  return stream(function (emitter) {\n    if (!called) {\n      callbackConsumer(function (x) {\n        emitter.emit(x);\n        emitter.end();\n      });\n      called = true;\n    }\n  }).setName('fromCallback');\n}\n\nfunction fromNodeCallback(callbackConsumer) {\n  var called = false;\n\n  return stream(function (emitter) {\n    if (!called) {\n      callbackConsumer(function (error, x) {\n        if (error) {\n          emitter.error(error);\n        } else {\n          emitter.emit(x);\n        }\n        emitter.end();\n      });\n      called = true;\n    }\n  }).setName('fromNodeCallback');\n}\n\nfunction spread(fn, length) {\n  switch (length) {\n    case 0:\n      return function () {\n        return fn();\n      };\n    case 1:\n      return function (a) {\n        return fn(a[0]);\n      };\n    case 2:\n      return function (a) {\n        return fn(a[0], a[1]);\n      };\n    case 3:\n      return function (a) {\n        return fn(a[0], a[1], a[2]);\n      };\n    case 4:\n      return function (a) {\n        return fn(a[0], a[1], a[2], a[3]);\n      };\n    default:\n      return function (a) {\n        return fn.apply(null, a);\n      };\n  }\n}\n\nfunction apply(fn, c, a) {\n  var aLength = a ? a.length : 0;\n  if (c == null) {\n    switch (aLength) {\n      case 0:\n        return fn();\n      case 1:\n        return fn(a[0]);\n      case 2:\n        return fn(a[0], a[1]);\n      case 3:\n        return fn(a[0], a[1], a[2]);\n      case 4:\n        return fn(a[0], a[1], a[2], a[3]);\n      default:\n        return fn.apply(null, a);\n    }\n  } else {\n    switch (aLength) {\n      case 0:\n        return fn.call(c);\n      default:\n        return fn.apply(c, a);\n    }\n  }\n}\n\nfunction fromSubUnsub(sub, unsub, transformer /* Function | falsey */) {\n  return stream(function (emitter) {\n    var handler = transformer ? function () {\n      emitter.emit(apply(transformer, this, arguments));\n    } : function (x) {\n      emitter.emit(x);\n    };\n\n    sub(handler);\n    return function () {\n      return unsub(handler);\n    };\n  }).setName('fromSubUnsub');\n}\n\nvar pairs = [['addEventListener', 'removeEventListener'], ['addListener', 'removeListener'], ['on', 'off']];\n\nfunction fromEvents(target, eventName, transformer) {\n  var sub = void 0,\n      unsub = void 0;\n\n  for (var i = 0; i < pairs.length; i++) {\n    if (typeof target[pairs[i][0]] === 'function' && typeof target[pairs[i][1]] === 'function') {\n      sub = pairs[i][0];\n      unsub = pairs[i][1];\n      break;\n    }\n  }\n\n  if (sub === undefined) {\n    throw new Error(\"target don't support any of \" + 'addEventListener/removeEventListener, addListener/removeListener, on/off method pair');\n  }\n\n  return fromSubUnsub(function (handler) {\n    return target[sub](eventName, handler);\n  }, function (handler) {\n    return target[unsub](eventName, handler);\n  }, transformer).setName('fromEvents');\n}\n\n// HACK:\n//   We don't call parent Class constructor, but instead putting all necessary\n//   properties into prototype to simulate ended Property\n//   (see Propperty and Observable classes).\n\nfunction P(value) {\n  this._currentEvent = { type: 'value', value: value, current: true };\n}\n\ninherit(P, Property, {\n  _name: 'constant',\n  _active: false,\n  _activating: false,\n  _alive: false,\n  _dispatcher: null,\n  _logHandlers: null\n});\n\nfunction constant(x) {\n  return new P(x);\n}\n\n// HACK:\n//   We don't call parent Class constructor, but instead putting all necessary\n//   properties into prototype to simulate ended Property\n//   (see Propperty and Observable classes).\n\nfunction P$1(value) {\n  this._currentEvent = { type: 'error', value: value, current: true };\n}\n\ninherit(P$1, Property, {\n  _name: 'constantError',\n  _active: false,\n  _activating: false,\n  _alive: false,\n  _dispatcher: null,\n  _logHandlers: null\n});\n\nfunction constantError(x) {\n  return new P$1(x);\n}\n\nfunction createConstructor(BaseClass, name) {\n  return function AnonymousObservable(source, options) {\n    var _this = this;\n\n    BaseClass.call(this);\n    this._source = source;\n    this._name = source._name + '.' + name;\n    this._init(options);\n    this._$handleAny = function (event) {\n      return _this._handleAny(event);\n    };\n  };\n}\n\nfunction createClassMethods(BaseClass) {\n  return {\n    _init: function () {},\n    _free: function () {},\n    _handleValue: function (x) {\n      this._emitValue(x);\n    },\n    _handleError: function (x) {\n      this._emitError(x);\n    },\n    _handleEnd: function () {\n      this._emitEnd();\n    },\n    _handleAny: function (event) {\n      switch (event.type) {\n        case VALUE:\n          return this._handleValue(event.value);\n        case ERROR:\n          return this._handleError(event.value);\n        case END:\n          return this._handleEnd();\n      }\n    },\n    _onActivation: function () {\n      this._source.onAny(this._$handleAny);\n    },\n    _onDeactivation: function () {\n      this._source.offAny(this._$handleAny);\n    },\n    _clear: function () {\n      BaseClass.prototype._clear.call(this);\n      this._source = null;\n      this._$handleAny = null;\n      this._free();\n    }\n  };\n}\n\nfunction createStream(name, mixin) {\n  var S = createConstructor(Stream, name);\n  inherit(S, Stream, createClassMethods(Stream), mixin);\n  return S;\n}\n\nfunction createProperty(name, mixin) {\n  var P = createConstructor(Property, name);\n  inherit(P, Property, createClassMethods(Property), mixin);\n  return P;\n}\n\nvar P$2 = createProperty('toProperty', {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._getInitialCurrent = fn;\n  },\n  _onActivation: function () {\n    if (this._getInitialCurrent !== null) {\n      var getInitial = this._getInitialCurrent;\n      this._emitValue(getInitial());\n    }\n    this._source.onAny(this._$handleAny); // copied from patterns/one-source\n  }\n});\n\nfunction toProperty(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (fn !== null && typeof fn !== 'function') {\n    throw new Error('You should call toProperty() with a function or no arguments.');\n  }\n  return new P$2(obs, { fn: fn });\n}\n\nvar S$6 = createStream('changes', {\n  _handleValue: function (x) {\n    if (!this._activating) {\n      this._emitValue(x);\n    }\n  },\n  _handleError: function (x) {\n    if (!this._activating) {\n      this._emitError(x);\n    }\n  }\n});\n\nfunction changes(obs) {\n  return new S$6(obs);\n}\n\nfunction fromPromise(promise) {\n  var called = false;\n\n  var result = stream(function (emitter) {\n    if (!called) {\n      var onValue = function (x) {\n        emitter.emit(x);\n        emitter.end();\n      };\n      var onError = function (x) {\n        emitter.error(x);\n        emitter.end();\n      };\n      var _promise = promise.then(onValue, onError);\n\n      // prevent libraries like 'Q' or 'when' from swallowing exceptions\n      if (_promise && typeof _promise.done === 'function') {\n        _promise.done();\n      }\n\n      called = true;\n    }\n  });\n\n  return toProperty(result, null).setName('fromPromise');\n}\n\nfunction getGlodalPromise() {\n  if (typeof Promise === 'function') {\n    return Promise;\n  } else {\n    throw new Error(\"There isn't default Promise, use shim or parameter\");\n  }\n}\n\nvar toPromise = function (obs) {\n  var Promise = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getGlodalPromise();\n\n  var last = null;\n  return new Promise(function (resolve, reject) {\n    obs.onAny(function (event) {\n      if (event.type === END && last !== null) {\n        (last.type === VALUE ? resolve : reject)(last.value);\n        last = null;\n      } else {\n        last = event;\n      }\n    });\n  });\n};\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\n\n\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar ponyfill = createCommonjsModule(function (module, exports) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports['default'] = symbolObservablePonyfill;\nfunction symbolObservablePonyfill(root) {\n\tvar result;\n\tvar _Symbol = root.Symbol;\n\n\tif (typeof _Symbol === 'function') {\n\t\tif (_Symbol.observable) {\n\t\t\tresult = _Symbol.observable;\n\t\t} else {\n\t\t\tresult = _Symbol('observable');\n\t\t\t_Symbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n}\n});\n\nvar index$1 = createCommonjsModule(function (module, exports) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n\n\nvar _ponyfill2 = _interopRequireDefault(ponyfill);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : { 'default': obj };\n}\n\nvar root; /* global window */\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof commonjsGlobal !== 'undefined') {\n  root = commonjsGlobal;\n} else {\n  root = module;\n}\n\nvar result = (0, _ponyfill2['default'])(root);\nexports['default'] = result;\n});\n\nvar index = index$1;\n\n// this file contains some hot JS modules systems stuff\n\nvar $$observable = index.default ? index.default : index;\n\nfunction fromESObservable(_observable) {\n  var observable = _observable[$$observable] ? _observable[$$observable]() : _observable;\n  return stream(function (emitter) {\n    var unsub = observable.subscribe({\n      error: function (error) {\n        emitter.error(error);\n        emitter.end();\n      },\n      next: function (value) {\n        emitter.emit(value);\n      },\n      complete: function () {\n        emitter.end();\n      }\n    });\n\n    if (unsub.unsubscribe) {\n      return function () {\n        unsub.unsubscribe();\n      };\n    } else {\n      return unsub;\n    }\n  }).setName('fromESObservable');\n}\n\nfunction ESObservable(observable) {\n  this._observable = observable.takeErrors(1);\n}\n\nextend(ESObservable.prototype, {\n  subscribe: function (observerOrOnNext, onError, onComplete) {\n    var _this = this;\n\n    var observer = typeof observerOrOnNext === 'function' ? { next: observerOrOnNext, error: onError, complete: onComplete } : observerOrOnNext;\n\n    var fn = function (event) {\n      if (event.type === END) {\n        closed = true;\n      }\n\n      if (event.type === VALUE && observer.next) {\n        observer.next(event.value);\n      } else if (event.type === ERROR && observer.error) {\n        observer.error(event.value);\n      } else if (event.type === END && observer.complete) {\n        observer.complete(event.value);\n      }\n    };\n\n    this._observable.onAny(fn);\n    var closed = false;\n\n    var subscription = {\n      unsubscribe: function () {\n        closed = true;\n        _this._observable.offAny(fn);\n      },\n      get closed() {\n        return closed;\n      }\n    };\n    return subscription;\n  }\n});\n\n// Need to assign directly b/c Symbols aren't enumerable.\nESObservable.prototype[$$observable] = function () {\n  return this;\n};\n\nfunction toESObservable() {\n  return new ESObservable(this);\n}\n\nfunction collect(source, keys, values) {\n  for (var prop in source) {\n    if (source.hasOwnProperty(prop)) {\n      keys.push(prop);\n      values.push(source[prop]);\n    }\n  }\n}\n\nfunction defaultErrorsCombinator(errors) {\n  var latestError = void 0;\n  for (var i = 0; i < errors.length; i++) {\n    if (errors[i] !== undefined) {\n      if (latestError === undefined || latestError.index < errors[i].index) {\n        latestError = errors[i];\n      }\n    }\n  }\n  return latestError.error;\n}\n\nfunction Combine(active, passive, combinator) {\n  var _this = this;\n\n  Stream.call(this);\n  this._activeCount = active.length;\n  this._sources = concat(active, passive);\n  this._combinator = combinator;\n  this._aliveCount = 0;\n  this._latestValues = new Array(this._sources.length);\n  this._latestErrors = new Array(this._sources.length);\n  fillArray(this._latestValues, NOTHING);\n  this._emitAfterActivation = false;\n  this._endAfterActivation = false;\n  this._latestErrorIndex = 0;\n\n  this._$handlers = [];\n\n  var _loop = function (i) {\n    _this._$handlers.push(function (event) {\n      return _this._handleAny(i, event);\n    });\n  };\n\n  for (var i = 0; i < this._sources.length; i++) {\n    _loop(i);\n  }\n}\n\ninherit(Combine, Stream, {\n  _name: 'combine',\n\n  _onActivation: function () {\n    this._aliveCount = this._activeCount;\n\n    // we need to suscribe to _passive_ sources before _active_\n    // (see https://github.com/kefirjs/kefir/issues/98)\n    for (var i = this._activeCount; i < this._sources.length; i++) {\n      this._sources[i].onAny(this._$handlers[i]);\n    }\n    for (var _i = 0; _i < this._activeCount; _i++) {\n      this._sources[_i].onAny(this._$handlers[_i]);\n    }\n\n    if (this._emitAfterActivation) {\n      this._emitAfterActivation = false;\n      this._emitIfFull();\n    }\n    if (this._endAfterActivation) {\n      this._emitEnd();\n    }\n  },\n  _onDeactivation: function () {\n    var length = this._sources.length,\n        i = void 0;\n    for (i = 0; i < length; i++) {\n      this._sources[i].offAny(this._$handlers[i]);\n    }\n  },\n  _emitIfFull: function () {\n    var hasAllValues = true;\n    var hasErrors = false;\n    var length = this._latestValues.length;\n    var valuesCopy = new Array(length);\n    var errorsCopy = new Array(length);\n\n    for (var i = 0; i < length; i++) {\n      valuesCopy[i] = this._latestValues[i];\n      errorsCopy[i] = this._latestErrors[i];\n\n      if (valuesCopy[i] === NOTHING) {\n        hasAllValues = false;\n      }\n\n      if (errorsCopy[i] !== undefined) {\n        hasErrors = true;\n      }\n    }\n\n    if (hasAllValues) {\n      var combinator = this._combinator;\n      this._emitValue(combinator(valuesCopy));\n    }\n    if (hasErrors) {\n      this._emitError(defaultErrorsCombinator(errorsCopy));\n    }\n  },\n  _handleAny: function (i, event) {\n    if (event.type === VALUE || event.type === ERROR) {\n      if (event.type === VALUE) {\n        this._latestValues[i] = event.value;\n        this._latestErrors[i] = undefined;\n      }\n      if (event.type === ERROR) {\n        this._latestValues[i] = NOTHING;\n        this._latestErrors[i] = {\n          index: this._latestErrorIndex++,\n          error: event.value\n        };\n      }\n\n      if (i < this._activeCount) {\n        if (this._activating) {\n          this._emitAfterActivation = true;\n        } else {\n          this._emitIfFull();\n        }\n      }\n    } else {\n      // END\n\n      if (i < this._activeCount) {\n        this._aliveCount--;\n        if (this._aliveCount === 0) {\n          if (this._activating) {\n            this._endAfterActivation = true;\n          } else {\n            this._emitEnd();\n          }\n        }\n      }\n    }\n  },\n  _clear: function () {\n    Stream.prototype._clear.call(this);\n    this._sources = null;\n    this._latestValues = null;\n    this._latestErrors = null;\n    this._combinator = null;\n    this._$handlers = null;\n  }\n});\n\nfunction combineAsArray(active) {\n  var passive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var combinator = arguments[2];\n\n  if (!Array.isArray(passive)) {\n    throw new Error('Combine can only combine active and passive collections of the same type.');\n  }\n\n  combinator = combinator ? spread(combinator, active.length + passive.length) : function (x) {\n    return x;\n  };\n  return active.length === 0 ? never() : new Combine(active, passive, combinator);\n}\n\nfunction combineAsObject(active) {\n  var passive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var combinator = arguments[2];\n\n  if (typeof passive !== 'object' || Array.isArray(passive)) {\n    throw new Error('Combine can only combine active and passive collections of the same type.');\n  }\n\n  var keys = [],\n      activeObservables = [],\n      passiveObservables = [];\n\n  collect(active, keys, activeObservables);\n  collect(passive, keys, passiveObservables);\n\n  var objectify = function (values) {\n    var event = {};\n    for (var i = values.length - 1; 0 <= i; i--) {\n      event[keys[i]] = values[i];\n    }\n    return combinator ? combinator(event) : event;\n  };\n\n  return activeObservables.length === 0 ? never() : new Combine(activeObservables, passiveObservables, objectify);\n}\n\nfunction combine(active, passive, combinator) {\n  if (typeof passive === 'function') {\n    combinator = passive;\n    passive = undefined;\n  }\n\n  return Array.isArray(active) ? combineAsArray(active, passive, combinator) : combineAsObject(active, passive, combinator);\n}\n\nvar Observable$2 = {\n  empty: function () {\n    return never();\n  },\n\n\n  // Monoid based on merge() seems more useful than one based on concat().\n  concat: function (a, b) {\n    return a.merge(b);\n  },\n  of: function (x) {\n    return constant(x);\n  },\n  map: function (fn, obs) {\n    return obs.map(fn);\n  },\n  bimap: function (fnErr, fnVal, obs) {\n    return obs.mapErrors(fnErr).map(fnVal);\n  },\n\n\n  // This ap strictly speaking incompatible with chain. If we derive ap from chain we get\n  // different (not very useful) behavior. But spec requires that if method can be derived\n  // it must have the same behavior as hand-written method. We intentionally violate the spec\n  // in hope that it won't cause many troubles in practice. And in return we have more useful type.\n  ap: function (obsFn, obsVal) {\n    return combine([obsFn, obsVal], function (fn, val) {\n      return fn(val);\n    });\n  },\n  chain: function (fn, obs) {\n    return obs.flatMap(fn);\n  }\n};\n\n\n\nvar staticLand = Object.freeze({\n\tObservable: Observable$2\n});\n\nvar mixin = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    this._emitValue(fn(x));\n  }\n};\n\nvar S$7 = createStream('map', mixin);\nvar P$3 = createProperty('map', mixin);\n\nvar id = function (x) {\n  return x;\n};\n\nfunction map$1(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id;\n\n  return new (obs._ofSameType(S$7, P$3))(obs, { fn: fn });\n}\n\nvar mixin$1 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    if (fn(x)) {\n      this._emitValue(x);\n    }\n  }\n};\n\nvar S$8 = createStream('filter', mixin$1);\nvar P$4 = createProperty('filter', mixin$1);\n\nvar id$1 = function (x) {\n  return x;\n};\n\nfunction filter(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id$1;\n\n  return new (obs._ofSameType(S$8, P$4))(obs, { fn: fn });\n}\n\nvar mixin$2 = {\n  _init: function (_ref) {\n    var n = _ref.n;\n\n    this._n = n;\n    if (n <= 0) {\n      this._emitEnd();\n    }\n  },\n  _handleValue: function (x) {\n    if (this._n === 0) {\n      return;\n    }\n    this._n--;\n    this._emitValue(x);\n    if (this._n === 0) {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$9 = createStream('take', mixin$2);\nvar P$5 = createProperty('take', mixin$2);\n\nfunction take(obs, n) {\n  return new (obs._ofSameType(S$9, P$5))(obs, { n: n });\n}\n\nvar mixin$3 = {\n  _init: function (_ref) {\n    var n = _ref.n;\n\n    this._n = n;\n    if (n <= 0) {\n      this._emitEnd();\n    }\n  },\n  _handleError: function (x) {\n    if (this._n === 0) {\n      return;\n    }\n    this._n--;\n    this._emitError(x);\n    if (this._n === 0) {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$10 = createStream('takeErrors', mixin$3);\nvar P$6 = createProperty('takeErrors', mixin$3);\n\nfunction takeErrors(obs, n) {\n  return new (obs._ofSameType(S$10, P$6))(obs, { n: n });\n}\n\nvar mixin$4 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    if (fn(x)) {\n      this._emitValue(x);\n    } else {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$11 = createStream('takeWhile', mixin$4);\nvar P$7 = createProperty('takeWhile', mixin$4);\n\nvar id$2 = function (x) {\n  return x;\n};\n\nfunction takeWhile(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id$2;\n\n  return new (obs._ofSameType(S$11, P$7))(obs, { fn: fn });\n}\n\nvar mixin$5 = {\n  _init: function () {\n    this._lastValue = NOTHING;\n  },\n  _free: function () {\n    this._lastValue = null;\n  },\n  _handleValue: function (x) {\n    this._lastValue = x;\n  },\n  _handleEnd: function () {\n    if (this._lastValue !== NOTHING) {\n      this._emitValue(this._lastValue);\n    }\n    this._emitEnd();\n  }\n};\n\nvar S$12 = createStream('last', mixin$5);\nvar P$8 = createProperty('last', mixin$5);\n\nfunction last(obs) {\n  return new (obs._ofSameType(S$12, P$8))(obs);\n}\n\nvar mixin$6 = {\n  _init: function (_ref) {\n    var n = _ref.n;\n\n    this._n = Math.max(0, n);\n  },\n  _handleValue: function (x) {\n    if (this._n === 0) {\n      this._emitValue(x);\n    } else {\n      this._n--;\n    }\n  }\n};\n\nvar S$13 = createStream('skip', mixin$6);\nvar P$9 = createProperty('skip', mixin$6);\n\nfunction skip(obs, n) {\n  return new (obs._ofSameType(S$13, P$9))(obs, { n: n });\n}\n\nvar mixin$7 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    if (this._fn !== null && !fn(x)) {\n      this._fn = null;\n    }\n    if (this._fn === null) {\n      this._emitValue(x);\n    }\n  }\n};\n\nvar S$14 = createStream('skipWhile', mixin$7);\nvar P$10 = createProperty('skipWhile', mixin$7);\n\nvar id$3 = function (x) {\n  return x;\n};\n\nfunction skipWhile(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id$3;\n\n  return new (obs._ofSameType(S$14, P$10))(obs, { fn: fn });\n}\n\nvar mixin$8 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n    this._prev = NOTHING;\n  },\n  _free: function () {\n    this._fn = null;\n    this._prev = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    if (this._prev === NOTHING || !fn(this._prev, x)) {\n      this._prev = x;\n      this._emitValue(x);\n    }\n  }\n};\n\nvar S$15 = createStream('skipDuplicates', mixin$8);\nvar P$11 = createProperty('skipDuplicates', mixin$8);\n\nvar eq = function (a, b) {\n  return a === b;\n};\n\nfunction skipDuplicates(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : eq;\n\n  return new (obs._ofSameType(S$15, P$11))(obs, { fn: fn });\n}\n\nvar mixin$9 = {\n  _init: function (_ref) {\n    var fn = _ref.fn,\n        seed = _ref.seed;\n\n    this._fn = fn;\n    this._prev = seed;\n  },\n  _free: function () {\n    this._prev = null;\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    if (this._prev !== NOTHING) {\n      var fn = this._fn;\n      this._emitValue(fn(this._prev, x));\n    }\n    this._prev = x;\n  }\n};\n\nvar S$16 = createStream('diff', mixin$9);\nvar P$12 = createProperty('diff', mixin$9);\n\nfunction defaultFn(a, b) {\n  return [a, b];\n}\n\nfunction diff(obs, fn) {\n  var seed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : NOTHING;\n\n  return new (obs._ofSameType(S$16, P$12))(obs, { fn: fn || defaultFn, seed: seed });\n}\n\nvar P$13 = createProperty('scan', {\n  _init: function (_ref) {\n    var fn = _ref.fn,\n        seed = _ref.seed;\n\n    this._fn = fn;\n    this._seed = seed;\n    if (seed !== NOTHING) {\n      this._emitValue(seed);\n    }\n  },\n  _free: function () {\n    this._fn = null;\n    this._seed = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    if (this._currentEvent === null || this._currentEvent.type === ERROR) {\n      this._emitValue(this._seed === NOTHING ? x : fn(this._seed, x));\n    } else {\n      this._emitValue(fn(this._currentEvent.value, x));\n    }\n  }\n});\n\nfunction scan(obs, fn) {\n  var seed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : NOTHING;\n\n  return new P$13(obs, { fn: fn, seed: seed });\n}\n\nvar mixin$10 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    var xs = fn(x);\n    for (var i = 0; i < xs.length; i++) {\n      this._emitValue(xs[i]);\n    }\n  }\n};\n\nvar S$17 = createStream('flatten', mixin$10);\n\nvar id$4 = function (x) {\n  return x;\n};\n\nfunction flatten(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id$4;\n\n  return new S$17(obs, { fn: fn });\n}\n\nvar END_MARKER = {};\n\nvar mixin$11 = {\n  _init: function (_ref) {\n    var _this = this;\n\n    var wait = _ref.wait;\n\n    this._wait = Math.max(0, wait);\n    this._buff = [];\n    this._$shiftBuff = function () {\n      var value = _this._buff.shift();\n      if (value === END_MARKER) {\n        _this._emitEnd();\n      } else {\n        _this._emitValue(value);\n      }\n    };\n  },\n  _free: function () {\n    this._buff = null;\n    this._$shiftBuff = null;\n  },\n  _handleValue: function (x) {\n    if (this._activating) {\n      this._emitValue(x);\n    } else {\n      this._buff.push(x);\n      setTimeout(this._$shiftBuff, this._wait);\n    }\n  },\n  _handleEnd: function () {\n    if (this._activating) {\n      this._emitEnd();\n    } else {\n      this._buff.push(END_MARKER);\n      setTimeout(this._$shiftBuff, this._wait);\n    }\n  }\n};\n\nvar S$18 = createStream('delay', mixin$11);\nvar P$14 = createProperty('delay', mixin$11);\n\nfunction delay(obs, wait) {\n  return new (obs._ofSameType(S$18, P$14))(obs, { wait: wait });\n}\n\nvar now = Date.now ? function () {\n  return Date.now();\n} : function () {\n  return new Date().getTime();\n};\n\nvar mixin$12 = {\n  _init: function (_ref) {\n    var _this = this;\n\n    var wait = _ref.wait,\n        leading = _ref.leading,\n        trailing = _ref.trailing;\n\n    this._wait = Math.max(0, wait);\n    this._leading = leading;\n    this._trailing = trailing;\n    this._trailingValue = null;\n    this._timeoutId = null;\n    this._endLater = false;\n    this._lastCallTime = 0;\n    this._$trailingCall = function () {\n      return _this._trailingCall();\n    };\n  },\n  _free: function () {\n    this._trailingValue = null;\n    this._$trailingCall = null;\n  },\n  _handleValue: function (x) {\n    if (this._activating) {\n      this._emitValue(x);\n    } else {\n      var curTime = now();\n      if (this._lastCallTime === 0 && !this._leading) {\n        this._lastCallTime = curTime;\n      }\n      var remaining = this._wait - (curTime - this._lastCallTime);\n      if (remaining <= 0) {\n        this._cancelTrailing();\n        this._lastCallTime = curTime;\n        this._emitValue(x);\n      } else if (this._trailing) {\n        this._cancelTrailing();\n        this._trailingValue = x;\n        this._timeoutId = setTimeout(this._$trailingCall, remaining);\n      }\n    }\n  },\n  _handleEnd: function () {\n    if (this._activating) {\n      this._emitEnd();\n    } else {\n      if (this._timeoutId) {\n        this._endLater = true;\n      } else {\n        this._emitEnd();\n      }\n    }\n  },\n  _cancelTrailing: function () {\n    if (this._timeoutId !== null) {\n      clearTimeout(this._timeoutId);\n      this._timeoutId = null;\n    }\n  },\n  _trailingCall: function () {\n    this._emitValue(this._trailingValue);\n    this._timeoutId = null;\n    this._trailingValue = null;\n    this._lastCallTime = !this._leading ? 0 : now();\n    if (this._endLater) {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$19 = createStream('throttle', mixin$12);\nvar P$15 = createProperty('throttle', mixin$12);\n\nfunction throttle(obs, wait) {\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$leading = _ref2.leading,\n      leading = _ref2$leading === undefined ? true : _ref2$leading,\n      _ref2$trailing = _ref2.trailing,\n      trailing = _ref2$trailing === undefined ? true : _ref2$trailing;\n\n  return new (obs._ofSameType(S$19, P$15))(obs, { wait: wait, leading: leading, trailing: trailing });\n}\n\nvar mixin$13 = {\n  _init: function (_ref) {\n    var _this = this;\n\n    var wait = _ref.wait,\n        immediate = _ref.immediate;\n\n    this._wait = Math.max(0, wait);\n    this._immediate = immediate;\n    this._lastAttempt = 0;\n    this._timeoutId = null;\n    this._laterValue = null;\n    this._endLater = false;\n    this._$later = function () {\n      return _this._later();\n    };\n  },\n  _free: function () {\n    this._laterValue = null;\n    this._$later = null;\n  },\n  _handleValue: function (x) {\n    if (this._activating) {\n      this._emitValue(x);\n    } else {\n      this._lastAttempt = now();\n      if (this._immediate && !this._timeoutId) {\n        this._emitValue(x);\n      }\n      if (!this._timeoutId) {\n        this._timeoutId = setTimeout(this._$later, this._wait);\n      }\n      if (!this._immediate) {\n        this._laterValue = x;\n      }\n    }\n  },\n  _handleEnd: function () {\n    if (this._activating) {\n      this._emitEnd();\n    } else {\n      if (this._timeoutId && !this._immediate) {\n        this._endLater = true;\n      } else {\n        this._emitEnd();\n      }\n    }\n  },\n  _later: function () {\n    var last = now() - this._lastAttempt;\n    if (last < this._wait && last >= 0) {\n      this._timeoutId = setTimeout(this._$later, this._wait - last);\n    } else {\n      this._timeoutId = null;\n      if (!this._immediate) {\n        this._emitValue(this._laterValue);\n        this._laterValue = null;\n      }\n      if (this._endLater) {\n        this._emitEnd();\n      }\n    }\n  }\n};\n\nvar S$20 = createStream('debounce', mixin$13);\nvar P$16 = createProperty('debounce', mixin$13);\n\nfunction debounce(obs, wait) {\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$immediate = _ref2.immediate,\n      immediate = _ref2$immediate === undefined ? false : _ref2$immediate;\n\n  return new (obs._ofSameType(S$20, P$16))(obs, { wait: wait, immediate: immediate });\n}\n\nvar mixin$14 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleError: function (x) {\n    var fn = this._fn;\n    this._emitError(fn(x));\n  }\n};\n\nvar S$21 = createStream('mapErrors', mixin$14);\nvar P$17 = createProperty('mapErrors', mixin$14);\n\nvar id$5 = function (x) {\n  return x;\n};\n\nfunction mapErrors(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id$5;\n\n  return new (obs._ofSameType(S$21, P$17))(obs, { fn: fn });\n}\n\nvar mixin$15 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleError: function (x) {\n    var fn = this._fn;\n    if (fn(x)) {\n      this._emitError(x);\n    }\n  }\n};\n\nvar S$22 = createStream('filterErrors', mixin$15);\nvar P$18 = createProperty('filterErrors', mixin$15);\n\nvar id$6 = function (x) {\n  return x;\n};\n\nfunction filterErrors(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : id$6;\n\n  return new (obs._ofSameType(S$22, P$18))(obs, { fn: fn });\n}\n\nvar mixin$16 = {\n  _handleValue: function () {}\n};\n\nvar S$23 = createStream('ignoreValues', mixin$16);\nvar P$19 = createProperty('ignoreValues', mixin$16);\n\nfunction ignoreValues(obs) {\n  return new (obs._ofSameType(S$23, P$19))(obs);\n}\n\nvar mixin$17 = {\n  _handleError: function () {}\n};\n\nvar S$24 = createStream('ignoreErrors', mixin$17);\nvar P$20 = createProperty('ignoreErrors', mixin$17);\n\nfunction ignoreErrors(obs) {\n  return new (obs._ofSameType(S$24, P$20))(obs);\n}\n\nvar mixin$18 = {\n  _handleEnd: function () {}\n};\n\nvar S$25 = createStream('ignoreEnd', mixin$18);\nvar P$21 = createProperty('ignoreEnd', mixin$18);\n\nfunction ignoreEnd(obs) {\n  return new (obs._ofSameType(S$25, P$21))(obs);\n}\n\nvar mixin$19 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleEnd: function () {\n    var fn = this._fn;\n    this._emitValue(fn());\n    this._emitEnd();\n  }\n};\n\nvar S$26 = createStream('beforeEnd', mixin$19);\nvar P$22 = createProperty('beforeEnd', mixin$19);\n\nfunction beforeEnd(obs, fn) {\n  return new (obs._ofSameType(S$26, P$22))(obs, { fn: fn });\n}\n\nvar mixin$20 = {\n  _init: function (_ref) {\n    var min = _ref.min,\n        max = _ref.max;\n\n    this._max = max;\n    this._min = min;\n    this._buff = [];\n  },\n  _free: function () {\n    this._buff = null;\n  },\n  _handleValue: function (x) {\n    this._buff = slide(this._buff, x, this._max);\n    if (this._buff.length >= this._min) {\n      this._emitValue(this._buff);\n    }\n  }\n};\n\nvar S$27 = createStream('slidingWindow', mixin$20);\nvar P$23 = createProperty('slidingWindow', mixin$20);\n\nfunction slidingWindow(obs, max) {\n  var min = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n  return new (obs._ofSameType(S$27, P$23))(obs, { min: min, max: max });\n}\n\nvar mixin$21 = {\n  _init: function (_ref) {\n    var fn = _ref.fn,\n        flushOnEnd = _ref.flushOnEnd;\n\n    this._fn = fn;\n    this._flushOnEnd = flushOnEnd;\n    this._buff = [];\n  },\n  _free: function () {\n    this._buff = null;\n  },\n  _flush: function () {\n    if (this._buff !== null && this._buff.length !== 0) {\n      this._emitValue(this._buff);\n      this._buff = [];\n    }\n  },\n  _handleValue: function (x) {\n    this._buff.push(x);\n    var fn = this._fn;\n    if (!fn(x)) {\n      this._flush();\n    }\n  },\n  _handleEnd: function () {\n    if (this._flushOnEnd) {\n      this._flush();\n    }\n    this._emitEnd();\n  }\n};\n\nvar S$28 = createStream('bufferWhile', mixin$21);\nvar P$24 = createProperty('bufferWhile', mixin$21);\n\nvar id$7 = function (x) {\n  return x;\n};\n\nfunction bufferWhile(obs, fn) {\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$flushOnEnd = _ref2.flushOnEnd,\n      flushOnEnd = _ref2$flushOnEnd === undefined ? true : _ref2$flushOnEnd;\n\n  return new (obs._ofSameType(S$28, P$24))(obs, { fn: fn || id$7, flushOnEnd: flushOnEnd });\n}\n\nvar mixin$22 = {\n  _init: function (_ref) {\n    var count = _ref.count,\n        flushOnEnd = _ref.flushOnEnd;\n\n    this._count = count;\n    this._flushOnEnd = flushOnEnd;\n    this._buff = [];\n  },\n  _free: function () {\n    this._buff = null;\n  },\n  _flush: function () {\n    if (this._buff !== null && this._buff.length !== 0) {\n      this._emitValue(this._buff);\n      this._buff = [];\n    }\n  },\n  _handleValue: function (x) {\n    this._buff.push(x);\n    if (this._buff.length >= this._count) {\n      this._flush();\n    }\n  },\n  _handleEnd: function () {\n    if (this._flushOnEnd) {\n      this._flush();\n    }\n    this._emitEnd();\n  }\n};\n\nvar S$29 = createStream('bufferWithCount', mixin$22);\nvar P$25 = createProperty('bufferWithCount', mixin$22);\n\nfunction bufferWhile$1(obs, count) {\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$flushOnEnd = _ref2.flushOnEnd,\n      flushOnEnd = _ref2$flushOnEnd === undefined ? true : _ref2$flushOnEnd;\n\n  return new (obs._ofSameType(S$29, P$25))(obs, { count: count, flushOnEnd: flushOnEnd });\n}\n\nvar mixin$23 = {\n  _init: function (_ref) {\n    var _this = this;\n\n    var wait = _ref.wait,\n        count = _ref.count,\n        flushOnEnd = _ref.flushOnEnd;\n\n    this._wait = wait;\n    this._count = count;\n    this._flushOnEnd = flushOnEnd;\n    this._intervalId = null;\n    this._$onTick = function () {\n      return _this._flush();\n    };\n    this._buff = [];\n  },\n  _free: function () {\n    this._$onTick = null;\n    this._buff = null;\n  },\n  _flush: function () {\n    if (this._buff !== null) {\n      this._emitValue(this._buff);\n      this._buff = [];\n    }\n  },\n  _handleValue: function (x) {\n    this._buff.push(x);\n    if (this._buff.length >= this._count) {\n      clearInterval(this._intervalId);\n      this._flush();\n      this._intervalId = setInterval(this._$onTick, this._wait);\n    }\n  },\n  _handleEnd: function () {\n    if (this._flushOnEnd && this._buff.length !== 0) {\n      this._flush();\n    }\n    this._emitEnd();\n  },\n  _onActivation: function () {\n    this._intervalId = setInterval(this._$onTick, this._wait);\n    this._source.onAny(this._$handleAny); // copied from patterns/one-source\n  },\n  _onDeactivation: function () {\n    if (this._intervalId !== null) {\n      clearInterval(this._intervalId);\n      this._intervalId = null;\n    }\n    this._source.offAny(this._$handleAny); // copied from patterns/one-source\n  }\n};\n\nvar S$30 = createStream('bufferWithTimeOrCount', mixin$23);\nvar P$26 = createProperty('bufferWithTimeOrCount', mixin$23);\n\nfunction bufferWithTimeOrCount(obs, wait, count) {\n  var _ref2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {},\n      _ref2$flushOnEnd = _ref2.flushOnEnd,\n      flushOnEnd = _ref2$flushOnEnd === undefined ? true : _ref2$flushOnEnd;\n\n  return new (obs._ofSameType(S$30, P$26))(obs, { wait: wait, count: count, flushOnEnd: flushOnEnd });\n}\n\nfunction xformForObs(obs) {\n  return {\n    '@@transducer/step': function (res, input) {\n      obs._emitValue(input);\n      return null;\n    },\n    '@@transducer/result': function () {\n      obs._emitEnd();\n      return null;\n    }\n  };\n}\n\nvar mixin$24 = {\n  _init: function (_ref) {\n    var transducer = _ref.transducer;\n\n    this._xform = transducer(xformForObs(this));\n  },\n  _free: function () {\n    this._xform = null;\n  },\n  _handleValue: function (x) {\n    if (this._xform['@@transducer/step'](null, x) !== null) {\n      this._xform['@@transducer/result'](null);\n    }\n  },\n  _handleEnd: function () {\n    this._xform['@@transducer/result'](null);\n  }\n};\n\nvar S$31 = createStream('transduce', mixin$24);\nvar P$27 = createProperty('transduce', mixin$24);\n\nfunction transduce(obs, transducer) {\n  return new (obs._ofSameType(S$31, P$27))(obs, { transducer: transducer });\n}\n\nvar mixin$25 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._handler = fn;\n    this._emitter = emitter(this);\n  },\n  _free: function () {\n    this._handler = null;\n    this._emitter = null;\n  },\n  _handleAny: function (event) {\n    this._handler(this._emitter, event);\n  }\n};\n\nvar S$32 = createStream('withHandler', mixin$25);\nvar P$28 = createProperty('withHandler', mixin$25);\n\nfunction withHandler(obs, fn) {\n  return new (obs._ofSameType(S$32, P$28))(obs, { fn: fn });\n}\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction Zip(sources, combinator) {\n  var _this = this;\n\n  Stream.call(this);\n\n  this._buffers = map(sources, function (source) {\n    return isArray(source) ? cloneArray(source) : [];\n  });\n  this._sources = map(sources, function (source) {\n    return isArray(source) ? never() : source;\n  });\n\n  this._combinator = combinator ? spread(combinator, this._sources.length) : function (x) {\n    return x;\n  };\n  this._aliveCount = 0;\n\n  this._$handlers = [];\n\n  var _loop = function (i) {\n    _this._$handlers.push(function (event) {\n      return _this._handleAny(i, event);\n    });\n  };\n\n  for (var i = 0; i < this._sources.length; i++) {\n    _loop(i);\n  }\n}\n\ninherit(Zip, Stream, {\n  _name: 'zip',\n\n  _onActivation: function () {\n    // if all sources are arrays\n    while (this._isFull()) {\n      this._emit();\n    }\n\n    var length = this._sources.length;\n    this._aliveCount = length;\n    for (var i = 0; i < length && this._active; i++) {\n      this._sources[i].onAny(this._$handlers[i]);\n    }\n  },\n  _onDeactivation: function () {\n    for (var i = 0; i < this._sources.length; i++) {\n      this._sources[i].offAny(this._$handlers[i]);\n    }\n  },\n  _emit: function () {\n    var values = new Array(this._buffers.length);\n    for (var i = 0; i < this._buffers.length; i++) {\n      values[i] = this._buffers[i].shift();\n    }\n    var combinator = this._combinator;\n    this._emitValue(combinator(values));\n  },\n  _isFull: function () {\n    for (var i = 0; i < this._buffers.length; i++) {\n      if (this._buffers[i].length === 0) {\n        return false;\n      }\n    }\n    return true;\n  },\n  _handleAny: function (i, event) {\n    if (event.type === VALUE) {\n      this._buffers[i].push(event.value);\n      if (this._isFull()) {\n        this._emit();\n      }\n    }\n    if (event.type === ERROR) {\n      this._emitError(event.value);\n    }\n    if (event.type === END) {\n      this._aliveCount--;\n      if (this._aliveCount === 0) {\n        this._emitEnd();\n      }\n    }\n  },\n  _clear: function () {\n    Stream.prototype._clear.call(this);\n    this._sources = null;\n    this._buffers = null;\n    this._combinator = null;\n    this._$handlers = null;\n  }\n});\n\nfunction zip(observables, combinator /* Function | falsey */) {\n  return observables.length === 0 ? never() : new Zip(observables, combinator);\n}\n\nvar id$8 = function (x) {\n  return x;\n};\n\nfunction AbstractPool() {\n  var _this = this;\n\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$queueLim = _ref.queueLim,\n      queueLim = _ref$queueLim === undefined ? 0 : _ref$queueLim,\n      _ref$concurLim = _ref.concurLim,\n      concurLim = _ref$concurLim === undefined ? -1 : _ref$concurLim,\n      _ref$drop = _ref.drop,\n      drop = _ref$drop === undefined ? 'new' : _ref$drop;\n\n  Stream.call(this);\n\n  this._queueLim = queueLim < 0 ? -1 : queueLim;\n  this._concurLim = concurLim < 0 ? -1 : concurLim;\n  this._drop = drop;\n  this._queue = [];\n  this._curSources = [];\n  this._$handleSubAny = function (event) {\n    return _this._handleSubAny(event);\n  };\n  this._$endHandlers = [];\n  this._currentlyAdding = null;\n\n  if (this._concurLim === 0) {\n    this._emitEnd();\n  }\n}\n\ninherit(AbstractPool, Stream, {\n  _name: 'abstractPool',\n\n  _add: function (obj, toObs /* Function | falsey */) {\n    toObs = toObs || id$8;\n    if (this._concurLim === -1 || this._curSources.length < this._concurLim) {\n      this._addToCur(toObs(obj));\n    } else {\n      if (this._queueLim === -1 || this._queue.length < this._queueLim) {\n        this._addToQueue(toObs(obj));\n      } else if (this._drop === 'old') {\n        this._removeOldest();\n        this._add(obj, toObs);\n      }\n    }\n  },\n  _addAll: function (obss) {\n    var _this2 = this;\n\n    forEach(obss, function (obs) {\n      return _this2._add(obs);\n    });\n  },\n  _remove: function (obs) {\n    if (this._removeCur(obs) === -1) {\n      this._removeQueue(obs);\n    }\n  },\n  _addToQueue: function (obs) {\n    this._queue = concat(this._queue, [obs]);\n  },\n  _addToCur: function (obs) {\n    if (this._active) {\n      // HACK:\n      //\n      // We have two optimizations for cases when `obs` is ended. We don't want\n      // to add such observable to the list, but only want to emit events\n      // from it (if it has some).\n      //\n      // Instead of this hacks, we could just did following,\n      // but it would be 5-8 times slower:\n      //\n      //     this._curSources = concat(this._curSources, [obs]);\n      //     this._subscribe(obs);\n      //\n\n      // #1\n      // This one for cases when `obs` already ended\n      // e.g., Kefir.constant() or Kefir.never()\n      if (!obs._alive) {\n        if (obs._currentEvent) {\n          this._emit(obs._currentEvent.type, obs._currentEvent.value);\n        }\n        // The _emit above could have caused this stream to end.\n        if (this._active) {\n          if (this._queue.length !== 0) {\n            this._pullQueue();\n          } else if (this._curSources.length === 0) {\n            this._onEmpty();\n          }\n        }\n        return;\n      }\n\n      // #2\n      // This one is for cases when `obs` going to end synchronously on\n      // first subscriber e.g., Kefir.stream(em => {em.emit(1); em.end()})\n      this._currentlyAdding = obs;\n      obs.onAny(this._$handleSubAny);\n      this._currentlyAdding = null;\n      if (obs._alive) {\n        this._curSources = concat(this._curSources, [obs]);\n        if (this._active) {\n          this._subToEnd(obs);\n        }\n      }\n    } else {\n      this._curSources = concat(this._curSources, [obs]);\n    }\n  },\n  _subToEnd: function (obs) {\n    var _this3 = this;\n\n    var onEnd = function () {\n      return _this3._removeCur(obs);\n    };\n    this._$endHandlers.push({ obs: obs, handler: onEnd });\n    obs.onEnd(onEnd);\n  },\n  _subscribe: function (obs) {\n    obs.onAny(this._$handleSubAny);\n\n    // it can become inactive in responce of subscribing to `obs.onAny` above\n    if (this._active) {\n      this._subToEnd(obs);\n    }\n  },\n  _unsubscribe: function (obs) {\n    obs.offAny(this._$handleSubAny);\n\n    var onEndI = findByPred(this._$endHandlers, function (obj) {\n      return obj.obs === obs;\n    });\n    if (onEndI !== -1) {\n      obs.offEnd(this._$endHandlers[onEndI].handler);\n      this._$endHandlers.splice(onEndI, 1);\n    }\n  },\n  _handleSubAny: function (event) {\n    if (event.type === VALUE) {\n      this._emitValue(event.value);\n    } else if (event.type === ERROR) {\n      this._emitError(event.value);\n    }\n  },\n  _removeQueue: function (obs) {\n    var index = find(this._queue, obs);\n    this._queue = remove(this._queue, index);\n    return index;\n  },\n  _removeCur: function (obs) {\n    if (this._active) {\n      this._unsubscribe(obs);\n    }\n    var index = find(this._curSources, obs);\n    this._curSources = remove(this._curSources, index);\n    if (index !== -1) {\n      if (this._queue.length !== 0) {\n        this._pullQueue();\n      } else if (this._curSources.length === 0) {\n        this._onEmpty();\n      }\n    }\n    return index;\n  },\n  _removeOldest: function () {\n    this._removeCur(this._curSources[0]);\n  },\n  _pullQueue: function () {\n    if (this._queue.length !== 0) {\n      this._queue = cloneArray(this._queue);\n      this._addToCur(this._queue.shift());\n    }\n  },\n  _onActivation: function () {\n    for (var i = 0, sources = this._curSources; i < sources.length && this._active; i++) {\n      this._subscribe(sources[i]);\n    }\n  },\n  _onDeactivation: function () {\n    for (var i = 0, sources = this._curSources; i < sources.length; i++) {\n      this._unsubscribe(sources[i]);\n    }\n    if (this._currentlyAdding !== null) {\n      this._unsubscribe(this._currentlyAdding);\n    }\n  },\n  _isEmpty: function () {\n    return this._curSources.length === 0;\n  },\n  _onEmpty: function () {},\n  _clear: function () {\n    Stream.prototype._clear.call(this);\n    this._queue = null;\n    this._curSources = null;\n    this._$handleSubAny = null;\n    this._$endHandlers = null;\n  }\n});\n\nfunction Merge(sources) {\n  AbstractPool.call(this);\n  this._addAll(sources);\n  this._initialised = true;\n}\n\ninherit(Merge, AbstractPool, {\n  _name: 'merge',\n\n  _onEmpty: function () {\n    if (this._initialised) {\n      this._emitEnd();\n    }\n  }\n});\n\nfunction merge(observables) {\n  return observables.length === 0 ? never() : new Merge(observables);\n}\n\nfunction S$33(generator) {\n  var _this = this;\n\n  Stream.call(this);\n  this._generator = generator;\n  this._source = null;\n  this._inLoop = false;\n  this._iteration = 0;\n  this._$handleAny = function (event) {\n    return _this._handleAny(event);\n  };\n}\n\ninherit(S$33, Stream, {\n  _name: 'repeat',\n\n  _handleAny: function (event) {\n    if (event.type === END) {\n      this._source = null;\n      this._getSource();\n    } else {\n      this._emit(event.type, event.value);\n    }\n  },\n  _getSource: function () {\n    if (!this._inLoop) {\n      this._inLoop = true;\n      var generator = this._generator;\n      while (this._source === null && this._alive && this._active) {\n        this._source = generator(this._iteration++);\n        if (this._source) {\n          this._source.onAny(this._$handleAny);\n        } else {\n          this._emitEnd();\n        }\n      }\n      this._inLoop = false;\n    }\n  },\n  _onActivation: function () {\n    if (this._source) {\n      this._source.onAny(this._$handleAny);\n    } else {\n      this._getSource();\n    }\n  },\n  _onDeactivation: function () {\n    if (this._source) {\n      this._source.offAny(this._$handleAny);\n    }\n  },\n  _clear: function () {\n    Stream.prototype._clear.call(this);\n    this._generator = null;\n    this._source = null;\n    this._$handleAny = null;\n  }\n});\n\nvar repeat = function (generator) {\n  return new S$33(generator);\n};\n\nfunction concat$1(observables) {\n  return repeat(function (index) {\n    return observables.length > index ? observables[index] : false;\n  }).setName('concat');\n}\n\nfunction Pool() {\n  AbstractPool.call(this);\n}\n\ninherit(Pool, AbstractPool, {\n  _name: 'pool',\n\n  plug: function (obs) {\n    this._add(obs);\n    return this;\n  },\n  unplug: function (obs) {\n    this._remove(obs);\n    return this;\n  }\n});\n\nfunction FlatMap(source, fn, options) {\n  var _this = this;\n\n  AbstractPool.call(this, options);\n  this._source = source;\n  this._fn = fn;\n  this._mainEnded = false;\n  this._lastCurrent = null;\n  this._$handleMain = function (event) {\n    return _this._handleMain(event);\n  };\n}\n\ninherit(FlatMap, AbstractPool, {\n  _onActivation: function () {\n    AbstractPool.prototype._onActivation.call(this);\n    if (this._active) {\n      this._source.onAny(this._$handleMain);\n    }\n  },\n  _onDeactivation: function () {\n    AbstractPool.prototype._onDeactivation.call(this);\n    this._source.offAny(this._$handleMain);\n    this._hadNoEvSinceDeact = true;\n  },\n  _handleMain: function (event) {\n    if (event.type === VALUE) {\n      // Is latest value before deactivation survived, and now is 'current' on this activation?\n      // We don't want to handle such values, to prevent to constantly add\n      // same observale on each activation/deactivation when our main source\n      // is a `Kefir.conatant()` for example.\n      var sameCurr = this._activating && this._hadNoEvSinceDeact && this._lastCurrent === event.value;\n      if (!sameCurr) {\n        this._add(event.value, this._fn);\n      }\n      this._lastCurrent = event.value;\n      this._hadNoEvSinceDeact = false;\n    }\n\n    if (event.type === ERROR) {\n      this._emitError(event.value);\n    }\n\n    if (event.type === END) {\n      if (this._isEmpty()) {\n        this._emitEnd();\n      } else {\n        this._mainEnded = true;\n      }\n    }\n  },\n  _onEmpty: function () {\n    if (this._mainEnded) {\n      this._emitEnd();\n    }\n  },\n  _clear: function () {\n    AbstractPool.prototype._clear.call(this);\n    this._source = null;\n    this._lastCurrent = null;\n    this._$handleMain = null;\n  }\n});\n\nfunction FlatMapErrors(source, fn) {\n  FlatMap.call(this, source, fn);\n}\n\ninherit(FlatMapErrors, FlatMap, {\n  // Same as in FlatMap, only VALUE/ERROR flipped\n  _handleMain: function (event) {\n    if (event.type === ERROR) {\n      var sameCurr = this._activating && this._hadNoEvSinceDeact && this._lastCurrent === event.value;\n      if (!sameCurr) {\n        this._add(event.value, this._fn);\n      }\n      this._lastCurrent = event.value;\n      this._hadNoEvSinceDeact = false;\n    }\n\n    if (event.type === VALUE) {\n      this._emitValue(event.value);\n    }\n\n    if (event.type === END) {\n      if (this._isEmpty()) {\n        this._emitEnd();\n      } else {\n        this._mainEnded = true;\n      }\n    }\n  }\n});\n\nfunction createConstructor$1(BaseClass, name) {\n  return function AnonymousObservable(primary, secondary, options) {\n    var _this = this;\n\n    BaseClass.call(this);\n    this._primary = primary;\n    this._secondary = secondary;\n    this._name = primary._name + '.' + name;\n    this._lastSecondary = NOTHING;\n    this._$handleSecondaryAny = function (event) {\n      return _this._handleSecondaryAny(event);\n    };\n    this._$handlePrimaryAny = function (event) {\n      return _this._handlePrimaryAny(event);\n    };\n    this._init(options);\n  };\n}\n\nfunction createClassMethods$1(BaseClass) {\n  return {\n    _init: function () {},\n    _free: function () {},\n    _handlePrimaryValue: function (x) {\n      this._emitValue(x);\n    },\n    _handlePrimaryError: function (x) {\n      this._emitError(x);\n    },\n    _handlePrimaryEnd: function () {\n      this._emitEnd();\n    },\n    _handleSecondaryValue: function (x) {\n      this._lastSecondary = x;\n    },\n    _handleSecondaryError: function (x) {\n      this._emitError(x);\n    },\n    _handleSecondaryEnd: function () {},\n    _handlePrimaryAny: function (event) {\n      switch (event.type) {\n        case VALUE:\n          return this._handlePrimaryValue(event.value);\n        case ERROR:\n          return this._handlePrimaryError(event.value);\n        case END:\n          return this._handlePrimaryEnd(event.value);\n      }\n    },\n    _handleSecondaryAny: function (event) {\n      switch (event.type) {\n        case VALUE:\n          return this._handleSecondaryValue(event.value);\n        case ERROR:\n          return this._handleSecondaryError(event.value);\n        case END:\n          this._handleSecondaryEnd(event.value);\n          this._removeSecondary();\n      }\n    },\n    _removeSecondary: function () {\n      if (this._secondary !== null) {\n        this._secondary.offAny(this._$handleSecondaryAny);\n        this._$handleSecondaryAny = null;\n        this._secondary = null;\n      }\n    },\n    _onActivation: function () {\n      if (this._secondary !== null) {\n        this._secondary.onAny(this._$handleSecondaryAny);\n      }\n      if (this._active) {\n        this._primary.onAny(this._$handlePrimaryAny);\n      }\n    },\n    _onDeactivation: function () {\n      if (this._secondary !== null) {\n        this._secondary.offAny(this._$handleSecondaryAny);\n      }\n      this._primary.offAny(this._$handlePrimaryAny);\n    },\n    _clear: function () {\n      BaseClass.prototype._clear.call(this);\n      this._primary = null;\n      this._secondary = null;\n      this._lastSecondary = null;\n      this._$handleSecondaryAny = null;\n      this._$handlePrimaryAny = null;\n      this._free();\n    }\n  };\n}\n\nfunction createStream$1(name, mixin) {\n  var S = createConstructor$1(Stream, name);\n  inherit(S, Stream, createClassMethods$1(Stream), mixin);\n  return S;\n}\n\nfunction createProperty$1(name, mixin) {\n  var P = createConstructor$1(Property, name);\n  inherit(P, Property, createClassMethods$1(Property), mixin);\n  return P;\n}\n\nvar mixin$26 = {\n  _handlePrimaryValue: function (x) {\n    if (this._lastSecondary !== NOTHING && this._lastSecondary) {\n      this._emitValue(x);\n    }\n  },\n  _handleSecondaryEnd: function () {\n    if (this._lastSecondary === NOTHING || !this._lastSecondary) {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$34 = createStream$1('filterBy', mixin$26);\nvar P$29 = createProperty$1('filterBy', mixin$26);\n\nfunction filterBy(primary, secondary) {\n  return new (primary._ofSameType(S$34, P$29))(primary, secondary);\n}\n\nvar id2 = function (_, x) {\n  return x;\n};\n\nfunction sampledBy(passive, active, combinator) {\n  var _combinator = combinator ? function (a, b) {\n    return combinator(b, a);\n  } : id2;\n  return combine([active], [passive], _combinator).setName(passive, 'sampledBy');\n}\n\nvar mixin$27 = {\n  _handlePrimaryValue: function (x) {\n    if (this._lastSecondary !== NOTHING) {\n      this._emitValue(x);\n    }\n  },\n  _handleSecondaryEnd: function () {\n    if (this._lastSecondary === NOTHING) {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$35 = createStream$1('skipUntilBy', mixin$27);\nvar P$30 = createProperty$1('skipUntilBy', mixin$27);\n\nfunction skipUntilBy(primary, secondary) {\n  return new (primary._ofSameType(S$35, P$30))(primary, secondary);\n}\n\nvar mixin$28 = {\n  _handleSecondaryValue: function () {\n    this._emitEnd();\n  }\n};\n\nvar S$36 = createStream$1('takeUntilBy', mixin$28);\nvar P$31 = createProperty$1('takeUntilBy', mixin$28);\n\nfunction takeUntilBy(primary, secondary) {\n  return new (primary._ofSameType(S$36, P$31))(primary, secondary);\n}\n\nvar mixin$29 = {\n  _init: function () {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$flushOnEnd = _ref.flushOnEnd,\n        flushOnEnd = _ref$flushOnEnd === undefined ? true : _ref$flushOnEnd;\n\n    this._buff = [];\n    this._flushOnEnd = flushOnEnd;\n  },\n  _free: function () {\n    this._buff = null;\n  },\n  _flush: function () {\n    if (this._buff !== null) {\n      this._emitValue(this._buff);\n      this._buff = [];\n    }\n  },\n  _handlePrimaryEnd: function () {\n    if (this._flushOnEnd) {\n      this._flush();\n    }\n    this._emitEnd();\n  },\n  _onActivation: function () {\n    this._primary.onAny(this._$handlePrimaryAny);\n    if (this._alive && this._secondary !== null) {\n      this._secondary.onAny(this._$handleSecondaryAny);\n    }\n  },\n  _handlePrimaryValue: function (x) {\n    this._buff.push(x);\n  },\n  _handleSecondaryValue: function () {\n    this._flush();\n  },\n  _handleSecondaryEnd: function () {\n    if (!this._flushOnEnd) {\n      this._emitEnd();\n    }\n  }\n};\n\nvar S$37 = createStream$1('bufferBy', mixin$29);\nvar P$32 = createProperty$1('bufferBy', mixin$29);\n\nfunction bufferBy(primary, secondary, options /* optional */) {\n  return new (primary._ofSameType(S$37, P$32))(primary, secondary, options);\n}\n\nvar mixin$30 = {\n  _init: function () {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$flushOnEnd = _ref.flushOnEnd,\n        flushOnEnd = _ref$flushOnEnd === undefined ? true : _ref$flushOnEnd,\n        _ref$flushOnChange = _ref.flushOnChange,\n        flushOnChange = _ref$flushOnChange === undefined ? false : _ref$flushOnChange;\n\n    this._buff = [];\n    this._flushOnEnd = flushOnEnd;\n    this._flushOnChange = flushOnChange;\n  },\n  _free: function () {\n    this._buff = null;\n  },\n  _flush: function () {\n    if (this._buff !== null) {\n      this._emitValue(this._buff);\n      this._buff = [];\n    }\n  },\n  _handlePrimaryEnd: function () {\n    if (this._flushOnEnd) {\n      this._flush();\n    }\n    this._emitEnd();\n  },\n  _handlePrimaryValue: function (x) {\n    this._buff.push(x);\n    if (this._lastSecondary !== NOTHING && !this._lastSecondary) {\n      this._flush();\n    }\n  },\n  _handleSecondaryEnd: function () {\n    if (!this._flushOnEnd && (this._lastSecondary === NOTHING || this._lastSecondary)) {\n      this._emitEnd();\n    }\n  },\n  _handleSecondaryValue: function (x) {\n    if (this._flushOnChange && !x) {\n      this._flush();\n    }\n\n    // from default _handleSecondaryValue\n    this._lastSecondary = x;\n  }\n};\n\nvar S$38 = createStream$1('bufferWhileBy', mixin$30);\nvar P$33 = createProperty$1('bufferWhileBy', mixin$30);\n\nfunction bufferWhileBy(primary, secondary, options /* optional */) {\n  return new (primary._ofSameType(S$38, P$33))(primary, secondary, options);\n}\n\nvar f = function () {\n  return false;\n};\nvar t = function () {\n  return true;\n};\n\nfunction awaiting(a, b) {\n  var result = merge([map$1(a, t), map$1(b, f)]);\n  result = skipDuplicates(result);\n  result = toProperty(result, f);\n  return result.setName(a, 'awaiting');\n}\n\nvar mixin$31 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleValue: function (x) {\n    var fn = this._fn;\n    var result = fn(x);\n    if (result.convert) {\n      this._emitError(result.error);\n    } else {\n      this._emitValue(x);\n    }\n  }\n};\n\nvar S$39 = createStream('valuesToErrors', mixin$31);\nvar P$34 = createProperty('valuesToErrors', mixin$31);\n\nvar defFn = function (x) {\n  return { convert: true, error: x };\n};\n\nfunction valuesToErrors(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defFn;\n\n  return new (obs._ofSameType(S$39, P$34))(obs, { fn: fn });\n}\n\nvar mixin$32 = {\n  _init: function (_ref) {\n    var fn = _ref.fn;\n\n    this._fn = fn;\n  },\n  _free: function () {\n    this._fn = null;\n  },\n  _handleError: function (x) {\n    var fn = this._fn;\n    var result = fn(x);\n    if (result.convert) {\n      this._emitValue(result.value);\n    } else {\n      this._emitError(x);\n    }\n  }\n};\n\nvar S$40 = createStream('errorsToValues', mixin$32);\nvar P$35 = createProperty('errorsToValues', mixin$32);\n\nvar defFn$1 = function (x) {\n  return { convert: true, value: x };\n};\n\nfunction errorsToValues(obs) {\n  var fn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defFn$1;\n\n  return new (obs._ofSameType(S$40, P$35))(obs, { fn: fn });\n}\n\nvar mixin$33 = {\n  _handleError: function (x) {\n    this._emitError(x);\n    this._emitEnd();\n  }\n};\n\nvar S$41 = createStream('endOnError', mixin$33);\nvar P$36 = createProperty('endOnError', mixin$33);\n\nfunction endOnError(obs) {\n  return new (obs._ofSameType(S$41, P$36))(obs);\n}\n\n// Create a stream\n// -----------------------------------------------------------------------------\n\n// () -> Stream\n// (number, any) -> Stream\n// (number, any) -> Stream\n// (number, Array<any>) -> Stream\n// (number, Function) -> Stream\n// (number, Function) -> Stream\n// (Function) -> Stream\n// (Function) -> Stream\n// Target = {addEventListener, removeEventListener}|{addListener, removeListener}|{on, off}\n// (Target, string, Function|undefined) -> Stream\n// (Function) -> Stream\n// Create a property\n// -----------------------------------------------------------------------------\n\n// (any) -> Property\n// (any) -> Property\n// Convert observables\n// -----------------------------------------------------------------------------\n\n// (Stream|Property, Function|undefined) -> Property\nObservable.prototype.toProperty = function (fn) {\n  return toProperty(this, fn);\n};\n\n// (Stream|Property) -> Stream\nObservable.prototype.changes = function () {\n  return changes(this);\n};\n\n// Interoperation with other implimentations\n// -----------------------------------------------------------------------------\n\n// (Promise) -> Property\n// (Stream|Property, Function|undefined) -> Promise\nObservable.prototype.toPromise = function (Promise) {\n  return toPromise(this, Promise);\n};\n\n// (ESObservable) -> Stream\n// (Stream|Property) -> ES7 Observable\nObservable.prototype.toESObservable = toESObservable;\nObservable.prototype[$$observable] = toESObservable;\n\n// Modify an observable\n// -----------------------------------------------------------------------------\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.map = function (fn) {\n  return map$1(this, fn);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.filter = function (fn) {\n  return filter(this, fn);\n};\n\n// (Stream, number) -> Stream\n// (Property, number) -> Property\nObservable.prototype.take = function (n) {\n  return take(this, n);\n};\n\n// (Stream, number) -> Stream\n// (Property, number) -> Property\nObservable.prototype.takeErrors = function (n) {\n  return takeErrors(this, n);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.takeWhile = function (fn) {\n  return takeWhile(this, fn);\n};\n\n// (Stream) -> Stream\n// (Property) -> Property\nObservable.prototype.last = function () {\n  return last(this);\n};\n\n// (Stream, number) -> Stream\n// (Property, number) -> Property\nObservable.prototype.skip = function (n) {\n  return skip(this, n);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.skipWhile = function (fn) {\n  return skipWhile(this, fn);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.skipDuplicates = function (fn) {\n  return skipDuplicates(this, fn);\n};\n\n// (Stream, Function|falsey, any|undefined) -> Stream\n// (Property, Function|falsey, any|undefined) -> Property\nObservable.prototype.diff = function (fn, seed) {\n  return diff(this, fn, seed);\n};\n\n// (Stream|Property, Function, any|undefined) -> Property\nObservable.prototype.scan = function (fn, seed) {\n  return scan(this, fn, seed);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.flatten = function (fn) {\n  return flatten(this, fn);\n};\n\n// (Stream, number) -> Stream\n// (Property, number) -> Property\nObservable.prototype.delay = function (wait) {\n  return delay(this, wait);\n};\n\n// Options = {leading: boolean|undefined, trailing: boolean|undefined}\n// (Stream, number, Options|undefined) -> Stream\n// (Property, number, Options|undefined) -> Property\nObservable.prototype.throttle = function (wait, options) {\n  return throttle(this, wait, options);\n};\n\n// Options = {immediate: boolean|undefined}\n// (Stream, number, Options|undefined) -> Stream\n// (Property, number, Options|undefined) -> Property\nObservable.prototype.debounce = function (wait, options) {\n  return debounce(this, wait, options);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.mapErrors = function (fn) {\n  return mapErrors(this, fn);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.filterErrors = function (fn) {\n  return filterErrors(this, fn);\n};\n\n// (Stream) -> Stream\n// (Property) -> Property\nObservable.prototype.ignoreValues = function () {\n  return ignoreValues(this);\n};\n\n// (Stream) -> Stream\n// (Property) -> Property\nObservable.prototype.ignoreErrors = function () {\n  return ignoreErrors(this);\n};\n\n// (Stream) -> Stream\n// (Property) -> Property\nObservable.prototype.ignoreEnd = function () {\n  return ignoreEnd(this);\n};\n\n// (Stream, Function) -> Stream\n// (Property, Function) -> Property\nObservable.prototype.beforeEnd = function (fn) {\n  return beforeEnd(this, fn);\n};\n\n// (Stream, number, number|undefined) -> Stream\n// (Property, number, number|undefined) -> Property\nObservable.prototype.slidingWindow = function (max, min) {\n  return slidingWindow(this, max, min);\n};\n\n// Options = {flushOnEnd: boolean|undefined}\n// (Stream, Function|falsey, Options|undefined) -> Stream\n// (Property, Function|falsey, Options|undefined) -> Property\nObservable.prototype.bufferWhile = function (fn, options) {\n  return bufferWhile(this, fn, options);\n};\n\n// (Stream, number) -> Stream\n// (Property, number) -> Property\nObservable.prototype.bufferWithCount = function (count, options) {\n  return bufferWhile$1(this, count, options);\n};\n\n// Options = {flushOnEnd: boolean|undefined}\n// (Stream, number, number, Options|undefined) -> Stream\n// (Property, number, number, Options|undefined) -> Property\nObservable.prototype.bufferWithTimeOrCount = function (wait, count, options) {\n  return bufferWithTimeOrCount(this, wait, count, options);\n};\n\n// (Stream, Function) -> Stream\n// (Property, Function) -> Property\nObservable.prototype.transduce = function (transducer) {\n  return transduce(this, transducer);\n};\n\n// (Stream, Function) -> Stream\n// (Property, Function) -> Property\nObservable.prototype.withHandler = function (fn) {\n  return withHandler(this, fn);\n};\n\n// (Stream, Stream -> a) -> a\n// (Property, Property -> a) -> a\nObservable.prototype.thru = function (fn) {\n  return fn(this);\n};\n\n// Combine observables\n// -----------------------------------------------------------------------------\n\n// (Array<Stream|Property>, Function|undefiend) -> Stream\n// (Array<Stream|Property>, Array<Stream|Property>, Function|undefiend) -> Stream\nObservable.prototype.combine = function (other, combinator) {\n  return combine([this, other], combinator);\n};\n\n// (Array<Stream|Property>, Function|undefiend) -> Stream\nObservable.prototype.zip = function (other, combinator) {\n  return zip([this, other], combinator);\n};\n\n// (Array<Stream|Property>) -> Stream\nObservable.prototype.merge = function (other) {\n  return merge([this, other]);\n};\n\n// (Array<Stream|Property>) -> Stream\nObservable.prototype.concat = function (other) {\n  return concat$1([this, other]);\n};\n\n// () -> Pool\nvar pool = function () {\n  return new Pool();\n};\n\n// (Function) -> Stream\n// Options = {concurLim: number|undefined, queueLim: number|undefined, drop: 'old'|'new'|undefiend}\n// (Stream|Property, Function|falsey, Options|undefined) -> Stream\nObservable.prototype.flatMap = function (fn) {\n  return new FlatMap(this, fn).setName(this, 'flatMap');\n};\nObservable.prototype.flatMapLatest = function (fn) {\n  return new FlatMap(this, fn, { concurLim: 1, drop: 'old' }).setName(this, 'flatMapLatest');\n};\nObservable.prototype.flatMapFirst = function (fn) {\n  return new FlatMap(this, fn, { concurLim: 1 }).setName(this, 'flatMapFirst');\n};\nObservable.prototype.flatMapConcat = function (fn) {\n  return new FlatMap(this, fn, { queueLim: -1, concurLim: 1 }).setName(this, 'flatMapConcat');\n};\nObservable.prototype.flatMapConcurLimit = function (fn, limit) {\n  return new FlatMap(this, fn, { queueLim: -1, concurLim: limit }).setName(this, 'flatMapConcurLimit');\n};\n\n// (Stream|Property, Function|falsey) -> Stream\nObservable.prototype.flatMapErrors = function (fn) {\n  return new FlatMapErrors(this, fn).setName(this, 'flatMapErrors');\n};\n\n// Combine two observables\n// -----------------------------------------------------------------------------\n\n// (Stream, Stream|Property) -> Stream\n// (Property, Stream|Property) -> Property\nObservable.prototype.filterBy = function (other) {\n  return filterBy(this, other);\n};\n\n// (Stream, Stream|Property, Function|undefiend) -> Stream\n// (Property, Stream|Property, Function|undefiend) -> Property\nObservable.prototype.sampledBy = function (other, combinator) {\n  return sampledBy(this, other, combinator);\n};\n\n// (Stream, Stream|Property) -> Stream\n// (Property, Stream|Property) -> Property\nObservable.prototype.skipUntilBy = function (other) {\n  return skipUntilBy(this, other);\n};\n\n// (Stream, Stream|Property) -> Stream\n// (Property, Stream|Property) -> Property\nObservable.prototype.takeUntilBy = function (other) {\n  return takeUntilBy(this, other);\n};\n\n// Options = {flushOnEnd: boolean|undefined}\n// (Stream, Stream|Property, Options|undefined) -> Stream\n// (Property, Stream|Property, Options|undefined) -> Property\nObservable.prototype.bufferBy = function (other, options) {\n  return bufferBy(this, other, options);\n};\n\n// Options = {flushOnEnd: boolean|undefined}\n// (Stream, Stream|Property, Options|undefined) -> Stream\n// (Property, Stream|Property, Options|undefined) -> Property\nObservable.prototype.bufferWhileBy = function (other, options) {\n  return bufferWhileBy(this, other, options);\n};\n\n// Deprecated\n// -----------------------------------------------------------------------------\n\nvar DEPRECATION_WARNINGS = true;\nfunction dissableDeprecationWarnings() {\n  DEPRECATION_WARNINGS = false;\n}\n\nfunction warn(msg) {\n  if (DEPRECATION_WARNINGS && console && typeof console.warn === 'function') {\n    var msg2 = '\\nHere is an Error object for you containing the call stack:';\n    console.warn(msg, msg2, new Error());\n  }\n}\n\n// (Stream|Property, Stream|Property) -> Property\nObservable.prototype.awaiting = function (other) {\n  warn('You are using deprecated .awaiting() method, see https://github.com/kefirjs/kefir/issues/145');\n  return awaiting(this, other);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.valuesToErrors = function (fn) {\n  warn('You are using deprecated .valuesToErrors() method, see https://github.com/kefirjs/kefir/issues/149');\n  return valuesToErrors(this, fn);\n};\n\n// (Stream, Function|undefined) -> Stream\n// (Property, Function|undefined) -> Property\nObservable.prototype.errorsToValues = function (fn) {\n  warn('You are using deprecated .errorsToValues() method, see https://github.com/kefirjs/kefir/issues/149');\n  return errorsToValues(this, fn);\n};\n\n// (Stream) -> Stream\n// (Property) -> Property\nObservable.prototype.endOnError = function () {\n  warn('You are using deprecated .endOnError() method, see https://github.com/kefirjs/kefir/issues/150');\n  return endOnError(this);\n};\n\n// Exports\n// --------------------------------------------------------------------------\n\nvar Kefir = {\n  Observable: Observable,\n  Stream: Stream,\n  Property: Property,\n  never: never,\n  later: later,\n  interval: interval,\n  sequentially: sequentially,\n  fromPoll: fromPoll,\n  withInterval: withInterval,\n  fromCallback: fromCallback,\n  fromNodeCallback: fromNodeCallback,\n  fromEvents: fromEvents,\n  stream: stream,\n  constant: constant,\n  constantError: constantError,\n  fromPromise: fromPromise,\n  fromESObservable: fromESObservable,\n  combine: combine,\n  zip: zip,\n  merge: merge,\n  concat: concat$1,\n  Pool: Pool,\n  pool: pool,\n  repeat: repeat,\n  staticLand: staticLand\n};\n\nKefir.Kefir = Kefir;\n\nexports.dissableDeprecationWarnings = dissableDeprecationWarnings;\nexports.Kefir = Kefir;\nexports.Observable = Observable;\nexports.Stream = Stream;\nexports.Property = Property;\nexports.never = never;\nexports.later = later;\nexports.interval = interval;\nexports.sequentially = sequentially;\nexports.fromPoll = fromPoll;\nexports.withInterval = withInterval;\nexports.fromCallback = fromCallback;\nexports.fromNodeCallback = fromNodeCallback;\nexports.fromEvents = fromEvents;\nexports.stream = stream;\nexports.constant = constant;\nexports.constantError = constantError;\nexports.fromPromise = fromPromise;\nexports.fromESObservable = fromESObservable;\nexports.combine = combine;\nexports.zip = zip;\nexports.merge = merge;\nexports.concat = concat$1;\nexports.Pool = Pool;\nexports.pool = pool;\nexports.repeat = repeat;\nexports.staticLand = staticLand;\nexports['default'] = Kefir;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","\"use strict\";\nvar Kefir = require(\"kefir\");\nvar canSymbol = require(\"can-symbol\");\nvar canReflect = require(\"can-reflect\");\nvar mapEventsMixin = require(\"can-event-queue/map/map\");\nvar ObservationRecorder = require(\"can-observation-recorder\");\n\nvar metaSymbol = canSymbol.for(\"can.meta\");\nvar onKeyValueSymbol = canSymbol.for(\"can.onKeyValue\");\nvar offKeyValueSymbol = canSymbol.for(\"can.offKeyValue\");\n\nvar keyNames = {\n\tvalue: {\n\t\ton: \"onValue\",\n\t\toff: \"offValue\",\n\t\thandler: \"onValueHandler\",\n\t\thandlers: \"onValueHandlers\"\n\t},\n\terror: {\n\t\ton: \"onError\",\n\t\toff: \"offError\",\n\t\thandler: \"onErrorHandler\",\n\t\thandlers: \"onErrorHandlers\"\n\t}\n};\n\nfunction ensureMeta(obj) {\n\tvar meta = obj[metaSymbol];\n\n\tif (!meta) {\n\t\tmeta = {};\n\t\tcanReflect.setKeyValue(obj, metaSymbol, meta);\n\t}\n\n\treturn meta;\n}\n\n// get the current value from a stream\nfunction getCurrentValue(stream, key) {\n\tif (stream._currentEvent && stream._currentEvent.type === key) {\n\t\treturn stream._currentEvent.value;\n\t} else {\n\t\tvar names = keyNames[key];\n\t\tif (!names) {\n\t\t\treturn stream[key];\n\t\t}\n\t\tvar VALUE,\n\t\t\tvalueHandler = function(value) {\n\t\t\t\tVALUE = value;\n\t\t\t};\n\t\tstream[names.on](valueHandler);\n\t\tstream[names.off](valueHandler);\n\t\treturn VALUE;\n\t}\n}\n\n// The conditional is needed or the global CanJS build,\n// this code should not break if Kefir is not bundled\nif (Kefir) {\n\t// https://github.com/donejs/bitballs/issues/332\n\t// Kefir can appear to be an ES module.  This works around that.\n\tif(Object.isExtensible && !Object.isExtensible(Kefir)) {\n\t\tKefir = Kefir.Kefir;\n\t}\n\n\tKefir.Observable.prototype._eventSetup = function eventSetup() {\n\t\tvar stream = this;\n\t\tvar meta = ensureMeta(stream);\n\n\t\tmeta.bound = true;\n\n\t\tmeta.onValueHandler = function onValueHandler(newValue) {\n\t\t\tvar oldValue = meta.value;\n\t\t\tmeta.value = newValue;\n\n\t\t\t// only send events for a change\n\t\t\tif (newValue !== oldValue) {\n\t\t\t\tmapEventsMixin.dispatch.call(\n\t\t\t\t\tstream,\n\t\t\t\t\t{ type: \"value\" },\n\t\t\t\t\t[newValue, oldValue]\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\n\t\tmeta.onErrorHandler = function onErrorHandler(error) {\n\t\t\tvar prevError = meta.error;\n\t\t\tmeta.error = error;\n\n\t\t\tmapEventsMixin.dispatch.call(\n\t\t\t\tstream,\n\t\t\t\t{ type: \"error\" },\n\t\t\t\t[error, prevError]\n\t\t\t);\n\t\t};\n\n\t\tstream.onValue(meta.onValueHandler);\n\t\tstream.onError(meta.onErrorHandler);\n\t};\n\n\tKefir.Observable.prototype._eventTeardown = function eventTeardown() {\n\t\tvar stream = this;\n\t\tvar meta = ensureMeta(stream);\n\n\t\tmeta.bound = false;\n\n\t\tstream.offValue(meta.onValueHandler);\n\t\tstream.offError(meta.onErrorHandler);\n\t};\n\n\t// Observable is parent of Kefir.Stream\n\tcanReflect.assignSymbols(Kefir.Observable.prototype, {\n\t\t\"can.onKeyValue\": function onKeyValue() {\n\t\t\treturn mapEventsMixin[onKeyValueSymbol].apply(\n\t\t\t\tthis,\n\t\t\t\targuments\n\t\t\t);\n\t\t},\n\t\t\"can.offKeyValue\": function() {\n\t\t\treturn mapEventsMixin[offKeyValueSymbol].apply(\n\t\t\t\tthis,\n\t\t\t\targuments\n\t\t\t);\n\t\t},\n\t\t\"can.getKeyValue\": function(key) {\n\t\t\tvar stream = this;\n\t\t\tvar meta = ensureMeta(stream);\n\n\t\t\tif (!keyNames[key]) {\n\t\t\t\treturn stream[key];\n\t\t\t}\n\n\t\t\tObservationRecorder.add(stream, key);\n\n\t\t\tif (meta.bound) {\n\t\t\t\treturn meta[key];\n\t\t\t} else {\n\t\t\t\t// we haven't been bound ... see what we can get from the observable\n\t\t\t\t// using internals for performance ...\n\t\t\t\tvar currentValue = getCurrentValue(stream, key);\n\n\t\t\t\t// save current value so we won't through events if we provided a value\n\t\t\t\tmeta[key] = currentValue;\n\n\t\t\t\treturn currentValue;\n\t\t\t}\n\t\t},\n\t\t\"can.getValueDependencies\": function getValueDependencies() {\n\t\t\tvar sources;\n\t\t\tvar stream = this;\n\n\t\t\t// streams created by methods like .scan have a single source,\n\t\t\t// stored in stream._source\n\t\t\tif (stream._source != null) {\n\t\t\t\tsources = [stream._source];\n\n\t\t\t// ... while methods like .combine have multiple sources\n\t\t\t// stored as an array in stream._sources\n\t\t\t} else if (stream._sources != null) {\n\t\t\t\tsources = stream._sources;\n\t\t\t}\n\n\t\t\tif (sources != null) {\n\t\t\t\treturn {\n\t\t\t\t\tvalueDependencies: new Set(sources)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\n\tKefir.emitterProperty = function() {\n\t\tvar emitter;\n\t\tvar setLastValue = false;\n\t\tvar lastValue, lastError;\n\n\t\tvar stream = Kefir.stream(function(EMITTER) {\n\t\t\temitter = EMITTER;\n\t\t\tif (setLastValue) {\n\t\t\t\temitter.value(lastValue);\n\t\t\t}\n\t\t\treturn function() {\n\t\t\t\temitter = undefined;\n\t\t\t};\n\t\t});\n\n\t\tvar property = stream.toProperty(function() {\n\t\t\treturn lastValue;\n\t\t});\n\t\tproperty.emitter = {\n\t\t\tvalue: function(newValue) {\n\t\t\t\tif (emitter) {\n\t\t\t\t\treturn emitter.emit(newValue);\n\t\t\t\t} else {\n\t\t\t\t\tsetLastValue = true;\n\t\t\t\t\tlastValue = newValue;\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(error) {\n\t\t\t\tif (emitter) {\n\t\t\t\t\treturn emitter.error(error);\n\t\t\t\t} else {\n\t\t\t\t\tlastError = error;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tproperty.emitter.emit = property.emitter.value;\n\n\t\tcanReflect.assignSymbols(property, {\n\t\t\t\"can.setKeyValue\": function setKeyValue(key, value) {\n\t\t\t\tthis.emitter[key](value);\n\t\t\t}\n\t\t});\n\n\t\treturn property;\n\t};\n}\n\nmodule.exports = Kefir;\n"],"names":["exports","extend","target","length","arguments","i","prop","inherit","Child","Parent","proto","F","prototype","constructor","NOTHING","END","VALUE","ERROR","ANY","concat","a","b","result","j","Array","find","arr","value","findByPred","pred","cloneArray","input","remove","index","map","fn","callSubscriber","type","event","Dispatcher","this","_items","_spies","_inLoop","_removedItems","Observable","_dispatcher","_active","_alive","_activating","_logHandlers","_spyHandlers","Stream","call","Property","_currentEvent","add","x","push","addSpy","removeSpy","indexOf","dispatch","spies","_i","items","cleanup","_name","_onActivation","_onDeactivation","_setActive","active","_clear","_emit","_emitValue","_emitError","_emitEnd","_on","_off","count","onValue","onError","onEnd","onAny","offValue","offError","offEnd","offAny","observe","observerOrOnValue","_this","closed","observer","error","end","handler","unsubscribe","_ofSameType","A","B","getType","setName","sourceObs","selfName","log","name","undefined","toString","isCurrent","console","offLog","handlerIndex","obj","splice","spy","offSpy","neverS","never","timeBased","mixin","AnonymousStream","wait","options","_wait","_intervalId","_$onTick","_onTick","_init","_free","setInterval","clearInterval","S","_ref","_x","later","S$1","interval","S$2","xs","_xs","shift","sequentially","S$3","_fn","fromPoll","emitter","obs","e","emit","emitEvent","S$4","_emitter","withInterval","S$5","_unsubscribe","stream","fromCallback","callbackConsumer","called","fromNodeCallback","spread","apply","_callUnsubscribe","pairs","fromEvents","eventName","transformer","sub","unsub","Error","c","aLength","fromSubUnsub","P","current","constant","P$1","constantError","createConstructor","BaseClass","source","_source","_$handleAny","_handleAny","createClassMethods","_handleValue","_handleError","_handleEnd","createStream","createProperty","P$2","_getInitialCurrent","getInitial","toProperty","S$6","fromPromise","promise","_promise","then","done","getGlodalPromise","Promise","commonjsGlobal","window","global","self","createCommonjsModule","module","ponyfill","Object","defineProperty","root","_Symbol","Symbol","observable","_ponyfill2","__esModule","default","$$observable","fromESObservable","_observable","subscribe","next","complete","ESObservable","takeErrors","toESObservable","collect","keys","values","hasOwnProperty","Combine","passive","combinator","_activeCount","_sources","_combinator","_aliveCount","_latestValues","_latestErrors","fillArray","_emitAfterActivation","_endAfterActivation","_latestErrorIndex","_$handlers","_loop","combine","isArray","combineAsArray","activeObservables","passiveObservables","combineAsObject","observerOrOnNext","onComplete","subscription","_emitIfFull","hasAllValues","hasErrors","valuesCopy","errorsCopy","errors","latestError","defaultErrorsCombinator","Observable$2","empty","merge","of","bimap","fnErr","fnVal","mapErrors","ap","obsFn","obsVal","val","chain","flatMap","staticLand","freeze","S$7","P$3","id","map$1","mixin$1","S$8","P$4","id$1","mixin$2","n","_n","S$9","P$5","mixin$3","S$10","P$6","mixin$4","S$11","P$7","id$2","mixin$5","_lastValue","S$12","P$8","mixin$6","Math","max","S$13","P$9","mixin$7","S$14","P$10","id$3","mixin$8","_prev","S$15","P$11","eq","skipDuplicates","mixin$9","seed","S$16","P$12","defaultFn","P$13","_seed","S$17","id$4","END_MARKER","mixin$11","_buff","_$shiftBuff","setTimeout","S$18","P$14","now","Date","getTime","mixin$12","leading","trailing","_leading","_trailing","_trailingValue","_timeoutId","_endLater","_lastCallTime","_$trailingCall","_trailingCall","curTime","remaining","_cancelTrailing","clearTimeout","S$19","P$15","mixin$13","immediate","_immediate","_lastAttempt","_laterValue","_$later","_later","last","S$20","P$16","mixin$14","S$21","P$17","id$5","mixin$15","S$22","P$18","id$6","mixin$16","S$23","P$19","mixin$17","S$24","P$20","mixin$18","S$25","P$21","mixin$19","S$26","P$22","mixin$20","min","_max","_min","cur","offset","slide","S$27","P$23","mixin$21","flushOnEnd","_flushOnEnd","_flush","S$28","P$24","id$7","mixin$22","_count","S$29","P$25","mixin$23","S$30","P$26","mixin$24","transducer","_xform","@@transducer/step","res","@@transducer/result","S$31","P$27","mixin$25","_handler","S$32","P$28","Zip","sources","_buffers","zip","observables","_isFull","id$8","AbstractPool","_ref$queueLim","queueLim","_ref$concurLim","concurLim","_ref$drop","drop","_queueLim","_concurLim","_drop","_queue","_curSources","_$handleSubAny","_handleSubAny","_$endHandlers","_currentlyAdding","Merge","_addAll","_initialised","S$33","generator","_generator","_iteration","_add","toObs","_addToCur","_addToQueue","_removeOldest","obss","_this2","forEach","_remove","_removeCur","_removeQueue","_pullQueue","_onEmpty","_subToEnd","_this3","_subscribe","onEndI","_isEmpty","_getSource","repeat","concat$1","Pool","FlatMap","_mainEnded","_lastCurrent","_$handleMain","_handleMain","FlatMapErrors","createConstructor$1","primary","secondary","_primary","_secondary","_lastSecondary","_$handleSecondaryAny","_handleSecondaryAny","_$handlePrimaryAny","_handlePrimaryAny","createClassMethods$1","_handlePrimaryValue","_handlePrimaryError","_handlePrimaryEnd","_handleSecondaryValue","_handleSecondaryError","_handleSecondaryEnd","_removeSecondary","createStream$1","createProperty$1","plug","unplug","_hadNoEvSinceDeact","sameCurr","mixin$26","S$34","P$29","id2","_","mixin$27","S$35","P$30","mixin$28","S$36","P$31","mixin$29","_ref$flushOnEnd","S$37","P$32","mixin$30","_ref$flushOnChange","flushOnChange","_flushOnChange","S$38","P$33","f","t","mixin$31","convert","S$39","P$34","defFn","mixin$32","S$40","P$35","defFn$1","mixin$33","S$41","P$36","changes","toPromise","resolve","reject","filter","take","takeWhile","skip","skipWhile","diff","scan","flatten","delay","throttle","_ref2","_ref2$leading","_ref2$trailing","debounce","_ref2$immediate","filterErrors","ignoreValues","ignoreErrors","ignoreEnd","beforeEnd","slidingWindow","bufferWhile","_ref2$flushOnEnd","bufferWithCount","bufferWhile$1","bufferWithTimeOrCount","transduce","withHandler","thru","other","pool","flatMapLatest","flatMapFirst","flatMapConcat","flatMapConcurLimit","limit","flatMapErrors","filterBy","sampledBy","skipUntilBy","takeUntilBy","bufferBy","bufferWhileBy","DEPRECATION_WARNINGS","warn","msg","awaiting","valuesToErrors","errorsToValues","endOnError","Kefir","dissableDeprecationWarnings","factory","require$$0","metaSymbol","canSymbol","for","onKeyValueSymbol","offKeyValueSymbol","keyNames","on","off","handlers","ensureMeta","meta","canReflect","setKeyValue","getCurrentValue","key","names","valueHandler","isExtensible","_eventSetup","bound","onValueHandler","newValue","oldValue","mapEventsMixin","onErrorHandler","prevError","_eventTeardown","assignSymbols","can.onKeyValue","can.offKeyValue","can.getKeyValue","ObservationRecorder","currentValue","can.getValueDependencies","valueDependencies","Set","emitterProperty","lastValue","setLastValue","property","EMITTER","can.setKeyValue"],"mappings":"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"}