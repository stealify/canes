import{a as canMap,b as bubble,c as mapHelpers,d as types,e as CIDMap}from"./chunk-ad124247.mjs";import"./chunk-805ffcb4.mjs";import"./chunk-862b179d.mjs";import"./chunk-f8a6947c.mjs";import"./chunk-fa6b878a.mjs";import"./chunk-e85142ea.mjs";import"./chunk-5f1245ff.mjs";import"./chunk-bd824939.mjs";import{a as canSymbol}from"./chunk-b37d91a1.mjs";import{a as namespace}from"./chunk-3b4c7b38.mjs";import{a as queues}from"./chunk-12ed728f.mjs";import{a as mapEventBindings}from"./chunk-910f3205.mjs";import{a as ObservationRecorder}from"./chunk-8811d387.mjs";import{a as CID}from"./chunk-cb265e10.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import{a as assign}from"./chunk-75bea8d8.mjs";var splice=[].splice,spliceRemovesProps=function(){var t={0:"a",length:1};return splice.call(t,0,1),!t[0]}(),serializeNonTypes=function(t,e,i){!e||!e.serialize||e instanceof t?i.push(e):i.push(new t(e.serialize()))},List=canMap.extend({Map:canMap},{setup:function(t,e){var i;this.length=0,CID(this,".map"),this._setupComputedProperties(),t=void 0===t?[]:canReflect.toArray(t),canReflect.isPromise(t)?this.replace(t):(i=t.length&&mapHelpers.addToMap(t,this),this.push.apply(this,t)),i&&i(),assign(this,e)},_triggerChange:function(t,e,i,s){queues.batch.start();var n,a=+t;~(""+t).indexOf(".")||isNaN(a)?canMap.prototype._triggerChange.apply(this,arguments):(bubble.isBubbling(this,"change")&&mapEventBindings.dispatch.call(this,{type:"change",target:this},[t,e,i,s]),"add"===e?(n=[{insert:i,index:a,deleteCount:0,type:"splice"}],mapEventBindings.dispatch.call(this,{type:e,patches:n},[i,a]),mapEventBindings.dispatch.call(this,"length",[this.length])):"remove"===e?(n=[{index:a,deleteCount:s.length,type:"splice"}],mapEventBindings.dispatch.call(this,{type:e,patches:n},[s,a]),mapEventBindings.dispatch.call(this,"length",[this.length])):mapEventBindings.dispatch.call(this,e,[i,a])),queues.batch.stop()},___get:function(t){if(t){var e=this._computedAttrs[t];return e&&e.compute?canReflect.getValue(e.compute):this[t]&&this[t].isComputed&&"function"==typeof this.constructor.prototype[t]?canReflect.getValue(this[t]):this[t]}return this},__set:function(t,e,i){if("number"==typeof(t=isNaN(+t)||t%1?t:+t)){if(t>this.length-1){var s=new Array(t+1-this.length);return s[s.length-1]=e,this.push.apply(this,s),s}return this.splice(t,1,e),this}return canMap.prototype.__set.call(this,""+t,e,i)},___set:function(t,e){this[t]=e,+t>=this.length&&(this.length=+t+1)},__remove:function(t,e){isNaN(+t)?(delete this[t],this._triggerChange(t,"remove",void 0,e)):this.splice(t,1)},_each:function(t){for(var e=this.___get(),i=0;i<e.length;i++)t(e[i],i)},serialize:function(){return canReflect.serialize(this,CIDMap)},splice:function(t,e){var i,s,n,a=canReflect.toArray(arguments),r=[],c=a.length>2;for(t=t||0,i=0,s=a.length-2;i<s;i++)a[n=i+2]=this.__type(a[n],n),r.push(a[n]),this[i+t]!==a[n]&&(c=!1);if(c&&this.length<=r.length)return r;void 0===e&&(e=a[1]=this.length-t);var o=splice.apply(this,a);if(!spliceRemovesProps)for(i=this.length;i<o.length+this.length;i++)delete this[i];return queues.batch.start(),e>0&&(bubble.removeMany(this,o),this._triggerChange(""+t,"remove",void 0,o)),a.length>2&&(bubble.addMany(this,r),this._triggerChange(""+t,"add",r,o)),queues.batch.stop(),o}}),getArgs=function(t){return t[0]&&Array.isArray(t[0])?t[0]:canReflect.toArray(t)};canReflect.eachKey({push:"length",unshift:0},function(t,e){var i=[][e];List.prototype[e]=function(){for(var e,s,n=[],a=t?this.length:0,r=arguments.length;r--;)s=arguments[r],n[r]=bubble.set(this,r,this.__type(s,r));return e=i.apply(this,n),this.comparator&&!n.length||this._triggerChange(""+a,"add",n,void 0),e}}),canReflect.eachKey({pop:"length",shift:0},function(t,e){List.prototype[e]=function(){if(this.length){var i=getArgs(arguments),s=t&&this.length?this.length-1:0,n=[][e].apply(this,i);return this._triggerChange(""+s,"remove",void 0,[n]),n&&n.removeEventListener&&bubble.remove(this,n),n}}}),assign(List.prototype,{indexOf:function(t,e){ObservationRecorder.add(this,"length");for(var i=e||0,s=this.length;i<s;i++)if(this.attr(i)===t)return i;return-1},join:function(){return ObservationRecorder.add(this,"length"),[].join.apply(this,arguments)},reverse:function(){var t=[].reverse.call(canReflect.toArray(this));return this.replace(t)},slice:function(){ObservationRecorder.add(this,"length");var t=Array.prototype.slice.apply(this,arguments);return new this.constructor(t)},concat:function(){var t=[],e=this.constructor.Map;return canReflect.each(arguments,function(i){if(canReflect.isObservableLike(i)&&canReflect.isListLike(i)||Array.isArray(i)){var s=canReflect.isObservableLike(i)&&canReflect.isListLike(i)?canReflect.toArray(i):i;canReflect.each(s,function(i){serializeNonTypes(e,i,t)})}else serializeNonTypes(e,i,t)}),new this.constructor(Array.prototype.concat.apply(canReflect.toArray(this),t))},forEach:function(t,e){for(var i,s=0,n=this.attr("length");s<n&&(void 0===(i=this.attr(s))||!1!==t.call(e||i,i,s,this));s++);return this},replace:function(t){if(canReflect.isPromise(t)){this._promise&&(this._promise.__isCurrentPromise=!1);var e=this._promise=t;e.__isCurrentPromise=!0;var i=this;t.then(function(t){e.__isCurrentPromise&&i.replace(t)})}else t=void 0===t?[]:canReflect.toArray(t),this.splice.apply(this,[0,this.length].concat(t));return this},filter:function(t,e){var i=new this.constructor,s=this;return this.forEach(function(n,a,r){t.call(e||s,n,a,s)&&i.push(n)}),i},map:function(t,e){var i=new List,s=this;return this.forEach(function(n,a,r){var c=t.call(e||s,n,a,s);i.push(c)}),i}});var oldType=canMap.prototype.__type;canMap.prototype.__type=function(t,e){if("object"==typeof t&&Array.isArray(t)){var i=mapHelpers.getMapFromObject(t);return i||new List(t)}return oldType.apply(this,arguments)};var oldSetup=canMap.setup;canMap.setup=function(){oldSetup.apply(this,arguments),this.prototype instanceof List||(this.List=canMap.List.extend({Map:this},{}))},types.DefaultList||(types.DefaultList=List),canReflect.assignSymbols(List.prototype,{"can.isMoreListLikeThanMapLike":!0,"can.isListLike":!0,"can.getKeyValue":List.prototype._get,"can.setKeyValue":List.prototype._set,"can.deleteKeyValue":List.prototype._remove,"can.getOwnEnumerableKeys":function(){return Object.keys(this._data||{}).concat(this.map(function(t,e){return e}))},"can.assignDeep":function(t){queues.batch.start(),canReflect.assignDeepList(this,t),queues.batch.stop()},"can.updateDeep":function(t){queues.batch.start(),canReflect.updateDeepList(this,t),queues.batch.stop()},"can.unwrap":mapHelpers.reflectUnwrap,"can.serialize":mapHelpers.reflectSerialize,"can.onKeysAdded":function(t){this[canSymbol.for("can.onKeyValue")]("add",t)},"can.onKeysRemoved":function(t){this[canSymbol.for("can.onKeyValue")]("remove",t)},"can.splice":function(t,e,i){this.splice.apply(this,[t,e].concat(i))}}),canMap.List=List;var canList=namespace.List=List;export{canList as a,canMap as b,canList as c};
//# sourceMappingURL=chunk-f25bc34b.js.map
