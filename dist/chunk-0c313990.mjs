import"./chunk-5f1245ff.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import{a as canSymbol}from"./chunk-b37d91a1.mjs";import"./chunk-bd824939.mjs";import{a as assign}from"./chunk-75bea8d8.mjs";var makeDependencyRecord=function(){return{keyDependencies:new Map,valueDependencies:new Set}},makeRootRecord=function(){return{mutateDependenciesForKey:new Map,mutateDependenciesForValue:makeDependencyRecord()}},addMutatedBy=function(e){return function(n,t,a){var c=3===arguments.length;if(2===arguments.length&&(a=t,t=void 0),!a.keyDependencies&&!a.valueDependencies){var i=new Set;i.add(a),a={valueDependencies:i}}var d=e.get(n);d||(d=makeRootRecord(),e.set(n,d)),c&&!d.mutateDependenciesForKey.get(t)&&d.mutateDependenciesForKey.set(t,makeDependencyRecord());var s=c?d.mutateDependenciesForKey.get(t):d.mutateDependenciesForValue;a.valueDependencies&&canReflect.addValues(s.valueDependencies,a.valueDependencies),a.keyDependencies&&canReflect.each(a.keyDependencies,function(e,n){var t=s.keyDependencies.get(n);t||(t=new Set,s.keyDependencies.set(n,t)),canReflect.addValues(t,e)})}},deleteMutatedBy=function(e){return function(n,t,a){var c=3===arguments.length,i=e.get(n);if(2===arguments.length&&(a=t,t=void 0),!a.keyDependencies&&!a.valueDependencies){var d=new Set;d.add(a),a={valueDependencies:d}}var s=c?i.mutateDependenciesForKey.get(t):i.mutateDependenciesForValue;a.valueDependencies&&canReflect.removeValues(s.valueDependencies,a.valueDependencies),a.keyDependencies&&canReflect.each(a.keyDependencies,function(e,n){var t=s.keyDependencies.get(n);t&&(canReflect.removeValues(t,e),t.size||s.keyDependencies.delete(n))})}},isFunction=function(e){return"function"==typeof e},getWhatIChangeSymbol=canSymbol.for("can.getWhatIChange"),getKeyDependenciesSymbol=canSymbol.for("can.getKeyDependencies"),getValueDependenciesSymbol=canSymbol.for("can.getValueDependencies"),getKeyDependencies=function(e,n){if(isFunction(e[getKeyDependenciesSymbol]))return canReflect.getKeyDependencies(e,n)},getValueDependencies=function(e){if(isFunction(e[getValueDependenciesSymbol]))return canReflect.getValueDependencies(e)},getMutatedKeyDependencies=function(e,n,t){var a,c=e.get(n);return c&&c.mutateDependenciesForKey.has(t)&&(a=c.mutateDependenciesForKey.get(t)),a},getMutatedValueDependencies=function(e,n){var t,a=e.get(n);if(a){var c=a.mutateDependenciesForValue;c.keyDependencies.size&&((t=t||{}).keyDependencies=c.keyDependencies),c.valueDependencies.size&&((t=t||{}).valueDependencies=c.valueDependencies)}return t},getWhatIChange=function(e,n){if(isFunction(e[getWhatIChangeSymbol]))return 2===arguments.length?canReflect.getWhatIChange(e,n):canReflect.getWhatIChange(e)},isEmptyRecord=function(e){return null==e||!Object.keys(e).length||e.keyDependencies&&!e.keyDependencies.size&&e.valueDependencies&&!e.valueDependencies.size},getWhatChangesMe=function(e,n,t){var a=3===arguments.length,c=a?getMutatedKeyDependencies(e,n,t):getMutatedValueDependencies(e,n),i=a?getKeyDependencies(n,t):getValueDependencies(n);if(!isEmptyRecord(c)||!isEmptyRecord(i))return assign(assign({},c?{mutate:c}:null),i?{derive:i}:null)},getDependencyDataOf=function(e){return function(n,t){var a=2===arguments.length,c=a?getWhatChangesMe(e,n,t):getWhatChangesMe(e,n),i=a?getWhatIChange(n,t):getWhatIChange(n);if(c||i)return assign(assign({},i?{whatIChange:i}:null),c?{whatChangesMe:c}:null)}},mutatedByMap=new WeakMap,canReflectDependencies={addMutatedBy:addMutatedBy(mutatedByMap),deleteMutatedBy:deleteMutatedBy(mutatedByMap),getDependencyDataOf:getDependencyDataOf(mutatedByMap)};export{canReflectDependencies as a,canReflectDependencies as b};
//# sourceMappingURL=chunk-0c313990.js.map
