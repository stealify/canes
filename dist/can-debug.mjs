import{a as canSymbol}from"./chunk-b37d91a1.mjs";import"./chunk-5f1245ff.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import"./chunk-0c313990.mjs";import{a as canReflectDeps}from"./chunk-0cc812f8.mjs";import"./chunk-805ffcb4.mjs";import"./chunk-fea13b24.mjs";import"./chunk-862b179d.mjs";import{a as mergeDeep}from"./chunk-1e549d43.mjs";import{a as namespace}from"./chunk-3b4c7b38.mjs";import{a as globals}from"./chunk-185a1a27.mjs";import{a as queues}from"./chunk-12ed728f.mjs";import"./chunk-bacf0c54.mjs";import"./chunk-bd824939.mjs";import"./chunk-75bea8d8.mjs";import"./chunk-cc1f8896.mjs";import"./chunk-eae5b219.mjs";import"./chunk-14877182.mjs";import"./chunk-932cc7dc.mjs";import"./chunk-e7f43bec.mjs";import"./chunk-585d4076.mjs";import"./chunk-3f0a7243.mjs";var warned=!1,proxyNamespace=function(e){return new Proxy(e,{get:function(e,n){return warned||(console.warn("Warning: use of 'can' global should be for debugging purposes only."),warned=!0),e[n]}})},onValueSymbol=canSymbol.for("can.onValue"),offValueSymbol=canSymbol.for("can.offValue"),onKeyValueSymbol=canSymbol.for("can.onKeyValue"),offKeyValueSymbol=canSymbol.for("can.offKeyValue"),noop=function(){};function isFunction(e){return"function"==typeof e}function withKey(e,n,t){var a;return isFunction(e[onKeyValueSymbol])&&canReflect.onKeyValue(e,n,noop),a=t(e,n),isFunction(e[offKeyValueSymbol])&&canReflect.offKeyValue(e,n,noop),a}function withoutKey(e,n){var t;return isFunction(e[onValueSymbol])&&canReflect.onValue(e,noop),t=n(e),isFunction(e[offValueSymbol])&&canReflect.offValue(e,noop),t}var temporarilyBind=function(e){return function(n,t){return 2===arguments.length?withKey(n,t,e):withoutKey(n,e)}};function Graph(){this.nodes=[],this.arrows=new Map,this.arrowsMeta=new Map}function addArrowMeta(e,n,t,a){var o=e.arrowsMeta.get(n);if(o){var r=o.get(t);r||(r={}),o.set(t,Object.assign(r,a))}else o=new Map([[t,a]]),e.arrowsMeta.set(n,o)}Graph.prototype.addNode=function(e){this.nodes.push(e),this.arrows.set(e,new Set)},Graph.prototype.addArrow=function(e,n,t){this.arrows.get(e).add(n),t&&addArrowMeta(this,e,n,t)},Graph.prototype.hasArrow=function(e,n){return this.getNeighbors(e).has(n)},Graph.prototype.getArrowMeta=function(e,n){return this.arrowsMeta.get(e)&&this.arrowsMeta.get(e).get(n)},Graph.prototype.setArrowMeta=function(e,n,t){addArrowMeta(this,e,n,t)},Graph.prototype.getNeighbors=function(e){return this.arrows.get(e)},Graph.prototype.findNode=function(e){var n=null;for(var t of this.nodes)if(e(t)){n=t;break}return n},Graph.prototype.bfs=function(e){for(var n=this.nodes[0],t=[n],a=new Map([[n,!0]]);t.length;)e(n=t.shift()),this.arrows.get(n).forEach(function(e){a.has(e)||(t.push(e),a.set(e,!0))})},Graph.prototype.dfs=function(e){for(var n=this.nodes[0],t=[n],a=new Map;t.length;)e(n=t.pop()),a.has(n)||(a.set(n,!0),this.arrows.get(n).forEach(function(e){t.push(e)}))},Graph.prototype.reverse=function(){var e=this,n=new Graph;return e.nodes.forEach(n.addNode.bind(n)),e.nodes.forEach(function(t){e.getNeighbors(t).forEach(function(a){var o=e.getArrowMeta(t,a);n.addArrow(a,t,o)})}),n};var graph=Graph,makeNode=function(e,n){var t=2===arguments.length,a={obj:e,name:canReflect.getName(e),value:t?canReflect.getKeyValue(e,n):canReflect.getValue(e)};return t&&(a.key=n),a},getGraph=function(e,n){var t=0,a=new graph,o=2===arguments.length,r=function(e,n,t,o){switch(e){case"whatIChange":a.addArrow(n,t,o);break;case"whatChangesMe":a.addArrow(t,n,o);break;default:throw new Error("Unknown direction value: ",o.direction)}},c=function(e,n,t){canReflect.eachKey(e.keyDependencies||{},function(e,a){canReflect.each(e,function(e){t(a,n,e)})})},i=function(e,n,t){canReflect.eachIndex(e.valueDependencies||[],function(e){t(e,n)})},s=function e(n,o,s){var h,u=3===arguments.length,f=a.findNode(function(e){return u?e.obj===n&&e.key===s:e.obj===n});if(f)return o.parent&&r(o.direction,o.parent,f,{kind:o.kind,direction:o.direction}),a;t+=1,(f=u?makeNode(n,s):makeNode(n)).order=t,a.addNode(f),o.parent&&r(o.direction,o.parent,f,{kind:o.kind,direction:o.direction});var g=u?canReflectDeps.getDependencyDataOf(n,s):canReflectDeps.getDependencyDataOf(n);return g&&g.whatIChange&&(h={direction:"whatIChange",parent:f},canReflect.eachKey(g.whatIChange,function(n,t){h.kind=t,c(n,h,e),i(n,h,e)})),g&&g.whatChangesMe&&(h={direction:"whatChangesMe",parent:f},canReflect.eachKey(g.whatChangesMe,function(n,t){h.kind=t,c(n,h,e),i(n,h,e)})),a};return o?s(e,{},n):s(e,{})},formatGraph=function(e){var n=new Map(e.nodes.map(function(e,n){return[e,n+1]})),t=e.nodes.map(function(e){return{shape:"box",id:n.get(e),label:canReflect.getName(e.obj)+(e.key?"."+e.key:"")}}),a=new Map,o=[];return e.nodes.forEach(function(t){var r=function(t){if(!a.has(t)){a.set(t,!0);var c=e.arrows.get(t),i=n.get(t);c.forEach(function(a){var c=n.get(a),s=e.arrowsMeta.get(t).get(a);o.push(Object.assign({from:i,to:c},function(e){return{derive:{arrows:"to"},mutate:{arrows:"to",dashes:!0}}[e.kind]}(s))),r(a)})}};r(t)}),{nodes:t,edges:o}},quoteString=function(e){return"string"==typeof e?JSON.stringify(e):e},logData=function e(n){var t=n.node,a=[t.name,"key"in t?"."+t.key:""];console.group(a.join("")),console.log("value  ",quoteString(t.value)),console.log("object ",t.obj),n.derive.length&&(console.group("DERIVED FROM"),canReflect.eachIndex(n.derive,e),console.groupEnd()),n.mutations.length&&(console.group("MUTATED BY"),canReflect.eachIndex(n.mutations,e),console.groupEnd()),n.twoWay.length&&(console.group("TWO WAY"),canReflect.eachIndex(n.twoWay,e),console.groupEnd()),console.groupEnd()},labelCycles=function(e){var n=new Map,t=new graph;e.nodes.forEach(function(e){t.addNode(e)});return function a(o){n.set(o,!0),e.getNeighbors(o).forEach(function(r){n.has(r)?e.hasArrow(o,r)&&t.addArrow(r,o,{kind:"twoWay"}):(t.addArrow(o,r,e.getArrowMeta(o,r)),a(r))})}(e.nodes[0]),t},isDisconnected=function(e){return!e.derive.length&&!e.mutations.length&&!e.twoWay.length},getData=function(e,n){var t=new Map,a=labelCycles("whatChangesMe"===n?e.reverse():e),o=function e(n){var o={node:n,derive:[],mutations:[],twoWay:[]};return t.set(n,!0),a.getNeighbors(n).forEach(function(r){var c=a.getArrowMeta(n,r);if(!t.has(r))switch(c.kind){case"twoWay":o.twoWay.push(e(r));break;case"derive":o.derive.push(e(r));break;case"mutate":o.mutations.push(e(r));break;default:throw new Error("Unknow meta.kind value: ",c.kind)}}),o}(a.nodes[0]);return isDisconnected(o)?null:o},whatIChange=function(e,n){var t=2===arguments.length,a=getData(t?getGraph(e,n):getGraph(e),"whatIChange");a&&logData(a)},whatChangesMe=function(e,n){var t=2===arguments.length,a=getData(t?getGraph(e,n):getGraph(e),"whatChangesMe");a&&logData(a)},getWhatIChange=function(e,n){var t=2===arguments.length;return getData(t?getGraph(e,n):getGraph(e),"whatIChange")},getWhatChangesMe=function(e,n){var t=2===arguments.length;return getData(t?getGraph(e,n):getGraph(e),"whatChangesMe")},global$1=globals.getKeyValue("global"),devtoolsRegistrationComplete=!1;function registerWithDevtools(){if(!devtoolsRegistrationComplete){var e={Symbol:canSymbol,Reflect:canReflect,queues:queues,getGraph:namespace.debug.getGraph,formatGraph:namespace.debug.formatGraph,mergeDeep:mergeDeep};global$1.__CANJS_DEVTOOLS__?global$1.__CANJS_DEVTOOLS__.register(e):Object.defineProperty(global$1,"__CANJS_DEVTOOLS__",{set:function(n){Object.defineProperty(global$1,"__CANJS_DEVTOOLS__",{value:n}),n.register(e)},configurable:!0}),devtoolsRegistrationComplete=!0}}var canDebug=function(){return namespace.debug={getGraph:temporarilyBind(getGraph),formatGraph:temporarilyBind(formatGraph),getWhatIChange:temporarilyBind(getWhatIChange),getWhatChangesMe:temporarilyBind(getWhatChangesMe),logWhatIChange:temporarilyBind(whatIChange),logWhatChangesMe:temporarilyBind(whatChangesMe)},registerWithDevtools(),global$1.can="undefined"!=typeof Proxy?proxyNamespace(namespace):namespace,namespace.debug};export default canDebug;
//# sourceMappingURL=can-debug.js.map
