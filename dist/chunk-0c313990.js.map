{"version":3,"file":"chunk-0c313990.js","sources":["../node_modules/can-reflect-dependencies/src/add-mutated-by.js","../node_modules/can-reflect-dependencies/src/delete-mutated-by.js","../node_modules/can-reflect-dependencies/src/is-function.js","../node_modules/can-reflect-dependencies/src/get-dependency-data-of.js","../node_modules/can-reflect-dependencies/can-reflect-dependencies.js"],"sourcesContent":["\"use strict\";\nvar canReflect = require(\"can-reflect\");\n\n// DependencyRecord :: { keyDependencies: Map, valueDependencies: Set }\nvar makeDependencyRecord = function makeDependencyRecord() {\n\treturn {\n\t\tkeyDependencies: new Map(),\n\t\tvalueDependencies: new Set()\n\t};\n};\n\nvar makeRootRecord = function makeRootRecord() {\n\treturn {\n\t\t// holds mutated key dependencies of a key-value like object, e.g:\n\t\t// if person.first is mutated by other observable, this map will have a\n\t\t// key `first` (the mutated property) mapped to a DependencyRecord\n\t\tmutateDependenciesForKey: new Map(),\n\n\t\t// holds mutated value dependencies of value-like objects\n\t\tmutateDependenciesForValue: makeDependencyRecord()\n\t};\n};\n\nmodule.exports = function(mutatedByMap) {\n\treturn function addMutatedBy(mutated, key, mutator) {\n\t\tvar gotKey = arguments.length === 3;\n\n\t\t// normalize arguments\n\t\tif (arguments.length === 2) {\n\t\t\tmutator = key;\n\t\t\tkey = undefined;\n\t\t}\n\n\t\t// normalize mutator when shorthand is used\n\t\tif (!mutator.keyDependencies && !mutator.valueDependencies) {\n\t\t\tvar s = new Set();\n\t\t\ts.add(mutator);\n\t\t\tmutator = { valueDependencies:s };\n\t\t}\n\n\t\t// retrieve root record from the state map or create a new one\n\t\tvar root = mutatedByMap.get(mutated);\n\t\tif (!root) {\n\t\t\troot = makeRootRecord();\n\t\t\tmutatedByMap.set(mutated, root);\n\t\t}\n\n\t\t// create a [key] DependencyRecord if [key] was provided\n\t\t// and Record does not already exist\n\t\tif (gotKey && !root.mutateDependenciesForKey.get(key)) {\n\t\t\troot.mutateDependenciesForKey.set(key, makeDependencyRecord());\n\t\t}\n\n\t\t// retrieve DependencyRecord\n\t\tvar dependencyRecord = gotKey ?\n\t\t\troot.mutateDependenciesForKey.get(key) :\n\t\t\troot.mutateDependenciesForValue;\n\n\t\tif (mutator.valueDependencies) {\n\t\t\tcanReflect.addValues(\n\t\t\t\tdependencyRecord.valueDependencies,\n\t\t\t\tmutator.valueDependencies\n\t\t\t);\n\t\t}\n\n\t\tif (mutator.keyDependencies) {\n\t\t\tcanReflect.each(mutator.keyDependencies, function(keysSet, obj) {\n\t\t\t\tvar entry = dependencyRecord.keyDependencies.get(obj);\n\n\t\t\t\tif (!entry) {\n\t\t\t\t\tentry = new Set();\n\t\t\t\t\tdependencyRecord.keyDependencies.set(obj, entry);\n\t\t\t\t}\n\n\t\t\t\tcanReflect.addValues(entry, keysSet);\n\t\t\t});\n\t\t}\n\t};\n};\n","\"use strict\";\nvar canReflect = require(\"can-reflect\");\n\nmodule.exports = function(mutatedByMap) {\n\treturn function deleteMutatedBy(mutated, key, mutator) {\n\t\tvar gotKey = arguments.length === 3;\n\t\tvar root = mutatedByMap.get(mutated);\n\n\t\t// normalize arguments\n\t\tif (arguments.length === 2) {\n\t\t\tmutator = key;\n\t\t\tkey = undefined;\n\t\t}\n\n\t\t// normalize mutator when shorthand is used\n\t\tif (!mutator.keyDependencies && !mutator.valueDependencies) {\n\t\t\tvar s = new Set();\n\t\t\ts.add(mutator);\n\t\t\tmutator = { valueDependencies: s };\n\t\t}\n\n\t\tvar dependencyRecord = gotKey ?\n\t\t\troot.mutateDependenciesForKey.get(key) :\n\t\t\troot.mutateDependenciesForValue;\n\n\t\tif (mutator.valueDependencies) {\n\t\t\tcanReflect.removeValues(\n\t\t\t\tdependencyRecord.valueDependencies,\n\t\t\t\tmutator.valueDependencies\n\t\t\t);\n\t\t}\n\n\t\tif (mutator.keyDependencies) {\n\t\t\tcanReflect.each(mutator.keyDependencies, function(keysSet, obj) {\n\t\t\t\tvar entry = dependencyRecord.keyDependencies.get(obj);\n\n\t\t\t\tif (entry) {\n\t\t\t\t\tcanReflect.removeValues(entry, keysSet);\n\t\t\t\t\tif (!entry.size) {\n\t\t\t\t\t\tdependencyRecord.keyDependencies.delete(obj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n};\n","\"use strict\";\nmodule.exports = function isFunction(value) {\n\treturn typeof value === \"function\";\n};\n","\"use strict\";\nvar canSymbol = require(\"can-symbol\");\nvar canReflect = require(\"can-reflect\");\nvar isFunction = require(\"./is-function\");\nvar canAssign = require(\"can-assign\");\n\nvar getWhatIChangeSymbol = canSymbol.for(\"can.getWhatIChange\");\nvar getKeyDependenciesSymbol = canSymbol.for(\"can.getKeyDependencies\");\nvar getValueDependenciesSymbol = canSymbol.for(\"can.getValueDependencies\");\n\nvar getKeyDependencies = function getKeyDependencies(obj, key) {\n\tif (isFunction(obj[getKeyDependenciesSymbol])) {\n\t\treturn canReflect.getKeyDependencies(obj, key);\n\t}\n};\n\nvar getValueDependencies = function getValueDependencies(obj) {\n\tif (isFunction(obj[getValueDependenciesSymbol])) {\n\t\treturn canReflect.getValueDependencies(obj);\n\t}\n};\n\nvar getMutatedKeyDependencies =\n\tfunction getMutatedKeyDependencies(mutatedByMap, obj, key) {\n\t\tvar root = mutatedByMap.get(obj);\n\t\tvar dependencyRecord;\n\n\t\tif (root && root.mutateDependenciesForKey.has(key)) {\n\t\t\tdependencyRecord = root.mutateDependenciesForKey.get(key);\n\t\t}\n\n\t\treturn dependencyRecord;\n\t};\n\nvar getMutatedValueDependencies =\n\tfunction getMutatedValueDependencies( mutatedByMap, obj) {\n\t\tvar result;\n\t\tvar root = mutatedByMap.get(obj);\n\n\t\tif (root) {\n\t\t\tvar\tdependencyRecord = root.mutateDependenciesForValue;\n\n\t\t\tif (dependencyRecord.keyDependencies.size) {\n\t\t\t\tresult = result || {};\n\t\t\t\tresult.keyDependencies = dependencyRecord.keyDependencies;\n\t\t\t}\n\n\t\t\tif (dependencyRecord.valueDependencies.size) {\n\t\t\t\tresult = result || {};\n\t\t\t\tresult.valueDependencies = dependencyRecord.valueDependencies;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\nvar getWhatIChange = function getWhatIChange(obj, key) {\n\tif (isFunction(obj[getWhatIChangeSymbol])) {\n\t\tvar gotKey = arguments.length === 2;\n\n\t\treturn gotKey ?\n\t\t\tcanReflect.getWhatIChange(obj, key) :\n\t\t\tcanReflect.getWhatIChange(obj);\n\t}\n};\n\nvar isEmptyRecord = function isEmptyRecord(record) {\n\treturn (\n\t\trecord == null ||\n\t\t!Object.keys(record).length ||\n\t\t(record.keyDependencies && !record.keyDependencies.size) &&\n\t\t(record.valueDependencies && !record.valueDependencies.size)\n\t);\n};\n\nvar getWhatChangesMe = function getWhatChangesMe(mutatedByMap, obj, key) {\n\tvar gotKey = arguments.length === 3;\n\n\tvar mutate = gotKey ?\n\t\tgetMutatedKeyDependencies(mutatedByMap, obj, key) :\n\t\tgetMutatedValueDependencies(mutatedByMap, obj);\n\n\tvar derive = gotKey ?\n\t\tgetKeyDependencies(obj, key) :\n\t\tgetValueDependencies(obj);\n\n\tif (!isEmptyRecord(mutate) || !isEmptyRecord(derive)) {\n\t\treturn canAssign(\n\t\t\tcanAssign(\n\t\t\t\t{},\n\t\t\t\tmutate ? { mutate: mutate } : null\n\t\t\t),\n\t\t\tderive ? { derive: derive } : null\n\t\t);\n\t}\n};\n\nmodule.exports = function(mutatedByMap) {\n\treturn function getDependencyDataOf(obj, key) {\n\t\tvar gotKey = arguments.length === 2;\n\n\t\tvar whatChangesMe = gotKey ?\n\t\t\tgetWhatChangesMe(mutatedByMap, obj, key) :\n\t\t\tgetWhatChangesMe(mutatedByMap, obj);\n\n\t\tvar whatIChange = gotKey ? getWhatIChange(obj, key) : getWhatIChange(obj);\n\n\t\tif (whatChangesMe || whatIChange) {\n\t\t\treturn canAssign(\n\t\t\t\tcanAssign(\n\t\t\t\t\t{},\n\t\t\t\t\twhatIChange ? { whatIChange: whatIChange } : null\n\t\t\t\t),\n\t\t\t\twhatChangesMe ? { whatChangesMe: whatChangesMe } : null\n\t\t\t);\n\t\t}\n\t};\n};\n","\"use strict\";\nvar addMutatedBy = require(\"./src/add-mutated-by\");\nvar deleteMutatedBy = require(\"./src/delete-mutated-by\");\nvar getDependencyDataOf = require(\"./src/get-dependency-data-of\");\n\n// mutatedByMap :: WeakMap<obj, {\n//\tmutateDependenciesForKey:   Map<key, DependencyRecord>,\n//\tmutateDependenciesForValue: DependencyRecord\n// }>\nvar mutatedByMap = new WeakMap();\n\nmodule.exports = {\n\t// Track mutations between observable as dependencies\n\t// addMutatedBy(obs, obs2);\n\t// addMutatedBy(obs, key, obs2);\n\t// addMutatedBy(obs, { valueDependencies: Set, keyDependencies: Map })\n\t// addMutatedBy(obs, key, { valueDependencies: Set, keyDependencies: Map })\n\taddMutatedBy: addMutatedBy(mutatedByMap),\n\n\t// Call this method with the same arguments as `addMutatedBy`\n\t// to unregister the mutation dependency\n\tdeleteMutatedBy: deleteMutatedBy(mutatedByMap),\n\n\t// Returns an object with the dependecies of the given argument\n\t//\t{\n\t//\t\twhatIChange: { mutate: DependencyRecord, derive: DependencyRecord },\n\t//\t\twhatChangesMe: { mutate: DependencyRecord, derive: DependencyRecord }\n\t//\t}\n\tgetDependencyDataOf: getDependencyDataOf(mutatedByMap)\n};\n"],"names":["makeDependencyRecord","keyDependencies","Map","valueDependencies","Set","makeRootRecord","mutateDependenciesForKey","mutateDependenciesForValue","mutatedByMap","mutated","key","mutator","gotKey","arguments","length","undefined","s","add","root","get","set","dependencyRecord","canReflect","addValues","each","keysSet","obj","entry","removeValues","size","delete","value","getWhatIChangeSymbol","canSymbol","for","getKeyDependenciesSymbol","getValueDependenciesSymbol","getKeyDependencies","isFunction","getValueDependencies","getMutatedKeyDependencies","has","getMutatedValueDependencies","result","getWhatIChange","isEmptyRecord","record","Object","keys","getWhatChangesMe","mutate","derive","canAssign","whatChangesMe","whatIChange","WeakMap","addMutatedBy","deleteMutatedBy","getDependencyDataOf"],"mappings":"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"}