{"version":3,"file":"chunk-d57927f5.js","sources":["../node_modules/can-stream/can-stream.js"],"sourcesContent":["\"use strict\";\nvar assign = require(\"can-assign\");\nvar compute = require(\"can-compute\");\nvar canReflect = require(\"can-reflect\");\nvar namespace = require(\"can-namespace\");\n\nvar toComputeFromEvent = function(observable, eventName){\n\tvar handler,\n\t\tlastSet;\n\treturn compute(undefined, {\n\t\ton: function(updated) {\n\t\t\thandler = function(ev, val) {\n\t\t\t\tlastSet = assign({\n\t\t\t\t\targs: [].slice.call(arguments, 1)\n\t\t\t\t}, ev);\n\t\t\t\tupdated();\n\t\t\t};\n\t\t\tobservable.on(eventName, handler);\n\t\t},\n\t\toff: function(updated) {\n\t\t\tobservable.off(eventName, handler);\n\t\t\tlastSet = undefined;\n\t\t},\n\t\tget: function(){\n\t\t\treturn lastSet;\n\t\t}\n\t});\n};\n\n\nvar STREAM = function(canStreamInterface) {\n\n\tvar canStream;\n\n\tvar toStreamFromProperty = function(obs, propName) {\n\t\treturn canStreamInterface.toStream(compute(obs, propName));\n\t};\n\n\tvar toStreamFromEvent = function() {\n\t\tvar obs = arguments[0];\n\t\tvar eventName, propName, lastValue, internalCompute;\n\n\n\t\tif(arguments.length === 2) {\n\t\t\t//.toStreamFromEvent(obs, event);\n\n\t\t\tinternalCompute = toComputeFromEvent(obs,  arguments[1]);\n\n\t\t\treturn canStreamInterface.toStream(internalCompute);\n\t\t} else {\n\t\t\t//.toStreamFromEvent(obs, propName, event);\n\t\t\tpropName = arguments[1];\n\t\t\teventName = arguments[2];\n\t\t\tlastValue = obs[propName];\n\n\t\t\tvar valuePropCompute = compute(obs, propName);\n\n\t\t\tvar eventHandler;\n\t\t\tvar propChangeHandler;\n\n\t\t\tinternalCompute = compute(undefined,{\n\t\t\t\ton: function(updater){\n\t\t\t\t\teventHandler = function(ev, newVal, oldVal) {\n\t\t\t\t\t\tlastValue = newVal;\n\t\t\t\t\t\tupdater(lastValue);\n\t\t\t\t\t};\n\n\t\t\t\t\tpropChangeHandler = function(ev, newVal, oldVal) {\n\t\t\t\t\t\toldVal.off(eventName, eventHandler);\n\t\t\t\t\t\tnewVal.on(eventName, eventHandler);\n\t\t\t\t\t};\n\n\t\t\t\t\tvaluePropCompute.on('change', propChangeHandler);\n\n\t\t\t\t\tvaluePropCompute().on(eventName, eventHandler);\n\t\t\t\t},\n\t\t\t\toff: function(){\n\t\t\t\t\tvaluePropCompute().off(eventName, eventHandler);\n\t\t\t\t\tvaluePropCompute.off('change', propChangeHandler);\n\t\t\t\t},\n\t\t\t\tget: function(){\n\t\t\t\t\treturn lastValue;\n\t\t\t\t},\n\t\t\t\tset: function(val){\n\t\t\t\t\tthrow new Error(\"can-stream: you can't set this type of compute\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar stream = canStreamInterface.toStream(internalCompute);\n\n\t\t\treturn stream;\n\t\t}\n\t};\n\n\t//.toStream(observable, propAndOrEvent[,event])\n\tvar toStream = function() {\n\n\t\tif(arguments.length === 1) {\n\t\t\t//we expect it to be a compute:\n\t\t\treturn canStreamInterface.toStream(arguments[0]); //toStream(compute)\n\t\t}\n\t\telse if(arguments.length > 1) {\n\t\t\tvar obs = arguments[0];\n\t\t\tvar eventNameOrPropName = arguments[1].trim();\n\n\t\t\tif(eventNameOrPropName.indexOf(\" \") === -1) {\n\t\t\t\t//no space found (so addressing the first three)\n\t\t\t\tif(eventNameOrPropName.indexOf(\".\") === 0) {\n\t\t\t\t\t//starts with a dot\n\t\t\t\t\treturn canStream.toStreamFromProperty(obs, eventNameOrPropName.slice(1)); //toStream(obj, \"tasks\")\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn canStream.toStreamFromEvent(obs, eventNameOrPropName); //toStream( obj, \"close\")\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar splitEventNameAndProperty = eventNameOrPropName.split(\" \");\n\t\t\t\treturn canStream.toStreamFromEvent(obs, splitEventNameAndProperty[0].slice(1), splitEventNameAndProperty[1]);  //toStream(obj, \"tasks add\")\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t};\n\n\tvar toCompute = function(makeStream, context) {\n\t\tvar args = canReflect.toArray(arguments);\n\t\treturn canStreamInterface.toCompute.apply(this, args);\n\t};\n\n\tcanStream = toStream;\n\tcanStream.toStream = canStream;\n\tcanStream.toStreamFromProperty = toStreamFromProperty;\n\tcanStream.toStreamFromEvent = toStreamFromEvent;\n\tcanStream.toCompute = toCompute;\n\n\treturn canStream;\n};\nSTREAM.toComputeFromEvent = toComputeFromEvent;\n\nmodule.exports = namespace.stream = STREAM;\n"],"names":["toComputeFromEvent","observable","eventName","handler","lastSet","compute","undefined","on","updated","ev","val","assign","args","slice","call","arguments","off","get","STREAM","canStreamInterface","canStream","length","toStream","obs","eventNameOrPropName","trim","indexOf","toStreamFromProperty","toStreamFromEvent","splitEventNameAndProperty","split","propName","lastValue","internalCompute","eventHandler","propChangeHandler","valuePropCompute","updater","newVal","oldVal","set","Error","toCompute","makeStream","context","canReflect","toArray","apply","this","namespace","stream"],"mappings":"4SAMA,IAAIA,mBAAqB,SAASC,EAAYC,GAC7C,IAAIC,EACHC,EACD,OAAOC,aAAQC,EAAW,CACzBC,GAAI,SAASC,GACZL,EAAU,SAASM,EAAIC,GACtBN,EAAUO,OAAO,CAChBC,KAAM,GAAGC,MAAMC,KAAKC,UAAW,IAC7BN,GACHD,KAEDP,EAAWM,GAAGL,EAAWC,IAE1Ba,IAAK,SAASR,GACbP,EAAWe,IAAId,EAAWC,GAC1BC,OAAUE,GAEXW,IAAK,WACJ,OAAOb,MAMNc,OAAS,SAASC,GAErB,IAAIC,EAsGJ,OANAA,EAjCe,WAEd,GAAwB,IAArBL,UAAUM,OAEZ,OAAOF,EAAmBG,SAASP,UAAU,IAEzC,GAAGA,UAAUM,OAAS,EAAG,CAC7B,IAAIE,EAAMR,UAAU,GAChBS,EAAsBT,UAAU,GAAGU,OAEvC,IAAyC,IAAtCD,EAAoBE,QAAQ,KAE9B,OAAwC,IAArCF,EAAoBE,QAAQ,KAEvBN,EAAUO,qBAAqBJ,EAAKC,EAAoBX,MAAM,IAG9DO,EAAUQ,kBAAkBL,EAAKC,GAIzC,IAAIK,EAA4BL,EAAoBM,MAAM,KAC1D,OAAOV,EAAUQ,kBAAkBL,EAAKM,EAA0B,GAAGhB,MAAM,GAAIgB,EAA0B,OAYlGP,SAAWF,EACrBA,EAAUO,qBAhGiB,SAASJ,EAAKQ,GACxC,OAAOZ,EAAmBG,SAASjB,QAAQkB,EAAKQ,KAgGjDX,EAAUQ,kBA7Fc,WACvB,IACI1B,EAAW6B,EAAUC,EAAWC,EADhCV,EAAMR,UAAU,GAIpB,GAAwB,IAArBA,UAAUM,OAKZ,OAFAY,EAAkBjC,mBAAmBuB,EAAMR,UAAU,IAE9CI,EAAmBG,SAASW,GAGnCF,EAAWhB,UAAU,GACrBb,EAAYa,UAAU,GACtBiB,EAAYT,EAAIQ,GAEhB,IAEIG,EACAC,EAHAC,EAAmB/B,QAAQkB,EAAKQ,GAmCpC,OA9BAE,EAAkB5B,aAAQC,EAAU,CACnCC,GAAI,SAAS8B,GACZH,EAAe,SAASzB,EAAI6B,EAAQC,GAEnCF,EADAL,EAAYM,IAIbH,EAAoB,SAAS1B,EAAI6B,EAAQC,GACxCA,EAAOvB,IAAId,EAAWgC,GACtBI,EAAO/B,GAAGL,EAAWgC,IAGtBE,EAAiB7B,GAAG,SAAU4B,GAE9BC,IAAmB7B,GAAGL,EAAWgC,IAElClB,IAAK,WACJoB,IAAmBpB,IAAId,EAAWgC,GAClCE,EAAiBpB,IAAI,SAAUmB,IAEhClB,IAAK,WACJ,OAAOe,GAERQ,IAAK,SAAS9B,GACb,MAAM,IAAI+B,MAAM,qDAILtB,EAAmBG,SAASW,IA4C3Cb,EAAUsB,UATM,SAASC,EAAYC,GACpC,IAAIhC,EAAOiC,WAAWC,QAAQ/B,WAC9B,OAAOI,EAAmBuB,UAAUK,MAAMC,KAAMpC,IAS1CQ,GAERF,OAAOlB,mBAAqBA,iCAEXiD,UAAUC,OAAShC"}