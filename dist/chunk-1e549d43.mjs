import"./chunk-5f1245ff.mjs";import{a as diff}from"./chunk-3f0a7243.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";function smartMerge(e,t){return t=canReflect.serialize(t),canReflect.isMoreListLikeThanMapLike(e)?mergeList(e,t):mergeMap(e,t),e}function mergeMap(e,t){canReflect.eachKey(e,function(a,c){if(canReflect.hasKey(t,c)){var n=canReflect.getKeyValue(t,c);if(canReflect.deleteKeyValue(t,c),canReflect.isPrimitive(a))canReflect.setKeyValue(e,c,n);else{var i=Array.isArray(n),r=canReflect.isMoreListLikeThanMapLike(a);if(r&&i)mergeList(a,n);else if(!i&&!r&&canReflect.isMapLike(a)&&canReflect.isPlainObject(n)){var f=canReflect.getSchema(a);if(f&&f.identity&&f.identity.length){var l=canReflect.getIdentity(a,f);if(null!=l&&l===canReflect.getIdentity(n,f))return void mergeMap(a,n)}canReflect.setKeyValue(e,c,canReflect.new(a.constructor,n))}else canReflect.setKeyValue(e,c,n)}}else canReflect.deleteKeyValue(e,c)}),canReflect.eachKey(t,function(t,a){canReflect.setKeyValue(e,a,t)})}function mergeList(e,t){var a,c,n,i=canReflect.getSchema(e);i&&(a=i.values),a&&(c=canReflect.getSchema(a)),!c&&canReflect.size(e)>0&&(c=canReflect.getSchema(canReflect.getKeyValue(e,0))),n=c&&c.identity&&c.identity.length?function(e,t){var a=canReflect.getIdentity(e,c)===canReflect.getIdentity(t,c);return a&&mergeMap(e,t),a}:function(e,t){var a=e===t;return a&&(canReflect.isPrimitive(e)||mergeMap(e,t)),a};var r=diff(e,t,n),f=a?canReflect.new.bind(canReflect,a):function(e){return e};if(!r.length)return e;r.forEach(function(t){applyPatch(e,t,f)})}function applyPatch(e,t,a){var c=a&&t.insert.map(function(e){return a(e)})||t.insert,n=[t.index,t.deleteCount].concat(c);return e.splice.apply(e,n),e}smartMerge.applyPatch=applyPatch;var mergeDeep=smartMerge;export{mergeDeep as a};
//# sourceMappingURL=chunk-1e549d43.js.map
