{"version":3,"file":"chunk-ed157244.js","sources":["../node_modules/can-ajax/dist/cjs/can-ajax.js"],"sourcesContent":["/*can-ajax@2.1.0#can-ajax*/\n'use strict';\nvar Global = require('can-globals/global/global');\nvar canReflect = require('can-reflect');\nvar namespace = require('can-namespace');\nvar parseURI = require('can-parse-uri');\nvar param = require('can-param');\nvar xhrs = [\n        function () {\n            return new XMLHttpRequest();\n        },\n        function () {\n            return new ActiveXObject('Microsoft.XMLHTTP');\n        },\n        function () {\n            return new ActiveXObject('MSXML2.XMLHTTP.3.0');\n        },\n        function () {\n            return new ActiveXObject('MSXML2.XMLHTTP');\n        }\n    ], _xhrf = null;\nvar originUrl = parseURI(Global().location.href);\nvar globalSettings = {};\nvar makeXhr = function () {\n    if (_xhrf != null) {\n        return _xhrf();\n    }\n    for (var i = 0, l = xhrs.length; i < l; i++) {\n        try {\n            var f = xhrs[i], req = f();\n            if (req != null) {\n                _xhrf = f;\n                return req;\n            }\n        } catch (e) {\n            continue;\n        }\n    }\n    return function () {\n    };\n};\nvar contentTypes = {\n    json: 'application/json',\n    form: 'application/x-www-form-urlencoded'\n};\nvar _xhrResp = function (xhr, options) {\n    try {\n        var type = options.dataType || xhr.getResponseHeader('Content-Type').split(';')[0];\n        if (type && (xhr.responseText || xhr.responseXML)) {\n            switch (type) {\n            case 'text/xml':\n            case 'xml':\n                return xhr.responseXML;\n            case 'text/json':\n            case 'application/json':\n            case 'text/javascript':\n            case 'application/javascript':\n            case 'application/x-javascript':\n            case 'json':\n                return xhr.responseText && JSON.parse(xhr.responseText);\n            default:\n                return xhr.responseText;\n            }\n        } else {\n            return xhr;\n        }\n    } catch (e) {\n        return xhr;\n    }\n};\nfunction ajax(o) {\n    var xhr = makeXhr(), timer, n = 0;\n    var deferred = {}, isFormData;\n    var promise = new Promise(function (resolve, reject) {\n        deferred.resolve = resolve;\n        deferred.reject = reject;\n    });\n    var requestUrl;\n    promise.abort = function () {\n        xhr.abort();\n    };\n    o = [\n        {\n            userAgent: 'XMLHttpRequest',\n            lang: 'en',\n            type: 'GET',\n            data: null,\n            dataType: 'json'\n        },\n        globalSettings,\n        o\n    ].reduce(function (a, b, i) {\n        return canReflect.assignDeep(a, b);\n    });\n    if (!o.contentType) {\n        o.contentType = o.type.toUpperCase() === 'GET' ? contentTypes.form : contentTypes.json;\n    }\n    if (o.crossDomain == null) {\n        try {\n            requestUrl = parseURI(o.url);\n            o.crossDomain = !!(requestUrl.protocol && requestUrl.protocol !== originUrl.protocol || requestUrl.host && requestUrl.host !== originUrl.host);\n        } catch (e) {\n            o.crossDomain = true;\n        }\n    }\n    if (o.timeout) {\n        timer = setTimeout(function () {\n            xhr.abort();\n            if (o.timeoutFn) {\n                o.timeoutFn(o.url);\n            }\n        }, o.timeout);\n    }\n    xhr.onreadystatechange = function () {\n        try {\n            if (xhr.readyState === 4) {\n                if (timer) {\n                    clearTimeout(timer);\n                }\n                if (xhr.status < 300) {\n                    if (o.success) {\n                        o.success(_xhrResp(xhr, o));\n                    }\n                } else if (o.error) {\n                    o.error(xhr, xhr.status, xhr.statusText);\n                }\n                if (o.complete) {\n                    o.complete(xhr, xhr.statusText);\n                }\n                if (xhr.status >= 200 && xhr.status < 300) {\n                    deferred.resolve(_xhrResp(xhr, o));\n                } else {\n                    deferred.reject(_xhrResp(xhr, o));\n                }\n            } else if (o.progress) {\n                o.progress(++n);\n            }\n        } catch (e) {\n            deferred.reject(e);\n        }\n    };\n    var url = o.url, data = null, type = o.type.toUpperCase();\n    var isJsonContentType = o.contentType === contentTypes.json;\n    var isPost = type === 'POST' || type === 'PUT';\n    if (!isPost && o.data) {\n        url += '?' + (isJsonContentType ? JSON.stringify(o.data) : param(o.data));\n    }\n    xhr.open(type, url);\n    var isSimpleCors = o.crossDomain && [\n        'GET',\n        'POST',\n        'HEAD'\n    ].indexOf(type) !== -1;\n    isFormData = typeof FormData !== 'undefined' && o.data instanceof FormData;\n    if (isPost) {\n        if (isFormData) {\n            data = o.data;\n        } else {\n            data = isJsonContentType && !isSimpleCors ? typeof o.data === 'object' ? JSON.stringify(o.data) : o.data : param(o.data);\n        }\n        var setContentType = isJsonContentType && !isSimpleCors ? 'application/json' : 'application/x-www-form-urlencoded';\n        xhr.setRequestHeader('Content-Type', setContentType);\n    } else {\n        xhr.setRequestHeader('Content-Type', o.contentType);\n    }\n    if (!isSimpleCors) {\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n    }\n    if (o.beforeSend) {\n        o.beforeSend.call(o, xhr, o);\n    }\n    if (o.xhrFields) {\n        for (var f in o.xhrFields) {\n            xhr[f] = o.xhrFields[f];\n        }\n    }\n    xhr.send(data);\n    return promise;\n}\nmodule.exports = namespace.ajax = ajax;\nmodule.exports.ajaxSetup = function (o) {\n    globalSettings = o || {};\n};"],"names":["xhrs","XMLHttpRequest","ActiveXObject","_xhrf","originUrl","parseURI","Global","location","href","globalSettings","makeXhr","i","l","length","f","req","e","contentTypes","json","form","_xhrResp","xhr","options","type","dataType","getResponseHeader","split","responseText","responseXML","JSON","parse","ajax","o","timer","isFormData","requestUrl","n","deferred","promise","Promise","resolve","reject","abort","userAgent","lang","data","reduce","a","b","canReflect","assignDeep","contentType","toUpperCase","crossDomain","url","protocol","host","timeout","setTimeout","timeoutFn","onreadystatechange","readyState","clearTimeout","status","success","error","statusText","complete","progress","isJsonContentType","isPost","stringify","param","open","isSimpleCors","indexOf","FormData","setContentType","setRequestHeader","beforeSend","call","xhrFields","send","namespace"],"mappings":"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"}