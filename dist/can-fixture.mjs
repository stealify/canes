import{a as commonjsGlobal,b as commonjsRequire,c as unwrapExports,d as createCommonjsModule}from"./chunk-eae5b219.mjs";import{a as require$$0,b as Store}from"./chunk-c81214db.mjs";import"./chunk-88d0c417.mjs";import"./chunk-5f1245ff.mjs";import{a as canLog}from"./chunk-a661b1ce.mjs";import{a as deparam}from"./chunk-d3aaf861.mjs";import{a as canReflect}from"./chunk-7e0220de.mjs";import"./chunk-805ffcb4.mjs";import{a as namespace}from"./chunk-3b4c7b38.mjs";import"./chunk-b09dcf0e.mjs";import"./chunk-849fe8d8.mjs";import"./chunk-0826a8c3.mjs";import"./chunk-b37d91a1.mjs";import"./chunk-bd824939.mjs";import"./chunk-75bea8d8.mjs";import"./chunk-b1806013.mjs";import"./chunk-d2889630.mjs";import"./chunk-bacf0c54.mjs";import"./chunk-585d4076.mjs";import"./chunk-723b8216.mjs";import"./chunk-f81ff71d.mjs";import"./chunk-b52ac488.mjs";import"./chunk-d7d8317e.mjs";var XHR=XMLHttpRequest,GLOBAL=void 0!==commonjsGlobal?commonjsGlobal:window,props=["type","url","async","response","responseText","responseType","responseXML","responseURL","status","statusText","readyState"],events=["abort","error","load","loadend","loadstart","progress","readystatechange"];function callEvents(e,t){for(var n=e.__events[t]||[],r=0,s=n.length;r<s;r++)n[r].call(e)}!function(){var e=new XHR;for(var t in e)0===t.indexOf("on")?-1===events.indexOf(t.substr(2))&&events.push(t.substr(2)):-1===props.indexOf(t)&&"function"!=typeof e[t]&&props.push(t)}(),GLOBAL.XMLHttpRequest=function(){var e=this,t=new XHR;this._xhr=t,this._requestHeaders={},this.__events={},events.forEach(function(n){t["on"+n]=function(){if(callEvents(e,n),e["on"+n])return e["on"+n].apply(e,arguments)}}),this.onload=null},GLOBAL.XMLHttpRequest._XHR=XHR,canReflect.assignMap(XMLHttpRequest.prototype,{setRequestHeader:function(e,t){this._requestHeaders[e]=t},open:function(e,t,n){this.type=e,this.url=t,this.async=!1!==n},getAllResponseHeaders:function(){return this._xhr.getAllResponseHeaders.apply(this._xhr,arguments)},addEventListener:function(e,t){(this.__events[e]=this.__events[e]||[]).push(t)},removeEventListener:function(e,t){var n=this.__events[e]=this.__events[e]||[],r=n.indexOf(t);r>=0&&n.splice(r,1)},setDisableHeaderCheck:function(e){this._disableHeaderCheck=!!e},getResponseHeader:function(e){return this._xhr.getResponseHeader(e)},abort:function(){var e=this._xhr;return void 0!==this.timeoutId&&(clearTimeout(this.timeoutId),e.open(this.type,this.url,!1!==this.async),e.send()),e.abort()},send:function(e){var t=this.type.toLowerCase()||"get",n={url:this.url,data:e,headers:this._requestHeaders,type:t,method:t,async:this.async,xhr:this};if((!n.data&&"get"===n.type||"delete"===n.type)&&(n.data=deparam(n.url.split("?")[1]),n.url=n.url.split("?")[0]),"string"==typeof n.data)try{n.data=JSON.parse(n.data)}catch(e){n.data=deparam(n.data)}var r=require$$0.get(n),s=this;if(!r||"function"!=typeof r.fixture){var o=function(){return s._xhr.open(s._xhr.type,s._xhr.url,s._xhr.async),s._requestHeaders&&Object.keys(s._requestHeaders).forEach(function(e){s._xhr.setRequestHeader(e,s._requestHeaders[e])}),s._xhr.send(e)};return r&&"number"==typeof r.fixture?(canLog.log("can-fixture: "+n.url+" => delay "+r.fixture+"ms"),void(this.timeoutId=setTimeout(o,r.fixture))):(r&&(canLog.log("can-fixture: "+n.url+" => "+r.url),canReflect.assignMap(s,r)),o())}this.timeoutId=require$$0.callDynamicFixture(n,r,function(e,t,n,r){t="string"==typeof t?t:JSON.stringify(t),s._xhr={open:function(){},send:function(){},abort:function(){},getResponseHeader:function(){}},canReflect.assignMap(s,{readyState:4,status:e}),e>=200&&e<300||304===e?canReflect.assignMap(s,{statusText:r||"OK",responseText:t}):canReflect.assignMap(s,{statusText:r||"error",responseText:t}),s.getAllResponseHeaders=function(){var e=[];return canReflect.eachKey(n||{},function(t,n){Array.prototype.push.apply(e,[n,": ",t,"\r\n"])}),e.join("")},s.onreadystatechange&&s.onreadystatechange({target:s}),callEvents(s,"progress"),s.onprogress&&s.onprogress(),callEvents(s,"load"),s.onload&&s.onload(),callEvents(s,"loadend"),s.onloadend&&s.onloadend()})}}),props.forEach(function(e){Object.defineProperty(XMLHttpRequest.prototype,e,{get:function(){return this._xhr[e]},set:function(t){try{this._xhr[e]=t}catch(e){}}})});var fixture=require$$0.add,noop=function(){};canReflect.assignMap(fixture,{rand:function e(t,n,r){if("number"==typeof t)return"number"==typeof n?t+Math.floor(Math.random()*(n-t+1)):Math.floor(Math.random()*(t+1));var s=t.slice(0);void 0===n?(n=1,r=s.length):void 0===r&&(r=n);for(var o=[],a=n+Math.round(e(r-n)),i=0;i<a;i++){var u=e(s.length-1),c=s.splice(u,1)[0];o.push(c)}return o},xhr:function(e){return canReflect.assignMap({},{abort:noop,getAllResponseHeaders:function(){return""},getResponseHeader:function(){return""},open:noop,overrideMimeType:noop,readyState:4,responseText:"",responseXML:null,send:noop,setRequestHeader:noop,status:200,statusText:"OK"},e)},store:Store.make,fixtures:require$$0.fixtures}),"undefined"!=typeof window&&"function"!=typeof commonjsRequire.resolve&&(window.fixture=fixture);var fixture_1=namespace.fixture=fixture;export default fixture_1;
//# sourceMappingURL=can-fixture.js.map
